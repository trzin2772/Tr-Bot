/*! For license information please see core.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.core=t():e.core=t()}("undefined"!=typeof window?window:self,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=63)}([function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.setLogger=t.APILogger=t.JSLogger=t.logger=t.JSLoggerServer=void 0;var o=n(13),i=n(6),a=n(2),s=n(1),c=n(3),u=Math.random()<=.01;t.JSLoggerServer=u?new o.HttpLoggerService:void 0;var l=function(e){null===t.JSLoggerServer||void 0===t.JSLoggerServer||t.JSLoggerServer.report(a.PRODUCTION?a.LOGGER_API:a.BETA_LOGGER_API,{name:e.name,extraInfo:e.extra_info})};t.logger=function(e){var t,n={isPixelAD:(0,c.isPixelAD)(),isInWebView:(0,c.isInWebView)(),isPreload:(0,c.getIsPreload)(),_version:a.SDK_VERSION,currentHref:null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location.href},o={name:e.name,extra_info:JSON.stringify(r(r({},n),null!==(t=e.extra_info_obj)&&void 0!==t?t:{}))};l(o)};var d=function(){var e,t,n,r,o,i="",a="";try{var c=null===(e=document.currentScript)||void 0===e?void 0:e.src,u=s.GlobalThis,l=null===(n=u[(null===(t=null==c?void 0:c.split("lib=")[1])||void 0===t?void 0:t.split("&")[0])||u.KwaiAnalyticsObject])||void 0===n?void 0:n._i;a=null===(r=Object.keys(null!=l?l:{}))||void 0===r?void 0:r.toString(),i=(null===(o=null==c?void 0:c.split("sdkid=")[1])||void 0===o?void 0:o.split("&")[0])||Object.keys(null!=l?l:{})[0]}catch(e){}return{pixelId:i,pixelIds:a}};t.JSLogger=function(e){var n,o;try{var s=d(),c=s.pixelId,u=s.pixelIds;(0,t.logger)({name:i.LOGGER_TYPES_NAME.CATCH_JS_ERROR,extra_info_obj:r(r({},e),{pixelId:c,pixelIds:u,error:"object"==typeof e.error?null!==(n=e.error.stack)&&void 0!==n?n:e.error.toString():e.error,errorMsg:"object"==typeof e.error?null!==(o=e.error.message)&&void 0!==o?o:e.error.toString():e.error})}),a.PRODUCTION}catch(e){}};t.APILogger=function(e){var n;if(![a.LOGGER_API,a.BETA_LOGGER_API].includes(e.apiPath))try{var o=d(),s=o.pixelId,c=o.pixelIds;if(e.response&&"object"!=typeof e.response)try{e.response=JSON.parse(e.response)}catch(e){}(0,t.logger)({name:i.LOGGER_TYPES_NAME.CATCH_API_ERROR,extra_info_obj:r(r({},e),{pixelId:s,pixelIds:c,error:"object"==typeof e.error?null!==(n=e.error.stack)&&void 0!==n?n:e.error.toString():e.error})}),!a.PRODUCTION&&e.error}catch(e){}};t.setLogger=function(e){var t=e.api;l=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowSnapshot=t.GlobalThis=t.updateWindowSnapshotWhenInWorker=t.checkWindow=void 0;var r=void 0;t.GlobalThis=r;var o=void 0;t.windowSnapshot=o;var i=!1;"undefined"!=typeof window?(t.GlobalThis=r=window,t.windowSnapshot=o=window):"undefined"!=typeof self&&(t.GlobalThis=r=self,i=!0);t.checkWindow=function(e){return"object"==typeof e&&null!==e&&"window"in e&&e===e.window};t.updateWindowSnapshotWhenInWorker=function(e){return!(!i||!(0,t.checkWindow)(e))&&(t.windowSnapshot=o=e,!0)}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCTION=t.BROWSER_PREFIXS=t.SDK_VERSION=t.LOGGER_API=t.BETA_LOGGER_API=t.API=t.Callback_Api_Domain=t.KWAI_SESSION_ID=t.REPORT_TYPE=t.EVENT_NAME_FORMAT=t.EVENT_NAME=t.PAGE_VIEW_EVENT_NAME=t.UNKNOWN_EVENT=t.PAGE_ID=t.SESSION_ID=t.KWAI_Q=t.KWAI_ANALYTICS_OBJECT=t.KWAI_CALLBACK_SOURCE=t.KWAI_CALLBACK_SESSION_KEY=t.KWAI_PIXEL_ID=t.KWAI_CALLBACK=t.KWAI_TEST_ID=void 0,t.KWAI_TEST_ID="ks_px_test",t.KWAI_CALLBACK="click_id",t.KWAI_PIXEL_ID="pixel_id",t.KWAI_CALLBACK_SESSION_KEY="kwai_adInfo",t.KWAI_CALLBACK_SOURCE="kwai_adInfo_source",t.KWAI_ANALYTICS_OBJECT="KwaiAnalyticsObject",t.KWAI_Q="kwaiq",t.SESSION_ID="sessionId",t.PAGE_ID="pageId",t.UNKNOWN_EVENT="UNKNOWN",t.PAGE_VIEW_EVENT_NAME="pageView",t.EVENT_NAME={pageView:"EVENT_PAGE_VIEW",pageLeave:"EVENT_PAGE_LEAVE",addPaymentInfo:"EVENT_ADD_PAYMENT_INFO",addToCart:"EVENT_ADD_TO_CART",buttonClick:"EVENT_BUTTON_CLICK",purchase:"EVENT_PURCHASE",contentView:"EVENT_CONTENT_VIEW",download:"EVENT_DOWNLOAD",formSubmit:"EVENT_FORM_SUBMIT",initiatedCheckout:"EVENT_INITIATED_CHECKOUT",contact:"EVENT_CONTACT",placeOrder:"EVENT_PLACE_ORDER",search:"EVENT_SEARCH",completeRegistration:"EVENT_COMPLETE_REGISTRATION",addToWishlist:"EVENT_ADD_TO_WISHLIST",subscribe:"EVENT_SUBSCRIBE",firstDeposit:"EVENT_FIRST_DEPOSIT",creditApproval:"EVENT_CREDIT_APPROVAL",loanApplication:"EVENT_LOAN_APPLICATION",loanCredit:"EVENT_LOAN_CREDIT",loanDisbursal:"EVENT_LOAN_DISBURSAL",creditCardApplication:"EVENT_CREDIT_CARD_APPLICATION"},t.EVENT_NAME_FORMAT={EVENT_PAGE_VIEW:"pageView",EVENT_PAGE_LEAVE:"pageLeave",EVENT_ADD_PAYMENT_INFO:"addPaymentInfo",EVENT_ADD_TO_CART:"addToCart",EVENT_BUTTON_CLICK:"buttonClick",EVENT_PURCHASE:"purchase",EVENT_CONTENT_VIEW:"contentView",EVENT_DOWNLOAD:"download",EVENT_FORM_SUBMIT:"formSubmit",EVENT_INITIATED_CHECKOUT:"initiatedCheckout",EVENT_CONTACT:"contact",EVENT_PLACE_ORDER:"placeOrder",EVENT_SEARCH:"search",EVENT_SERACH:"search",EVENT_COMPLETE_REGISTRATION:"completeRegistration",EVENT_ADD_TO_WISHLIST:"addToWishlist",EVENT_SUBSCRIBE:"subscribe",EVENT_FIRST_DEPOSIT:"firstDeposit",EVENT_CREDIT_APPROVAL:"creditApproval",EVENT_LOAN_APPLICATION:"loanApplication",EVENT_LOAN_CREDIT:"loanCredit",EVENT_LOAN_DISBURSAL:"loanDisbursal",EVENT_CREDIT_CARD_APPLICATION:"creditCardApplication"},function(e){e.TRACK="track",e.TEST_TRACK="test_track",e.TRACK_DATA="track_data"}(o=t.REPORT_TYPE||(t.REPORT_TYPE={})),t.KWAI_SESSION_ID="kwai_session_id";t.Callback_Api_Domain="https://www.adsnebula.com",t.API=((r={})[o.TRACK]="".concat(t.Callback_Api_Domain,"/log/common"),r[o.TEST_TRACK]="",r[o.TRACK_DATA]="".concat(t.Callback_Api_Domain,"/log/common/web/landingPage/data"),r.GET_PIXEL="".concat("https://api.mythad.com","/rest/n/adintl/ad/getPixelConfig"),r.PREVIEW_REPORT="".concat("https://ads.kwai.com","/rest/i18n/adDsp/pixel/createErrorEvent"),r),t.BETA_LOGGER_API="https://ad-intl-web-beta.test.gifshow.com/rest/n/adintl/ad/pixelLog",t.LOGGER_API="https://api.mythad.com/rest/n/adintl/ad/pixelLog",t.SDK_VERSION="2.3.0",t.BROWSER_PREFIXS=["","webkit","WebKit","moz","Moz","ms","MS","o","O"],t.PRODUCTION=!0},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.toHump=t.writeVal=t.readVal=t.setCookieByName=t.getCookieByKey=t.getRandom=t.getValFromCookieByName=t.getDomain=void 0;var i=n(24);Object.defineProperty(t,"getDomain",{enumerable:!0,get:function(){return i.getDomain}});var a=n(26);Object.defineProperty(t,"getValFromCookieByName",{enumerable:!0,get:function(){return a.getValFromCookieByName}});var s=n(27);Object.defineProperty(t,"getRandom",{enumerable:!0,get:function(){return s.getRandom}});var c=n(7);Object.defineProperty(t,"getCookieByKey",{enumerable:!0,get:function(){return c.getCookieByKey}}),Object.defineProperty(t,"setCookieByName",{enumerable:!0,get:function(){return c.setCookieByName}}),Object.defineProperty(t,"readVal",{enumerable:!0,get:function(){return c.readVal}}),Object.defineProperty(t,"writeVal",{enumerable:!0,get:function(){return c.writeVal}});var u=n(28);Object.defineProperty(t,"toHump",{enumerable:!0,get:function(){return u.toHump}}),o(n(15),t),o(n(16),t),o(n(10),t),o(n(9),t),o(n(29),t),o(n(17),t)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(31),t),o(n(6),t)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.xhrService=void 0;var o=n(0),i=n(6),a=n(14),s=function(){var e=this;this.curXhrInstance=null,this.curReject=null,this.catchBy="",this.curRetry=0,this.retryConfig={retry:0,retryDelay:1e3,requestParams:{method:"",url:"",async:!0,headers:{},data:""}},this.postCustom=function(t,n,r){var o;return e.post(t,(0,a.formatter)(n,a.SendMethod.XHR,null!==(o=null==r?void 0:r.async)&&void 0!==o&&o),r)},this.post=function(t,n,i){var a=null!=i?i:{},s=a.contentType,c=void 0===s?"application/json":s,u=a.timeout,l=void 0===u?3e3:u,d=a.async,p=void 0!==d&&d,f=a.retry,h=void 0===f?0:f,v=a.retryDelay,g=void 0===v?1e3:v;return new Promise((function(i,a){e.curReject=a;var s=e.curXhrInstance=new XMLHttpRequest;try{e.curRetry=0;var u=JSON.stringify(n);e.retryConfig={retry:h,retryDelay:g,requestParams:{method:"POST",url:t,async:!0,headers:{"content-type":c},data:u}},s.open("POST",t,p),s.setRequestHeader("content-type",c),s.onload=function(){if(s.status>=200&&s.status<300){var t=s.response;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){(0,o.JSLogger)({error:e})}i(r(r({},t),{isRetry:e.curRetry>0}))}else s.status>=400?e.handleReject(String(s.status),!0):(e.catchBy="status",e.handleReject())},s.onerror=function(){e.catchBy="onerror",e.handleReject()},p&&(s.timeout=l,s.ontimeout=function(){e.catchBy="ontimeout",e.handleReject()}),s.withCredentials=!0,s.send(u)}catch(t){e.xhrTryCatchErrorHandler(t)}}))},this.get=function(t,n){return new Promise((function(a,s){e.curReject=s;var c=null!=n?n:{},u=c.retry,l=void 0===u?0:u,d=c.retryDelay,p=void 0===d?1e3:d,f=e.curXhrInstance=new XMLHttpRequest;try{e.curRetry=0,e.retryConfig={retry:l,retryDelay:p,requestParams:{method:"GET",url:t,async:!0,headers:{},data:""}},f.responseType="json",f.open("GET",t),f.onload=function(){if(f.status>=200&&f.status<300){var n=f.response;n.data&&n.data.length>0?a(r(r({},n),{isRetry:e.curRetry>0})):(s(f.statusText),(0,o.APILogger)({apiPath:t,actionStatus:i.ActionStatus.NOT_VALID_API_RETURNS,error:"pixel not exist"}))}else f.status>=400?e.handleReject(String(f.status),!0):(e.catchBy="status",e.handleReject())},f.onerror=function(){e.catchBy="onerror",e.handleReject()},f.withCredentials=!0,f.send()}catch(t){e.xhrTryCatchErrorHandler(t)}}))},this.xhrTryCatchErrorHandler=function(t){e.catchBy="tryCatch",t&&t instanceof Error?e.handleReject(t.message):"string"==typeof t?e.handleReject(t):e.handleReject()},this.handleReject=function(t,n){var r,a,s;void 0===n&&(n=!1);var c=e,u=c.curRetry,l=c.retryConfig,d=c.curXhrInstance;if(u<l.retry&&d&&!n)e.curRetry++,setTimeout((function(){try{var n=l.requestParams;for(var r in(0,o.APILogger)({apiPath:n.url,actionStatus:i.ActionStatus.RETRY,error:"times : ".concat(e.curRetry,", catchBy: ").concat(e.catchBy).concat(t?", ".concat(t):"")}),d.abort(),d.open(n.method,n.url,n.async),n.headers)d.setRequestHeader(r,n.headers[r]);d.send(n.data)}catch(t){e.xhrTryCatchErrorHandler(t)}}),l.retryDelay);else{var p=null!==(a=null===(r=e.curXhrInstance)||void 0===r?void 0:r.statusText)&&void 0!==a?a:"";null===(s=e.curReject)||void 0===s||s.call(e,p),(0,o.APILogger)({apiPath:l.requestParams.url,actionStatus:i.ActionStatus.ERROR,error:"statusText : ".concat(p,", catchBy: ").concat(e.catchBy).concat(t?", ".concat(t):"")})}}};t.xhrService=new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CostInfoType=t.ActionStatus=t.LOGGER_TYPES_NAME=void 0,function(e){e.successConfig="successConfig",e.errConfig="errConfig",e.errBefroeSetBridge="errBefroeSetBridge",e.successSetBridge="successSetBridge",e.errSetBridge="errSetBridge",e.successBridge="successBridge",e.errBridge="errBridge",e.errBridgeForUnPixel="errBridgeForNotPixelAd",e.errMatchPixelId="errMatchPixelId",e.errPixelId="errPixelId",e.errClickId="errClickId",e.errUp="errUp",e.successUp="successUp",e.successUpForOther="successUpForOther",e.wAndc="windowAndcookie",e.previewErrUp="previewErrUp",e.previewSuccessUp="previewSuccessUp",e.GET_AD_INFO_COUNT="GET_AD_INFO_COUNT",e.GET_AD_INFO_FROM_SESSION="GET_AD_INFO_FROM_SESSION",e.GET_AD_INFO_FROM_COOKIE="GET_AD_INFO_FROM_COOKIE",e.GET_AD_INFO_FROM_URL="GET_AD_INFO_FROM_URL",e.GET_AD_INFO_FROM_BRIDGE="GET_AD_INFO_FROM_BRIDGE",e.I18N_AD_COST_LOG="I18N_AD_COST_LOG",e.CATCH_JS_ERROR="CATCH_JS_ERROR",e.CATCH_API_ERROR="CATCH_API_ERROR"}(t.LOGGER_TYPES_NAME||(t.LOGGER_TYPES_NAME={})),function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.NOT_VALID_API_RETURNS="NOT_VALID_API_RETURNS",e.RETRY="RETRY"}(t.ActionStatus||(t.ActionStatus={})),function(e){e.BridgeYodaV2="BridgeYodaV2",e.interfaceRetry="interfaceRetry"}(t.CostInfoType||(t.CostInfoType={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.readValFromStorage=t.readVal=t.writeVal=t.setCookieByName=t.getCookieByKey=void 0;var i=n(1),a=n(3),s=n(8),c=n(0);t.getCookieByKey=function(e){var t=e.key;return r(void 0,void 0,void 0,(function(){var e,n,r,i,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,s.getCookie)()];case 1:for(e=o.sent(),n=e.split("; "),r=0;r<n.length;r++)if((i=n[r].split("="))[0]==t)return[2,decodeURIComponent(i[1])];return[3,3];case 2:return a=o.sent(),(0,c.JSLogger)({error:a}),[3,3];case 3:return[2]}}))}))};t.setCookieByName=function(e){var t=e.name,n=e.value,u=e.seconds;return r(void 0,void 0,void 0,(function(){var e,r,l,d,p;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(0,a.getIsPreload)(null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href)?[2]:(e="",0!=(u=u||0)&&((r=new Date).setTime(r.getTime()+1e3*u),e="; expires="+r.toUTCString()),l=(0,a.getDomain)(),d=t+"="+escape(n)+e+"; path=/; domain="+l,[4,(0,s.setCookie)({value:d})]);case 1:return o.sent(),[3,3];case 2:return p=o.sent(),(0,c.JSLogger)({error:p}),[3,3];case 3:return[2]}}))}))};t.writeVal=function(e){var n=e.key,s=e.val;return r(void 0,void 0,void 0,(function(){var e,r;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(0,a.getIsPreload)(null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href)?[2]:(e=JSON.stringify(s),"kwai_adInfo"!==n?[3,2]:[4,(0,t.setCookieByName)({name:n,value:e,seconds:1800})]);case 1:o.sent(),o.label=2;case 2:return(null===i.GlobalThis||void 0===i.GlobalThis?void 0:i.GlobalThis.sessionStorage)&&i.GlobalThis.sessionStorage.setItem(n,e),[3,4];case 3:throw r=o.sent(),(0,c.JSLogger)({error:r}),r;case 4:return[2]}}))}))};t.readVal=function(e){var n=e.key;return r(void 0,void 0,void 0,(function(){var e,r,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,(0,t.getCookieByKey)({key:n})];case 1:return e=o.sent(),(null===i.GlobalThis||void 0===i.GlobalThis?void 0:i.GlobalThis.sessionStorage)?[4,i.GlobalThis.sessionStorage.getItem(n)]:[3,3];case 2:return[2,(r=o.sent())?JSON.parse(r):e?JSON.parse(e):void 0];case 3:return[2,e?JSON.parse(e):void 0];case 4:throw a=o.sent(),(0,c.JSLogger)({error:a}),a;case 5:return[2]}}))}))};t.readValFromStorage=function(e){var t=e.key;return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),(null===i.GlobalThis||void 0===i.GlobalThis?void 0:i.GlobalThis.sessionStorage)?[4,i.GlobalThis.sessionStorage.getItem(t)]:[3,2];case 1:return[2,n.sent()||void 0];case 2:return[3,4];case 3:return e=n.sent(),(0,c.JSLogger)({error:e}),[3,4];case 4:return[2]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=void 0;var i=n(1),a=n(0);t.getCookie=function(){return r(void 0,void 0,void 0,(function(){var e,t,n,r,s;return o(this,(function(o){switch(o.label){case 0:e="",o.label=1;case 1:return o.trys.push([1,4,,5]),i.GlobalThis&&"cookie"in i.GlobalThis&&"function"==typeof i.GlobalThis.cookie.get?[4,i.GlobalThis.cookie.get()]:[3,3];case 2:e=o.sent(),o.label=3;case 3:return!e&&(null===(n=null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.document)||void 0===n?void 0:n.cookie)&&(e=null!==(s=null===(r=null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.document)||void 0===r?void 0:r.cookie)&&void 0!==s?s:""),[3,5];case 4:return t=o.sent(),(0,a.JSLogger)({error:t}),[3,5];case 5:return[2,e]}}))}))};t.setCookie=function(e){var t=e.value;return r(void 0,void 0,void 0,(function(){var e,n,r;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),i.GlobalThis&&"cookie"in i.GlobalThis&&"function"==typeof i.GlobalThis.cookie.set?(e=t.replace(/domain=.+/,""),[4,i.GlobalThis.cookie.set(t)]):[3,3];case 1:return o.sent(),[4,null===i.GlobalThis||void 0===i.GlobalThis?void 0:i.GlobalThis.cookie.set(e)];case 2:o.sent(),o.label=3;case 3:return(null===(r=null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.document)||void 0===r?void 0:r.cookie)&&(i.windowSnapshot.document.cookie=t),[3,5];case 4:return n=o.sent(),(0,a.JSLogger)({error:n}),[3,5];case 5:return[2]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.setPixelCacheIfNotInit=t.setWorkSpaceCacheIfNotInit=t.getWorkspace=t.getWorkspaceName=void 0;var o=n(1),i=n(2);t.getWorkspaceName=function(){return"object"==typeof o.GlobalThis&&o.GlobalThis[i.KWAI_ANALYTICS_OBJECT]||i.KWAI_Q};t.getWorkspace=function(){return"object"==typeof o.GlobalThis&&o.GlobalThis[(0,t.getWorkspaceName)()]};t.setWorkSpaceCacheIfNotInit=function(e,n){var o=(0,t.getWorkspace)(),i=o._i;Object.entries(i).forEach((function(t){!0!==t[1]._init&&o.push(r([e],n,!0))}))};t.setPixelCacheIfNotInit=function(e,n,r){var o=(0,t.getWorkspace)()._i,i=o[e]||[];i._init||(i.push(["track",n,r]),o[e]=i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPixelAD=t.isInWebView=t.getDeviceType=t.getUAInfo=t.DeviceType=void 0;var r,o=n(1);!function(e){e.WindowsPhone="WindowsPhone",e.Android="Android",e.IOS="IOS",e.PC="PC"}(r=t.DeviceType||(t.DeviceType={}));t.getUAInfo=function(){var e;return(null===(e=null===o.windowSnapshot||void 0===o.windowSnapshot?void 0:o.windowSnapshot.navigator)||void 0===e?void 0:e.userAgent)||""};t.getDeviceType=function(){var e=(0,t.getUAInfo)(),n=r.PC;return/windows phone/i.test(e)?n=r.WindowsPhone:/android/i.test(e)?n=r.Android:/iPad|iPhone|iPod/.test(e)&&(n=r.IOS),n};t.isInWebView=function(){var e=(0,t.getUAInfo)();return/kwai/i.test(e)};t.isPixelAD=function(){var e=(0,t.getUAInfo)();return/kwaiPixelAd/i.test(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginName=void 0,function(e){e.LOGGER_PLUGIN="logger",e.CACHE_PLUGIN="cache",e.PerformanceObserverPlugin="PerformanceObserverPlugin"}(t.PluginName||(t.PluginName={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plugin=void 0;var r=function(){function e(e){this.context=e}return e.prototype.pageDidLoad=function(){},e.prototype.pageUrlWillChange=function(e,t){},e.prototype.pageUrlDidChange=function(e){},e.prototype.pageWillLeave=function(e,t){},e.prototype.visibilityChange=function(e,t){},e.prototype.pixelCreateStart=function(e){},e.prototype.pixelCreateEnd=function(e){},e.prototype.pixelDidMount=function(e){},e.prototype.initStart=function(){},e.prototype.initEnd=function(){},e.prototype.adInfoInitStart=function(){},e.prototype.adInfoInitEnd=function(){},e.prototype.contextInitStart=function(e){},e.prototype.contextInitEnd=function(){},e.prototype.logFMP=function(e){},e.prototype.pluginInitStart=function(e){},e.prototype.pluginInitEnd=function(e){},e}();t.Plugin=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpLoggerService=void 0;var i=n(5),a=function(){var e=this;this.xhrService=i.xhrService,this.report=function(t,n){e.xhrService.post(t,n,{async:!0}).then((function(t){return r(e,void 0,void 0,(function(){var e;return o(this,(function(n){return e=t,"object"!=typeof t&&(e=JSON.parse(t)),e.status,e.message,[2]}))}))})).catch((function(e){}))}};t.HttpLoggerService=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.formatter=t.SendMethod=void 0;var o,i=n(2);!function(e){e[e.XHR=1]="XHR",e[e.BEACON=2]="BEACON"}(o=t.SendMethod||(t.SendMethod={}));t.formatter=function(e,t,n){void 0===t&&(t=o.XHR),void 0===n&&(n=!1);var a=e.eventName,s=void 0===a?"":a,c=e.context,u=void 0===c?{}:c,l=e.params,d=void 0===l?{}:l,p=u.ad,f=void 0===p?{}:p,h=u.pixel,v=void 0===h?{}:h,g=u.libVersion,y=void 0===g?"":g,m=u.trackFlag,_=void 0!==m&&m;return{clickid:f.callback||"",event_name:i.EVENT_NAME[s]||i.UNKNOWN_EVENT,is_attributed:0,mmpcode:"PL",pixelId:v.code||"",pixelSdkVersion:y,testFlag:!i.PRODUCTION,trackFlag:_,pixelExtData:JSON.stringify(r(r({},d),{sendMethod:t,sendWithXhrAsync:t!==o.XHR||n}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIsPreload=t.PreloadUAIdentifier=void 0;var r=n(1);t.PreloadUAIdentifier="kwai_type/preload";t.getIsPreload=function(e){var n;return(null!==(n=null===r.windowSnapshot||void 0===r.windowSnapshot?void 0:r.windowSnapshot.navigator.userAgent)&&void 0!==n?n:"").indexOf(t.PreloadUAIdentifier)>-1||"string"==typeof e&&(e.indexOf("type=preload")>-1||e.indexOf("kwai_type=preload")>-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryStringWithIframeCheck=t.getQueryString=void 0;var r=n(1),o=n(17),i=n(0);t.getQueryString=function(e,t,n){var r="";try{var o=new URL(null!=t?t:"");if(o.searchParams.has(e))r=o.searchParams.get(e)||"";else if(o.hash)if(o.hash.includes("?")){var a=o.hash.slice(o.hash.indexOf("?"));(s=new URLSearchParams(a)).has(e)&&(r=s.get(e)||"")}else{var s;(s=new URLSearchParams(o.hash.slice(1))).has(e)&&(r=s.get(e)||"")}}catch(e){(0,i.JSLogger)({error:e}),null==n||n(e)}return r?decodeURIComponent(r):""};t.getQueryStringWithIframeCheck=function(e,n,i){var a,s=(0,t.getQueryString)(e,n,i);if(!s&&(0,o.isInIframe)())try{s=(0,t.getQueryString)(e,null===(a=null===r.windowSnapshot||void 0===r.windowSnapshot?void 0:r.windowSnapshot.top)||void 0===a?void 0:a.location.href,i)}catch(e){}return s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInIframe=void 0;var r=n(1);t.isInIframe=function(){return(0,r.checkWindow)(r.GlobalThis)&&r.GlobalThis.self!==r.GlobalThis.top}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getIsGtm=t.getWdata=void 0;var o=n(1),i="",a=[{partner:"shopyy",tests:{windowProperties:["ymcart_goods_id","ymcart_countrys","ymcart_data_id","ymcart_store_id"],cookie:["ymcart"]}},{partner:"shoplazza",tests:{windowProperties:["SHOPLAZZA","SHOPLAZZA_APPS_COMMON","SHOP_PARAMS","Shoplazza"],cookie:["shoplazza"]}},{partner:"shopline",tests:{windowProperties:["Shopline"]}},{partner:"shopify",tests:{windowProperties:["Shopify","shopifySpbJsonp","ShopifyAnalytics","ShopifyPaypalV4VisibilityTracking"],cookie:["shopify"]},children:[{partner:"yampi",tests:{windowProperties:["yampiCheckoutUrl","yampiClick","ympData"]}}]},{partner:"wordpress",tests:{windowProperties:["wp"]}},{partner:"aliexpress",tests:{windowProperties:["AES","ali_analytics"],link:["aliexpress"]}},{partner:"yampi",tests:{windowProperties:["yampiCheckoutUrl","yampiClick","ympData"]}}],s={partner:"gtm",tests:{windowProperties:["google_tag_manager"]}},c=function(e){return function(t){return t.some(e)}},u=((r={}).windowProperties=c((function(e){var t;return null!==(t=o.windowSnapshot&&e in o.windowSnapshot)&&void 0!==t&&t})),r.cookie=c((function(e){return i.includes(e)})),r.link=c((function(e){var t;return null!==(t=null===o.windowSnapshot||void 0===o.windowSnapshot?void 0:o.windowSnapshot.location.href.includes(e))&&void 0!==t&&t})),r),l=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n],o=r.tests,i=r.partner,a=r.children;if(Object.entries(o).some((function(e){var t=e[0],n=e[1];return u[t](n)}))){if(t=i,a){var s=l(a);t=s?"".concat(t,"&&").concat(s):t}break}}return t};t.getWdata=function(e){return i="string"==typeof e?e:"",l(a)};t.getIsGtm=function(){return"gtm"===l([s])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isElement=function(e){var t=void 0;t="object"===("undefined"==typeof HTMLElement?"undefined":r(HTMLElement))?e instanceof HTMLElement:!!e&&"object"===(void 0===e?"undefined":r(e))&&1===e.nodeType&&"string"==typeof e.nodeName;return t}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ks_pixel_setPixelBaseInfo=t.ks_pixel_getPixelBaseInfo=void 0;var c=n(0),u=n(1),l=n(10),d="callPixelBridge",p=function(){if((0,l.isInWebView)())throw Error("bridge 还没准备好")},f=a(void 0,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return(0,l.isInWebView)()&&u.GlobalThis&&!u.GlobalThis.__isYodaInit__?[4,Promise.resolve().then((function(){return i(n(21))}))]:[3,2];case 1:e=t.sent(),p=e.invoke,u.GlobalThis.__isYodaInit__=!0,t.label=2;case 2:return[2]}}))}));t.ks_pixel_getPixelBaseInfo=function(){return a(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,f];case 1:return e.sent(),[4,p("".concat(d,".kwai_ad_getPixelBaseInfo"))];case 2:return[2,e.sent()]}}))}))};t.ks_pixel_setPixelBaseInfo=function(e){return a(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,f];case 1:return n.sent(),[4,p("".concat(d,".kwai_ad_setPixelDebugInfo"),{data:JSON.stringify(e)})];case 2:return[2,n.sent()];case 3:return t=n.sent(),(0,c.JSLogger)({error:t}),[3,4];case 4:return[2]}}))}))}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(){c=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new I(r||[]);return o(a,"_invoke",{value:E(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var f={};function h(){}function v(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,_=m&&m(m(A([])));_&&_!==t&&n.call(_,a)&&(y=_);var b=g.prototype=h.prototype=Object.create(y);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(o,a,s,c){var u=p(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==r(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,c)}),(function(e){i("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return i("throw",e,s,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return x()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return v.prototype=g,o(b,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},S(w.prototype),l(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(d(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(b),l(b,u,"Generator"),l(b,a,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function u(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function g(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e,t,n){return(E=S()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&_(o,n.prototype),o}).apply(null,arguments)}function O(e){var t="function"==typeof Map?new Map:void 0;return(O=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return E(e,arguments,b(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_(r,e)})(e)}n.r(t),n.d(t,"addListener",(function(){return et})),n.d(t,"invoke",(function(){return $e})),n.d(t,"isBridgeError",(function(){return De})),n.d(t,"removeListener",(function(){return tt})),n.d(t,"setGlobalConfig",(function(){return Fe})),n.d(t,"version",(function(){return Ke}));var P,k=a((function e(){var t=this;s(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),I=(P=Object.prototype.hasOwnProperty,function(e,t){return P.call(e,t)}),A=function(e){return"object"===r(e)&&null!==e},x=function(e){return"function"==typeof e},T=function(e){return new Promise((function(t){return setTimeout(t,e)}))},C=function(e,t){if(!e||!t)return Number.NaN;for(var n=e.split(".").map((function(e){return+e})),r=t.split(".").map((function(e){return+e})),o=0;o<Math.min(n.length,r.length);o+=1){if(Number.isNaN(n[o])||Number.isNaN(r[o]))return Number.NaN;if(n[o]!==r[o])return n[o]-r[o]}return 0},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return arguments.length<=0?void 0:arguments[0]},n=new Map,r=new WeakMap;return function(){var o,i=t.apply(void 0,arguments),a=A(i)?r:n,s=null!==(o=a.get(i))&&void 0!==o?o:e.apply(void 0,arguments);return a.has(i)||a.set(i,s),s}}((function(e){var t,n;return null!==(t=null===(n=new RegExp("(?:".concat(e,")\\/([\\d+.]+)"),"u").exec("undefined"==typeof navigator?"":navigator.userAgent))||void 0===n?void 0:n[1])&&void 0!==t?t:""})),N=function(e){return C(L("Yoda"),e)},R=function(e){return C(L("Kwai|ksNebula"),e)},D=function(){if("undefined"==typeof navigator)return"unknown";var e=navigator,t=e.userAgent,n=e.maxTouchPoints;return/android/i.test(t)?"Android":/iPhone|iPad|iPod/.test(t)||t.includes("Mac")&&n>1?"iOS":"unknown"}(),U="Android"===D,j="iOS"===D,M=function(){var e;return"undefined"!=typeof window&&"function"==typeof(null===(e=window.__yodaBridge__)||void 0===e?void 0:e.invoke)},G=!!L("Kwai|ksNebula"),B=Number.MAX_SAFE_INTEGER||9007199254740991,V=!1,W=1,K=H();function H(){var e="".concat(B),t=Number(e.slice(0,3))-100,n=Math.floor(Math.random()*t),r="".concat(Date.now()),o=r.slice(r.length-9),i=new Array(e.length-12).fill(0).join("");return Number("".concat(n).concat(o).concat(i))}function F(e){var t=function(e){var t=K+W++;for(;V||e&&e[t];)t=K+W++;return t}(e);return t>=B?(V=!0,W=1,K=H(),F()):t}function J(e){return F(e)}function Y(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,r=null;return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];clearTimeout(r),r=setTimeout((function(){e.apply(t,i)}),n)}}var z=null;function q(){return z}function Q(e,t){return X.apply(this,arguments)}function X(){return(X=l(c().mark((function e(t,n){var r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=q(),e.next=3,r.bridge("tool","canIUse",{namespace:t,name:n});case 3:return o=e.sent,e.abrupt("return","1"==o.result&&o.canUse);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $="too_performance_";var Z="event_";function ee(e){return Z+J(e)}function te(e){return e.startsWith(Z)}var ne,re=[];!function(e){e[e.unload=0]="unload",e[e.open=1]="open",e[e.close=2]="close"}(ne||(ne={}));var oe=ne.unload,ie=null;function ae(){window.__yodaBridge__.invoke("tool","sendPerformanceLog",JSON.stringify({data:re}),$+J()),re.length=0}var se=Y((function(){ae()}),1e3),ce=function(e,t){if(!function(e){return["canIUse","getApiList"].includes(e.name)}(e)){var n=Date.now().toString();return function(){if(ie)return ie;var e,t=new k,n=t.promise,r=t.resolve;if(ie=n,oe==ne.unload)if(null!==(e=window.__yodaCommonDataObject__)&&void 0!==e&&e.sampleData){var o;if("string"==typeof window.__yodaCommonDataObject__.sampleData)try{window.__yodaCommonDataObject__.sampleData=JSON.parse(window.__yodaCommonDataObject__.sampleData)}catch(e){window.__yodaCommonDataObject__.sampleData={}}oe=null!==(o=window.__yodaCommonDataObject__.sampleData)&&void 0!==o&&o.bridgeHit?ne.open:ne.close,r(oe==ne.open)}else q().bridge("webview","getPageLoadData",{},(function(e){var t=e.result,n=e.sampleData;oe=1==t&&null!=n&&n.bridgeHit?ne.open:ne.close,r(oe==ne.open)}));else r(oe==ne.open);return ie}().then((function(r){r&&(re.push(function(e,t,n){var r,o,i,a,s={key:"bridge",value:{},dimension:{api:e.name,namespace:e.namespace},event_client_timestamp:t,event_trigger_source:"H5",task_identifier:e.callbackId,is_task_event:!0,task_status:""};switch(e.type){case"invoke":s.value.h5_invoke_bridge_time=t,s.task_status="START","function"==typeof(null===(r=window.__yodaBridge__)||void 0===r?void 0:r.invoke)&&"function"==typeof(null===(o=window.webkit)||void 0===o||null===(i=o.messageHandlers)||void 0===i||null===(a=i.KMYYoda)||void 0===a?void 0:a.postMessage)||(s.result=126002,s.error_msg="");break;case"callback":s.value.h5_receive_callback_time=t,s.value.h5_invoke_bridge_time=n,s.dimension.result_type=e.resultCode,s.dimension.result_type&&(s.dimension.result_type=s.dimension.result_type.toString()),s.dimension.error_msg=e.errorMsg,s.task_status="END";break;case"event":s.task_status="SUCCESS",delete s.dimension.api,delete s.dimension.namespace,s.dimension.event=""}return s}(e,n,t)),re.length>=30?ae():se())})),n}};function ue(e){var t=null,n=new Promise((function(e){t=e}));return e&&(n=n.then(e,e)),{isMulti:!1,resolve:t,promise:n}}function le(e){return{isMulti:!0,resolve:e,promise:new Promise((function(){}))}}var de={},pe={pushMQ:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?ee():J(de),o=e?le(t):ue(t);return o.traceId=String(r),de[r]=o,o},removeMQ:function(e){de[e]=void 0},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o=this.pushMQ(n,r);o.namespace=e,o.name=t;var i=ce({namespace:e,name:t,type:"invoke",callbackId:o.traceId});return de[o.traceId].startTime=i,{id:o.traceId,promise:o.promise}},resolve:function(e,t){if(!e.startsWith($)&&!te(e)){var n=de[e];n&&(ce({namespace:n.namespace,name:n.name,type:"callback",callbackId:n.traceId,resultCode:t.result},n.startTime),n.resolve(t),n.isMulti||this.removeMQ(e))}},reject:function(e,t){var n=de[e];n&&(n.resolve(t),n.isMulti||this.removeMQ(e),te(e)||ce({namespace:n.namespace,name:n.name,type:"callback",callbackId:n.traceId,resultCode:t.result,errorMsg:t.message},n.startTime))}},fe={kwai:"Kwai",kwaiAd:"KwaiAd",kwaiAdThird:"KwaiAdThird",kwaiMerchant:"KwaiMerchant",kwaiLive:"KwaiLive",Kwai:"Kwai",KwaiAd:"KwaiAd",KwaiAdThird:"KwaiAdThird",KwaiMerchant:"KwaiMerchant",KwaiLive:"KwaiLive"},he=["popBack","exitWebView"],ve=["setPhysicalBackButton","setTopLeftBtn","setTopLeftSecondBtn","setTopRightBtn","setTopRightSecondBtn"],ge=["on","off"];function ye(e,t,n){var r=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),(e?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx").replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}(!1),o="yoda_kuaishou_plugin_callback_".concat(n,"_").concat(r);return window[o]=function(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(e){}x(e)?e.call(window,n):"string"==typeof e&&x(window[e])&&window[e].call(window,n),t||delete window[o]},o}function me(e,t){var n=e;return e&&Array.isArray(e.actions)&&(n.actions=e.actions.map((function(e){return e&&e.url&&x(e.url)&&(e.url=ye(e.url,!0,t)),e}))),n}var _e={};function be(e,t,n,r){var o=f({},n),i="".concat(e,"_").concat(t);if(ve.includes(t))o.onClick=ye(o.onClick,!0,i);else if(he.includes(t))o=null;else if(ge.includes(t)){var a=ye(r,!1,i);o.handler&&x(o.handler)&&(o.handler=function(e,t){var n="",r=null;if(Object.keys(_e).some((function(t){var o=_e[t];return o===e&&(r=o,n=t,!0)})),r!==e&&e){var o=ye(e,!0,t);_e[o]=e,n=o}return n}(o.handler,i)),o.callback=a}else if("showDialog"===t){var s=o,c=s.positiveButton,u=s.negativeButton,l=s.neutralButton;c&&(o.positiveButton=me(c,i)),u&&(o.negativeButton=me(u,i)),l&&(o.neutralButton=me(l,i))}else if(Object.keys(fe).includes(e)){var d=ye(r,!0,i);o.callback=o.callback||d}return o}var Se,we=function(){return new Error("当前环境存在 Yoda 多实例问题，详细请参考 https://docs.corp.kuaishou.com/k/home/VbQx2ulc6v3M/fcADLOKqHyHpSr7hiCKKQVtVM")},Ee="production",Oe=function(){return Ee},Pe=["debug","info","log","warn","error"],ke=function(e,t){var n;if("production"!==Oe()){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];(n=console)[t].apply(n,["[".concat(e,"]")].concat(o))}},Ie=(Se=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ke.apply(void 0,["@yoda/bridge",e].concat(n))}},Object.fromEntries(Pe.map((function(e){return[e,Se(e)]})))),Ae=function(){var e=l(c().mark((function e(t){var n,r,o,i,a,s,u,l,d,p,f,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.namespace,o=t.name,i=t.params,a=t.multiCallback,s=t.callback,u=fe[r],l=pe.create(r,o,a,s),d=l.id,p=l.promise,f=u||r,h=function(e){xe(d,e)},t.namespace="Kwai"===f&&"undefined"!=typeof navigator&&navigator.userAgent.includes("livemate/")?"livemate":f,t.params=null!==(n=be(f,o,i,h))&&void 0!==n?n:{},Ie.info("Invoking '".concat(t.namespace,".").concat(t.name,"'"),t.params),!(j&&!window.webkit&&N("2.10.9.2")<0)){e.next=10;break}return e.abrupt("return",p);case 10:return window.__yodaBridge__.invoke(t.namespace,t.name,JSON.stringify(t.params),String(d)),e.abrupt("return",p);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(e,t){j&&N("2.3.7")<0&&(e="".concat(e));var n="string"==typeof t?JSON.parse(t):t;1===(null==n?void 0:n.result)?pe.resolve(e,n):pe.reject(e,n)};"undefined"!=typeof window&&(!function(){var e=window.__yodaBridgeCallback__;if("function"==typeof e)throw we();Object.defineProperty(window,"__yodaBridgeCallback__",{get:function(){return e},set:function(t){if(e)throw we();e=t}})}(),window.__yodaBridgeCallback__=xe);var Te,Ce=new Set,Le=function(){var e=l(c().mark((function e(t){var n,r,o,i,a,s,u,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.namespace,o=t.name,i=t.params,a=t.multiCallback,s=t.callback,Ce.size){e.next=6;break}return e.next=4,Ae({namespace:"tool",name:"getApiList",params:{}});case 4:1===(u=e.sent).result&&Array.isArray(u.apiList)&&u.apiList.forEach((function(e){var t=e.namespace,n=e.name;return Ce.add("".concat(t,".").concat(n))}));case 6:return l=Ce.has("".concat(null!==(n=fe[r])&&void 0!==n?n:r,".").concat(o)),e.abrupt("return",new Promise((function(e){if(l)Ae({namespace:r,name:o,params:i,multiCallback:a,callback:s}).then(e);else{var t={result:125004};null==s||s(t),e(t)}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=null,Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(o,e);var t,n,r=(t=o,n=S(),function(){var e,r=b(t);if(n){var o=b(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return w(this,e)});function o(e,t,n){var i,a;return s(this,o),(i=r.call(this,e)).name="BridgeError",i.message=e,i.code=t,i.context={bridge:(a=n).bridge,params:a.params},i}return a(o,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,code:this.code,context:this.context}}}]),o}(O(Error)),De=function(e){return e instanceof Re},Ue=["useLastLocationWhileLimited"],je=["biz","force","statKey","alertScene","updateLocationScene"],Me={getLocation:function(){var e=l(c().mark((function e(t){var n,r,o,i,a,s,u,l,d,p,h,v,g,m,_,b,S,w,E,O,P,k,I,A,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.useLastLocationWhileLimited,r=void 0!==n&&n,o=y(t,Ue),i=Ne.invoke,!(R("10.1.30")<0)){e.next=27;break}return a=o.biz,s=o.force,o.statKey,o.alertScene,o.updateLocationScene,u=y(o,je),l=void 0===s?2:s?1:3,d=f(f({},u),{},{biz_type:a,forced_permission_request:l}),e.prev=6,e.next=9,i("kwai.syncLocationWithPermissionCheck",f(f({},d),{},{forced_permission_request:3}));case 9:return p=e.sent,h=p.data,v=h.longitude,g=h.latitude,e.abrupt("return",{longitude:v,latitude:g});case 16:e.prev=16,e.t0=e.catch(6);case 18:return e.next=20,i("kwai.requestLocationPermissionWithPermissionCheck",d);case 20:return e.next=22,i("kwai.syncLocationWithPermissionCheck",d);case 22:return m=e.sent,_=m.data,b=_.longitude,S=_.latitude,e.abrupt("return",{longitude:b,latitude:S});case 27:return U&&R("10.3.30")<0&&(w=o.updateLocationScene,E=void 0===w?"":w,Object.assign(o,{useInterval:!E})),e.prev=28,e.next=31,i("system.requestLocation",o);case 31:return O=e.sent,P=O.longitude,k=O.latitude,e.abrupt("return",{longitude:P,latitude:k});case 37:if(e.prev=37,e.t1=e.catch(28),De(e.t1)){e.next=41;break}throw e.t1;case 41:if(10014!==e.t1.code||!r){e.next=49;break}return e.next=44,i("system.getLocationCityInfo",{biz:o.biz});case 44:if(I=e.sent,A=I.longitude,x=I.latitude,"number"!=typeof A||"number"!=typeof x){e.next=49;break}return e.abrupt("return",{longitude:A,latitude:x});case 49:throw e.t1;case 50:case"end":return e.stop()}}),e,null,[[6,16],[28,37]])})));return function(t){return e.apply(this,arguments)}}()},Ge=Object.fromEntries(Object.entries({advertise:["startFansTopLivePlay","startNeoAdVideo"],feed:["authorizationStatusForCalendar","changeEventForCalendar","closeChildLock","getAddressBookAccessStatus","getCoronaTvChasingData","getFeed","openDetailPage","openFansGroup","setSettingEntryForCourse","startPlayLongVideo","updateDeviceBit","updateUserRecoBit","updateWeatherInfo","userIncentivesUpdateTasks"],game:["addShortcutToDesktop","appointGame","changeAppointStatus","gameSendLog","gameTaskSelectImage","getAppointStatus","getWebViewDisplayType","kgPageDidShowed","openNativeGamecenter"],growth:["getDeviceSecretInfo","unionPhoneNumber"],im:["setEnableIMTip"],live:["deleteSubscribe","liveReservationNotification","openLiveQuizLive","showSubscribeEditDialog","showSubscribeSelectPhotoDialog","subscribeLive","unsubscribeLive"],merchant:["closeLiveMerchantFloatingWindow","getLatestImage","getSidToken","loadUrlOnNewMerchantPage","merchantSetPhotoPlayStatus","onItemSelected","popupToFollow","querySessionIsStickyOnTop","reqSessionStickyOnTopWithThread","requestLocationAuthorization"],minigame:["publishSogameVideo"],pay:["authThirdPartyAccount","bindWithdrawType","couponPay","hasImportSdk","nebulaStartGatewayWithdraw","openKspayWebView","sfBindWithdrawType","startDeposit","startGatewayPay","startGatewayWithdraw","startHalfScreenRecharge","startKspayOrderPrepay"],platform:["getDarkMode","openWechatMiniProgram","sendSMS","startFaceRecognition"],post:["cancelJsInjectUpload","captureCertVideo","deleteCacheVideoByPhotoId","editAtlas","editDraft","editSmartAlbum","getEditDraftData","getSmartAlbumData","getVideoUploadStatus","intownShare","postAtlas","postVideo","preloadMagicFace","previewVideo","reUploadShopVideo","reeditPhoto","resumeVideoUpload","retryJsInjectUpload","saveImage","saveTempImages","selectAndUploadMedia","selectImage","selectMixMediasAndUpload","selectVideoAndUpload","startAudioRecord","uploadCertVideo","uploadShopVideo","uploadVideoFromAlbum","verifyLiveUser"],social:["addTokenBlockShareId","bindPhone","bindRiskPreCheck","decryptContactsName","enterGroupChat","followUser","joinGroup","login","logout","mobileQuickAuthInfo","mobileQuickLoginInfo","needUpdateProfile","requestFollowUserV2","selectCountryPhoneCode","sendIMMessage","sendImFriendMessage","setPageFollowRefer","setShareTokenToClipBoard","share","startAuthActivity","verifyAccount","verifySMSCode","verifyThirdPartyLogin","wechatLogin"],system:["collapseKeyboard","getPushPermission","getServerTime","gete2","openPushPermission"],tool:["getClipBoard","getExpTagTransList","loadUrlOnNewPage","openBrowser","scanCode"],ui:["selectCity","showBottomSheet","showPicker"],webview:["clearClipBoard","exitWebView","getABTest","getAppEnvironment","getDeviceInfo","hasInstalledApp","hideNavigationBar","popBack","resetTopButtons","setClipBoard","setPageTitle","setSlideBack","setTopLeftBtn","setTopLeftSecondBtn","setTopRightBtn","setTopRightSecondBtn","submitData"]}).flatMap((function(e){var t=m(e,2),n=t[0];return t[1].map((function(e){return["".concat(n,".").concat(e),"kwai.".concat(e)]}))}))),Be=["component.download","kwai.download","kwai.downloadThirdPartyAPP","kwai.startNFC","kwaiAd.callAdBridge","kwaiAd.callCardHandler","pay.startHalfScreenRecharge","post.postVideo","post.reUploadShopVideo","post.selectImage","post.uploadShopVideo","kwaiLive.subscribeChannel"],Ve=new Set(Be),We=new Set([].concat(["social.currentUserInfo","post.draftRecommendPhotos","post.draftRecommendPublishPhotos","kwai.KSVerifyRealNameInfo","kwai.verifyRealNameInfo","component.aliyunVerifyRealNameInfo","component.verifyRealNameInfo"],Be)),Ke="2.0.3",He={get mode(){return Oe()},set mode(e){!function(e){Ee=e}(e),Ie.info("You're currently running version ".concat(Ke," in ").concat(e," mode."))}},Fe=function(e){Object.assign(He,e)},Je=function(e){for(var t=function(t){var n=t[e.bridge];return void 0!==n&&(e.bridge=n,!0)},n=function(t){var n=e.params,r=t[e.bridge];return void 0!==r&&Object.entries(r).some((function(e){var t=m(e,2),r=t[0],o=t[1];return void 0===n[r]&&(n[r]=o,!0)}))};;){var r=e.bridge,o=e.params,i=m(r.split("."),2),a=i[0],s=i[1];if(("tool.checkAppInstalled"!==r||!n(d({},r,{identifier:U?o.android:o.ios})))&&(!(j&&R("9.10.11")>=0&&t({"hybrid.getHybridStatus":"webview.pageContentStatus","hybrid.getAndUpdateHybridDetail":"webview.pageContentInfo","hybrid.preloadVideoList":"media.pvList","hybrid.isVideoFullyCached":"media.vReady"}))&&!(j&&R("10.7.20")<0&&t({"merchant.getSidToken":"kwai.getSidToken"}))&&!(U&&R("10.6.50")<0&&t({"ui.setStatusBarStyle":"kwai.setStatusBarStyle"}))&&(!(R("10.4.30")<0)&&G||!t(Ge))&&!(j&&R("10.4.10")<0&&n({"system.startVibrate":{strength:"low",duration:300}}))&&(!(R("10.3.20")<0)&&G||!t({"webview.exitCurrentWebView":"kwai.".concat(j?"exitCurrentWebview":"exitWebView")})))){if(!(R("9.6.20")<0&&["syncLocationWithPermissionCheck","getLocationWithPermissionCheck","requestLocationPermissionWithPermissionCheck"].includes(s)))break;e.bridge="".concat(a,".").concat(s.replace("WithPermissionCheck",""))}}return e},Ye=["result"],ze=function(e){var t=m(e,3),n=t[0],r=t[1],o=void 0===r?{}:r,i=t[2],a=m("function"==typeof i?[{},i]:[null!=i?i:{}],2);return{initialBridge:n,bridge:n,params:o,options:a[0],callback:a[1]}},qe=function(e){return e.bridge.startsWith("yoda.")},Qe=function(e){var t=e.bridge,n=e.params,r=m(t.split("."),2)[1];return(0,Me[r])(n)},Xe=function(e){var t=q(),n=e.initialBridge,r=e.bridge,o=e.params,i=e.callback,a=m(r.split("."),2),s=a[0],c=a[1];return new Promise((function(a,u){t.bridge(s,c,o,(function(t){var o;if(Ie.info("Received a response from '".concat(r,"'"),t),We.has(n)&&(null==i||i(t)),1!==t.result){var s=t.message,c=void 0===s?function(e){return I(e,"error_msg")&&"string"==typeof e.error_msg?e.error_msg:""}(t):s,l=new Re(c,t.result,e);null===(o=He.errorHandler)||void 0===o||o.call(He,l),u(l)}else{t.result;var d=y(t,Ye);a(d)}}),Ve.has(n))}))},$e=function(){var e=l(c().mark((function e(){var t,n,r,o,i,a,s,u,l,d,p,f,h,v=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=v.length,r=new Array(n),o=0;o<n;o++)r[o]=v[o];if(M()){e.next=5;break}throw i=ze(r),new Re(["Cannot invoke bridge"].concat(g([]),["in non-Yoda environment."]).join(" "),125014,i);case 5:if(a=Je(ze(r)),s=a.bridge,u=a.options.timeout,l=void 0===u?null!==(t=He.timeout)&&void 0!==t?t:0:u,d=qe(a)?Qe(a):Xe(a),!We.has(s)){e.next=13;break}return e.next=11,d;case 11:return p=e.sent,e.abrupt("return",p);case 13:if(!(l>0&&Number.isFinite(l))){e.next=19;break}return e.next=16,Promise.race([d,T(l).then((function(){return Promise.reject(new Re("Bridge invocation timed out after ".concat(l,"ms."),125010,a))}))]);case 16:e.t0=e.sent,e.next=22;break;case 19:return e.next=21,d;case 21:e.t0=e.sent;case 22:return f=e.t0,e.abrupt("return",f);case 26:throw e.prev=26,e.t1=e.catch(0),De(e.t1)&&(null===(h=He.errorHandler)||void 0===h||h.call(He,e.t1)),e.t1;case 30:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(){return e.apply(this,arguments)}}(),Ze=new Set(["native_pageFinished","native_visible","native_background","native_foreground","native_will_leave","native_leave","native_reentry","native_loadPage","native_networkChanged","native_web_view_display_mode_changed","native_share_dialog_event","native_shake","native_darkModeChange"]),et=function(){var e=l(c().mark((function e(t,n,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ze.has(t)){e.next=4;break}return e.next=3,$e("kwai.on",{type:t,handler:n});case 3:return e.abrupt("return");case 4:return e.next=6,$e("event.addEventListener",{type:void 0===(null==r?void 0:r.data)?t:{type:t,options:r.data},listener:n});case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),tt=function(){var e=l(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ze.has(t)){e.next=4;break}return e.next=3,$e("kwai.off",{type:t,handler:n});case 3:return e.abrupt("return");case 4:return e.next=6,$e("event.removeEventListener",{type:t,listener:n});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),nt={};function rt(e){var t,n=nt[e];return t=n.callbackId,Z+String(t)}function ot(e){var t=nt[e];return Object.keys((null==t?void 0:t.eventRecord)||{}).length>0}!function(e){e.x="x",e.y="y",e.z="z"}(Te||(Te={}));var it="shaked",at={level:2,times:3,intervalTime:1300,iOSIntervalTime:500,androidIntervalTime:1300,isEmitImmediately:!0},st={1:{basic:13,total:450},2:{basic:16,total:700},3:{basic:20,total:1100}},ct={1:{basic:9,total:220},2:{basic:12,total:400},3:{basic:14,total:500}},ut=function(){function e(t){var n=this;s(this,e),this.shakeConfig={},this.shakedArr=[],this.isChecking=!1,this.nowStatus={x:0,y:0,z:0},this.lastStatus={x:0,y:0,z:0},this.stopMark=null,this.checkIsShakeStoped=!1,this.notEmitButShaked=!0,this.isShakeStarted=!1,this.isAndroid=!1,this.isArrivedConfigStandard=!1,this.levelMap=st,this.dispatchEvent=null,this.setStillShaking=Y((function(){return n.notShaking()}),1e3),this.dispatchEvent=t.dispatchEvent,this.isAndroid=t.isAndroid,this.levelMap=this.isAndroid?st:ct}var t;return a(e,[{key:"setOptions",value:function(e){e?(this.shakeConfig=f(f({},at),e),this.shakeConfig.times=this.isAndroid?this.shakeConfig.times-1:2*(this.shakeConfig.times-1),this.shakeConfig.intervalTime=this.isAndroid?this.shakeConfig.androidIntervalTime:this.shakeConfig.iOSIntervalTime):this.shakeConfig=f({},at)}},{key:"resetShakeStatus",value:function(e){this.shakedArr=[],this.isChecking=!1,this.notEmitButShaked=!1,e&&(this.isArrivedConfigStandard=!1,this.isShakeStarted=!1)}},{key:"checkIsShake",value:function(e){var t=this;if(this.isChecking=!0,Object.keys(this.nowStatus).forEach((function(n){return t.nowStatus[n]=9.8*e[n]})),this.judgeArrivedTerminal())return this.lastStatus={x:0,y:0,z:0},this.handleShakeHappend(),this.setStillShaking(),void(this.isChecking=!1);this.judgeLikelyShake()?this.handleArrivedStandard():this.isChecking=!1}},{key:"judgeLikelyShake",value:function(){var e=this.nowStatus,t=e.x,n=e.y,r=e.z,o=this.levelMap[this.shakeConfig.level],i=o.basic,a=o.total;return t>i||n>i||r>i||t*t+n*n+r*r>a}},{key:"judgeArrivedTerminal",value:function(){var e=this,t=0,n=0,r=Te.x;return Object.keys(this.nowStatus).forEach((function(o){n=Math.abs(e.lastStatus[o]-e.nowStatus[o]),t<n&&(r=o,t=n)})),this.lastStatus[r]*this.nowStatus[r]<0}},{key:"handleArrivedStandard",value:function(){this.lastStatus=f({},this.nowStatus),this.checkIsShakeStoped=!1,this.setStillShaking()}},{key:"handleShakeHappend",value:(t=l(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isShakeStarted){e.next=3;break}return e.next=3,this.dispatchEvent({type:"shake-start",data:{}});case 3:this.isShakeStarted=!0,this.updateShakedArr((new Date).getTime());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"notShaking",value:function(){this.checkIsShakeStoped=!0,this.checkDoDelayEmit()}},{key:"updateShakedArr",value:function(e){var t=this.shakeConfig.intervalTime;this.shakedArr.length>0?e-this.shakedArr[this.shakedArr.length-1]<=t?this.shakedArr.push(e):(this.shakedArr=[],this.isChecking=!1):this.shakedArr.push(e),this.shakedArr.length>=this.shakeConfig.times?this.handleArrivedEmitStandard():this.isChecking=!1}},{key:"handleArrivedEmitStandard",value:function(){this.isArrivedConfigStandard=!0,this.resetShakeStatus(),this.shakeConfig.isEmitImmediately?this.dispatchEvent({type:it,data:{}}):this.notEmitButShaked=!0}},{key:"checkDoDelayEmit",value:function(){this.notEmitButShaked&&this.checkIsShakeStoped&&!this.shakeConfig.isEmitImmediately&&this.dispatchEvent({type:it,data:{}}),this.isShakeStarted&&this.dispatchEvent({type:"shake-end",data:{isArrivedConfigStandard:this.isArrivedConfigStandard}}),this.resetShakeStatus(!0)}}]),e}(),lt=null,dt=null,pt=function(){var e=l(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=q(),e.next=3,t.bridge("system","startAccelerometer",{interval:60});case 3:return n=e.sent,dt=lt.checkIsShake.bind(lt),e.next=7,t.bridge("event","addEventListener",{type:"accelerometer-change",listener:dt});case 7:if(r=e.sent,1===n.result&&1!==r.result&&vt(),1===n.result&&1===r.result){e.next=11;break}throw new Error("摇一摇初始化失败，请稍后重试。AccelerometerRes:".concat(JSON.stringify(n),";eventRes:").concat(JSON.stringify(r)));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ft=function(e){if(e){var t=e.level,n=e.times,r=e.isEmitImmediately;if(void 0!==t&&!st[t])throw new Error("请传入正确的level，可选值为1、2、3");if(void 0!==n){if(!Number.isInteger(n))throw new Error("times应为整数");if(n<1)throw new Error("times应大于1")}if(void 0!==r&&"boolean"!=typeof r)throw new Error("isEmitImmediately应为boolean类型")}},ht=function(){var e=l(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=q(),e.next=3,Q("system","startAccelerometer");case 3:if(e.sent){e.next=5;break}throw new Error("当前APP暂不支持摇一摇");case 5:if(!lt){e.next=7;break}throw new Error("当前存在尚未结束监听的摇一摇");case 7:return lt=new ut({dispatchEvent:function(){var e=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.bridge("event","dispatchEvent",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isAndroid:U}),ft(t),lt.setOptions(t),lt.resetShakeStatus(),e.next=14,pt.bind(n)();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vt=function(){var e=l(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=q(),e.next=3,Q("system","stopAccelerometer");case 3:if(e.sent){e.next=5;break}throw new Error("当前APP暂不支持摇一摇");case 5:return lt=null,e.next=8,t.bridge("event","removeEventListener",{type:"accelerometer-change",listener:dt});case 8:return n=e.sent,e.next=11,t.bridge("system","stopAccelerometer",{});case 11:if(r=e.sent,1===n.result&&1===r.result){e.next=14;break}throw new Error("摇一摇停止监听失败。stopRes:".concat(JSON.stringify(r),";eventRes:").concat(JSON.stringify(n)));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gt=it,yt=d({},gt,ht),mt=d({},gt,vt),_t=function(e,t){var n,r=e.type,o=e.listener,i="string"==typeof r?r:r.type,a="string"==typeof r?{}:r.options;if(null===(n=yt[i])||void 0===n||n.call(yt,a),!o.__yodaCallbackId__&&(o.__yodaCallbackId__={}),o.__yodaCallbackId__[i])throw new Error("addEventListener ".concat(i," 的 listener 已经被绑定过了"));var s=ot(i),c=null,u=Promise.resolve();if(s)x(t)&&t({result:1});else{var l=pe.pushMQ(!0,function(e){return function(t){var n=nt[e];Object.keys((null==n?void 0:n.eventRecord)||{}).forEach((function(e){return n.eventRecord[Number(e)](JSON.parse(JSON.stringify(t)))}))}}(i),!0);c=parseInt(l.traceId.replace(Z,"")),u=Ae({namespace:"event",name:"addEventListener",params:{type:i,listener:String(l.traceId)},callback:t})}return function(e,t,n){var r=nt[e]||{callbackId:n,eventRecord:{}},o=J();t.__yodaCallbackId__[e]=String(o),r.eventRecord[o]=t,nt[e]=r}(i,o,c),u},bt=function(e,t){var n,r=e.type,o=e.listener;null===(n=mt[r])||void 0===n||n.call(mt);var i=Promise.resolve();if(o.__yodaCallbackId__){var a=rt(r);!function(e,t){var n=nt[e],r=t.__yodaCallbackId__[e];delete n.eventRecord[Number(r)],delete t.__yodaCallbackId__[e],ot(e)||delete nt[e]}(r,o),ot(r)||(i=Ae({namespace:"event",name:"removeEventListener",params:{type:r,listener:a},callback:t}),pe.removeMQ(a))}return i};z={bridge:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={namespace:e,name:t,params:n,multiCallback:o,callback:r};if("event"===e){if("addEventListener"===t)return _t(n,r);if("removeEventListener"===t)return bt(n,r)}return 0===R("9.9.20")&&U?Le(i):Ae(i)}},Ne={invoke:$e,addListener:et,removeListener:tt}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiManager=void 0;var i=n(1),a=n(23),s=n(35),c=n(9),u=n(51),l=n(0),d=function(e){function t(t){var n=e.call(this,new a.KwaiContext(t))||this;return n.init=function(){n.initDynamicPlugin(),n.context.init(),n.setPageInfo(null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href,null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.document.referrer),n.handleCache()},n.handleCache=function(){var e=(0,c.getWorkspace)(),t=e._i;if(Object.entries(t).forEach((function(e){var t=e[0],r=e[1],o=!1;if(!0!==r._init&&(n.loadPixel(t),r._init=!0,o=r.length>0),o)for(;r.length;){var i=r.shift();if(i){var a=i[0],s=i.slice(1),c=n.instance(t);if(!n.isEmptyInstance(c))switch(a){case"page":n.page(s[0]);break;case"track":c.track(s[0],s[1])}}}})),e.length>0)for(;e.length;){var r=e.shift();if(r){var o=r[0],i=r.slice(1);switch(o){case"page":n.page(i[0]);break;case"track":n.track(i[0],i[1])}}}},n.createPixel=function(e){return new s.KwaiPixel(e,n.context)},n.initDynamicPlugin=function(){var e=(0,c.getWorkspace)().dynamicPlugins;(void 0===e?[]:e).forEach((function(e){try{n.useDynamicPlugin(e)}catch(e){(0,l.JSLogger)({error:e})}}))},n}return o(t,e),t}(u.Manager);t.KwaiManager=d},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiContext=void 0;var s=n(1),c=n(3),u=n(30),l=n(32),d=n(2),p=n(0),f=function(e){function t(t){var n=e.call(this,t)||this;return n.trackFlag=!1,n.init=function(){n.onContextInitStart(),n.listenSPAHistoryChange(),n.onPageLoaded(),n.onPageLeave(),n.onVisibilityChange(),e.prototype.init.call(n)},n.onPageLoaded=function(){s.windowSnapshot&&s.windowSnapshot.addEventListener("load",(function(){n.triggerPluginHook("pageDidLoad")}),{once:!0})},n.onPageLeave=function(){if(s.windowSnapshot){var e=function(e){return function(){var t=new Date;n.triggerPluginHook("pageWillLeave",t,e)}};if((0,c.getDeviceType)()===c.DeviceType.IOS){var t="onpagehide"in s.windowSnapshot?"pagehide":"unload";s.windowSnapshot.addEventListener(t,e(t))}else s.windowSnapshot.addEventListener("beforeunload",e("beforeunload"),{once:!0})}},n.onVisibilityChange=function(){s.windowSnapshot&&s.windowSnapshot.addEventListener("visibilitychange",(function(){var e=new Date,t="visible"===document.visibilityState;n.triggerPluginHook("visibilityChange",e,t)}))},n.trackSync=function(t,r,o,s,c){return i(n,void 0,void 0,(function(){return a(this,(function(n){try{this.data.trackFlag=this.trackFlag,e.prototype.trackSync.call(this,t,r,o,s,c)}catch(e){(0,p.JSLogger)({error:e})}return[2]}))}))},n.listenSPAHistoryChange=function(){if(s.windowSnapshot){var e=s.windowSnapshot,t=function(t,n){var r=e.history[t];return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];r.apply(e.history,t),n()}},r=function(){var e,t,r,o,i,a,c=null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location.href,u=null===(t=null===(e=n.data)||void 0===e?void 0:e.pageInfo)||void 0===t?void 0:t.url;if(c&&c!==u){n.setPageInfo(c);var l=null!==(i=null===(o=null===(r=n.data)||void 0===r?void 0:r.adInfo)||void 0===o?void 0:o.pixelId)&&void 0!==i?i:"",d=n.data.pixelMap[l];null===(a=null==d?void 0:d.setPixelInfo)||void 0===a||a.call(d)}};e.addEventListener("popstate",r),e.history.pushState=t("pushState",r),e.history.replaceState=t("replaceState",r)}},n.updateOnWindowSnapshotChanged=function(){e.prototype.updateOnWindowSnapshotChanged.call(n),n.resetTestId()},n.validInPreview=function(e,t){var r;if(n.trackFlag&&t!==d.PAGE_VIEW_EVENT_NAME){var o=null!==(r=n.data.adInfo)&&void 0!==r?r:{},i=o.pixelId,a=o.callback,s=void 0===a?"":a,l={pixelId:i,status:[],pageUrl:location.href,extraData:"",clickId:s},p=l.status,f={eventName:t};i&&!n.getPixel(i)&&p.push(u.PreviewReportStatus.PIXEL_ERROR_ID_MISS_MATCH),(0,c.isInIframe)()&&!i&&p.push(u.PreviewReportStatus.PIXEL_ERROR_IN_IFRAME),""===t?p.push(u.PreviewReportStatus.EVENT_ERROR_EMPTY_NAME):Object.keys(d.EVENT_NAME).includes(t)||p.push(u.PreviewReportStatus.EVENT_ERROR_WRONG_NAME),e&&!n.getPixel(e)&&p.push(u.PreviewReportStatus.EVENT_ERROR_ID_MISS_MATCH),p.length>0&&(l.extraData=JSON.stringify(f),u.PreviewReportService.report(l,n))}},n.resetTestId(),n}return o(t,e),t.prototype.resetTestId=function(){return i(this,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this,[4,(0,c.getTrackFlag)()];case 1:return e.trackFlag=n.sent(),[3,3];case 2:return t=n.sent(),(0,p.JSLogger)({error:t}),[3,3];case 3:return[2]}}))}))},t.prototype.onContextInitStart=function(){var e=new Date;this.triggerPluginHook("contextInitStart",e)},t}(l.Context);t.KwaiContext=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomain=void 0;var r=n(1),o=n(25);t.getDomain=function(e){e||(e=(null===r.windowSnapshot||void 0===r.windowSnapshot?void 0:r.windowSnapshot.location.hostname)||"");var t=e.split("."),n=t.length,i=t[n-1],a=Number.parseInt(i);if(2==n)return"."+e;if(!isNaN(a))return e;for(var s=[];t.length;){var c=t.pop();if(!c)break;if(s.unshift(c),-1===o.DOMAINS.indexOf(c))break}return"."+s.join(".")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMAINS=void 0,t.DOMAINS=["ac","ad","ae","af","ag","ai","al","am","ao","aq","ar","as","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","bj","bm","bn","bo","br","bs","bt","bw","by","bz","ca","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gd","ge","gf","gg","gh","gi","gl","gm","gn","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","io","iq","ir","is","it","je","jm","jo","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mk","ml","mm","mn","mo","mp","mq","mr","ms","mt","mu","mv","mw","mx","my","mz","na","nc","ne","nf","ng","ni","nl","no","np","nr","nu","nz","om","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","ye","yt","za","zm","zw","bar","bible","biz","church","club","college","com","design","dev","download","eco","eus","google","green","hiv","icu","info","kaufen","kiwi","lat","lgbt","moe","name","net","ninja","ngo","one","ong","ooo","org","top","pro","wiki","wtf","xyz","app","aero","asia","cat","coop","edu","gov","int","jobs","mil","mobi","museum","post","tel","travel","xxx","africa","alsace","amsterdam","bcn","berlin","brussels","bzh","cymru","eu","eus","frl","gal","gent","irish","ist ","istanbul","kiwi","krd","lat","london","melbourne","miami","nyc","paris","quebec","rio","saarland","scot","sydney","taipei","tokyo","vegas","vlaanderen","wales","wien","arpa","nato","example","invalid","localhost","test","onion","bit","bitnet","csnet","exit","local","onion","root","uucp","chn","africa","bcn","wales","bzh","cym","cymru","eng","lli","sic","wales","geo","mail","web","free","kid","kids","music","bl ","bq ","eh ","mf","bv ","gb ","sj","an ","bu ","cs ","dd ","tp ","um ","yu ","zr","bet","fun"]},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getValFromCookieByName=void 0;var i=n(0),a=n(8);t.getValFromCookieByName=function(e){var t=e.name;return r(void 0,void 0,void 0,(function(){var e,n,r,s,c,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,a.getCookie)()];case 1:return e=o.sent(),t&&e.length>0&&-1!==(n=e.indexOf(t+"="))?(r=n+t.length+1,s=e.indexOf(";",r),c="",c=-1===s?e.substring(r):e.substring(r,s),[2,decodeURIComponent(c)]):[3,3];case 2:return u=o.sent(),(0,i.JSLogger)({error:u}),[3,3];case 3:return[2,""]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandom=void 0;t.getRandom=function(e){return"".concat(e,"-").concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHump=void 0;t.toHump=function(e){return e.replace(/_(\w)/g,(function(e,t){return t.toUpperCase()}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getTrackFlag=void 0;var i=n(1),a=n(2),s=n(3),c=n(7),u=n(16),l=n(0);t.getTrackFlag=function(){return r(void 0,void 0,void 0,(function(){var e,t,n,r,d,p;return o(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),!i.windowSnapshot)return[2,!1];if(e=(0,u.getQueryString)(a.KWAI_TEST_ID,null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href)||i.windowSnapshot.document.referrer&&(0,u.getQueryString)(a.KWAI_TEST_ID,i.windowSnapshot.document.referrer),(0,s.isInIframe)()&&!e)try{e=(0,u.getQueryString)(a.KWAI_TEST_ID,null===(p=i.windowSnapshot.top)||void 0===p?void 0:p.location.href)}catch(e){}return[4,(0,s.readVal)({key:a.KWAI_TEST_ID})];case 1:return t=o.sent(),(r=t)?[3,3]:[4,(0,s.getValFromCookieByName)({name:a.KWAI_TEST_ID})];case 2:r=o.sent(),o.label=3;case 3:return n=r,e&&e!==n?((0,s.writeVal)({key:a.KWAI_TEST_ID,val:e}),[4,(0,c.setCookieByName)({name:a.KWAI_TEST_ID,value:e,seconds:1800})]):[3,5];case 4:o.sent(),o.label=5;case 5:return[2,"1"===String(e||n)];case 6:return d=o.sent(),(0,l.JSLogger)({error:d}),[2,!1];case 7:return[2]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewReportService=t.PreviewReportStatus=void 0;var r=n(2),o=n(5),i=n(4),a=n(0);!function(e){e[e.PIXEL_ERROR_ID_MISS_MATCH=1]="PIXEL_ERROR_ID_MISS_MATCH",e[e.PIXEL_ERROR_IN_IFRAME=2]="PIXEL_ERROR_IN_IFRAME",e[e.EVENT_ERROR_WRONG_NAME=3]="EVENT_ERROR_WRONG_NAME",e[e.EVENT_ERROR_EMPTY_NAME=4]="EVENT_ERROR_EMPTY_NAME",e[e.EVENT_ERROR_ID_MISS_MATCH=5]="EVENT_ERROR_ID_MISS_MATCH",e[e.EVENT_ERROR_EMPTY_PIXEL_ID=6]="EVENT_ERROR_EMPTY_PIXEL_ID"}(t.PreviewReportStatus||(t.PreviewReportStatus={}));var s=function(){function e(){}return e.report=function(e,t){o.xhrService.post(r.API.PREVIEW_REPORT,e).then((function(e){var n,o=e.result,s=e.err_msg;1!==o&&(null===(n=null==t?void 0:t.plugins.logger)||void 0===n||n.logger({name:i.LOGGER_TYPES_NAME.previewErrUp,extra_info:s})),(0,a.APILogger)({apiPath:r.API.PREVIEW_REPORT,actionStatus:1!==o?i.ActionStatus.NOT_VALID_API_RETURNS:i.ActionStatus.SUCCESS,error:1!==o?s||"result !== 1":void 0,response:e})})).catch((function(e){var n;null===(n=null==t?void 0:t.plugins.logger)||void 0===n||n.logger({name:i.LOGGER_TYPES_NAME.previewErrUp,extra_info:JSON.stringify(e)})}))},e}();t.PreviewReportService=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerPlugin=void 0;var u=n(12),l=n(18),d=n(15),p=n(10),f=n(6),h=n(8),v=n(13),g=n(2),y=n(1),m=n(0),_=function(e){function t(t){var n=this,r=t.context,o=c(t,["context"]);return(n=e.call(this,r)||this).adInfoActionCache=[],n.needLogger=Math.random()<=.03,n.retryPixelIdsInGetConfig=[],n.logFMP=function(){var e;null===(e=n.radar)||void 0===e||e.fmp()},n.logger=function(e){var t,r;null===(t=n.radar)||void 0===t||t.event(e),null===(r=n.loggerService)||void 0===r||r.report(n.apiUrl,{name:e.name,extraInfo:e.extra_info})},n.JSLogger=function(e){var t,r;null===(t=n.radar)||void 0===t||t.event(e),null===(r=n.JSLoggerService)||void 0===r||r.report(n.apiUrl,{name:e.name,extraInfo:e.extra_info})},n.updateAdInfoAction=function(e){var t=e.eventName,r=e.clickId;n.adInfoActionCache.forEach((function(e){var o,a,s={name:e.name,extra_info:JSON.stringify(i(i(i({},n.generateCommonExtraInfo()),null!==(o=e.extra_info_obj)&&void 0!==o?o:{}),{eventName:t,clickId:r}))};null===(a=n.radar)||void 0===a||a.event(s),n.logger(s)})),n.adInfoActionCache=[]},n.logAdInfoAction=function(e){var t;(null===(t=e.extra_info_obj)||void 0===t?void 0:t.actionStatus)!==f.ActionStatus.SUCCESS||n.adInfoSource||(n.adInfoSource=e.name),n.adInfoActionCache.push(e)},n.logI18nCostAction=function(e){var t;null===(t=n.loggerCost)||void 0===t||t.report(n.apiUrl,{name:f.LOGGER_TYPES_NAME.I18N_AD_COST_LOG,extraInfo:JSON.stringify(i(i({},n.generateCommonExtraInfo()),e))})},n.logRetryPixelIdInGetPixelConfig=function(e){n.retryPixelIdsInGetConfig.push(e)},n.logI18nSuccessWithRetryAction=function(e,t){var r;(e||t.pixelId&&n.retryPixelIdsInGetConfig.includes(t.pixelId))&&(null===(r=n.loggerCost)||void 0===r||r.report(n.apiUrl,{name:f.LOGGER_TYPES_NAME.I18N_AD_COST_LOG,extraInfo:JSON.stringify(i(i({},n.generateCommonExtraInfo()),t))}))},n.logWC=function(){return a(n,void 0,void 0,(function(){var e,t,n,r,o,i;return s(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,(0,h.getCookie)()];case 1:return e=a.sent(),t=(0,l.getWdata)(e),n={name:f.LOGGER_TYPES_NAME.wAndc,extra_info:JSON.stringify({trilateralDate:t||"none"})},null===(o=this.radar)||void 0===o||o.event(n),null===(i=this.loggerService)||void 0===i||i.report(this.apiUrl,{name:n.name,extraInfo:n.extra_info}),[3,3];case 2:return r=a.sent(),(0,m.JSLogger)({error:r}),[3,3];case 3:return[2]}}))}))},n.logPreviewReport=function(e,t){var r,o;try{(null===(r=null==e?void 0:e.context)||void 0===r?void 0:r.trackFlag)&&(null===(o=n.rawRadar)||void 0===o||o.event(t))}catch(e){(0,m.JSLogger)({error:e})}},n.init(o),n.loggerService=n.needLogger?new v.HttpLoggerService:void 0,n.loggerCost=new v.HttpLoggerService,n.JSLoggerService=m.JSLoggerServer,n.apiUrl=g.PRODUCTION?g.LOGGER_API:g.BETA_LOGGER_API,(0,m.setLogger)({api:n.JSLogger.bind(n)}),n}return o(t,e),t.prototype.init=function(e){var t=e.radar;t&&(this.radar=Math.random()<=.1?t:void 0,this.rawRadar=t)},t.prototype.contextInitStart=function(){},t.prototype.generateCommonExtraInfo=function(){return{isPixelAD:(0,p.isPixelAD)(),isInWebView:(0,p.isInWebView)(),isPreload:(0,d.getIsPreload)(),_version:g.SDK_VERSION,currentHref:null===y.windowSnapshot||void 0===y.windowSnapshot?void 0:y.windowSnapshot.location.href}},t}(u.Plugin);t.LoggerPlugin=_},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var a=n(1),s=n(2),c=n(33),u=n(3),l=n(2),d=n(11),p=n(18),f=n(4),h=n(8),v=n(0),g=n(7),y=function(){function e(e){var t=this;this.plugins={},this.usePlugin=function(e){var n=e.name,r=e.plugin;t.plugins[n]||(n===d.PluginName.CACHE_PLUGIN||d.PluginName.LOGGER_PLUGIN,t.plugins[n]=r)},this.getInitContextData=function(e,n){return t.initPageSign().then((function(e){t.data.pageSign=e})),n||t.setAdInfo(),{libVersion:e,pixelMap:{},pageInfo:{url:""},pageSign:void 0,adInfo:void 0}},this.setAdInfo=function(){t.getAdInfoPromise=t.initAdInfo().then((function(e){return t.data.adInfo=e,t.triggerPluginHook("adInfoInitEnd"),e}))},this.hasAdInfo=function(){var e,n;return!(!(null===(e=t.data.adInfo)||void 0===e?void 0:e.callback)||!(null===(n=t.data.adInfo)||void 0===n?void 0:n.pixelId))},this.initAdInfo=function(){return o(t,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(o){switch(o.label){case 0:e=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,null===(r=this.plugins.cache)||void 0===r?void 0:r.getAdInfo()];case 2:return(null==(t=o.sent())?void 0:t.callback)&&(null==t?void 0:t.pixelId)&&(e={callback:null==t?void 0:t.callback,pixelId:null==t?void 0:t.pixelId}),[3,4];case 3:return n=o.sent(),(0,v.JSLogger)({error:n}),e=void 0,[3,4];case 4:return[2,e]}}))}))},this.sendPixelError=function(e,t){},this.track=function(e,n,r,c,l,d){return o(t,void 0,void 0,(function(){var t,o,l,p,h,g,y,m,_,b,S,w,E,O,P,k,I,A;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getAdInfoPromise];case 1:return i.sent(),this.validInPreview(e,n),d!==this.data.pixelMap[e].accessMode&&n!==s.EVENT_NAME_FORMAT.EVENT_PAGE_VIEW?[2]:((null===(l=this.data.adInfo)||void 0===l?void 0:l.pixelId)==e?(0,u.getIsPreload)(this.data.pageInfo.url)||this.trackSync(e,n,r,c):(t=JSON.stringify({pixelId:e,urlPixelId:null===(p=this.data.adInfo)||void 0===p?void 0:p.pixelId,clickId:null===(h=this.data.adInfo)||void 0===h?void 0:h.callback,currentHref:null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.location.href,eventName:n,params:r,ext:"页面嵌入的pixel与url里的pixel信息不一致，url/bridge里面pixelid是:".concat(null===(g=this.data.adInfo)||void 0===g?void 0:g.pixelId,"，页面pixelid是：").concat(e,"，上报被拦截，未触发上报接口")}),(null===(m=null===(y=this.data)||void 0===y?void 0:y.adInfo)||void 0===m?void 0:m.pixelId)&&18===(null===(b=null===(_=this.data.adInfo)||void 0===_?void 0:_.pixelId)||void 0===b?void 0:b.toString().length)&&/^[0-9]*$/.test(null===(w=null===(S=this.data)||void 0===S?void 0:S.adInfo)||void 0===w?void 0:w.pixelId)?null===(O=this.plugins.logger)||void 0===O||O.logger({name:f.LOGGER_TYPES_NAME.errMatchPixelId,extra_info:t}):null===(E=this.plugins.logger)||void 0===E||E.logger({name:f.LOGGER_TYPES_NAME.errPixelId,extra_info:t}),(null===(P=this.data.adInfo)||void 0===P?void 0:P.callback)||null===(k=this.plugins.logger)||void 0===k||k.logger({name:f.LOGGER_TYPES_NAME.errClickId,extra_info:t})),n!==s.EVENT_NAME.pageView&&n!==s.EVENT_NAME_FORMAT.EVENT_PAGE_VIEW&&(null===(I=this.plugins.logger)||void 0===I||I.updateAdInfoAction({eventName:n,clickId:null===(A=this.data.adInfo)||void 0===A?void 0:A.callback})),[3,3]);case 2:return o=i.sent(),(0,v.JSLogger)({error:o}),[3,3];case 3:return[2]}}))}))},this.addPixel=function(e){var n=e.pixelId;t.data.pixelMap[n]=e,t.triggerPluginHook("pixelDidMount",e)},this.getPixel=function(e){return t.data.pixelMap[e]||null},this.getAllPixels=function(){return t.pixels},this.setPageInfo=function(e,n){if(e){var o=t.data,i=o.pageInfo,a=o.pageSign;i.url!==e&&(t.triggerPluginHook("pageUrlWillChange",i.url,e),void 0!==i.url&&(i.referrer=i.url),n&&(i.referrer=n),t.data.pageSign=r(r({},null!=a?a:{}),{pageId:(0,u.getRandom)("pageId")}),i.url=e,t.triggerPluginHook("pageUrlDidChange",e))}},this.getSessionIdFromCache=function(){return o(t,void 0,void 0,(function(){return i(this,(function(e){return[2,(0,g.readValFromStorage)({key:s.KWAI_SESSION_ID})]}))}))},this.setSessionIdToCache=function(e){try{(0,u.writeVal)({key:s.KWAI_SESSION_ID,val:e})}catch(e){(0,v.JSLogger)({error:e})}},this.initPageSign=function(){return o(t,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getSessionIdFromCache()];case 1:return(e=n.sent())||(e=(0,u.getRandom)(s.SESSION_ID),this.setSessionIdToCache(e)),[2,{sessionId:e,pageId:(0,u.getRandom)(s.PAGE_ID)}];case 2:return t=n.sent(),(0,v.JSLogger)({error:t}),[2,{pageId:(0,u.getRandom)(s.PAGE_ID)}];case 3:return[2]}}))}))},this.assemblyData=function(e,n,r){var o=t.data,i=o.pageInfo,a=o.pageSign,s=o.libVersion,c=o.adInfo,l=o.trackFlag,d=void 0!==l&&l;return{eventName:n,eventId:"".concat((0,u.getRandom)("eventId"),"-").concat(e),timestamp:(new Date).toJSON(),context:{ad:{callback:null==c?void 0:c.callback,pixelId:null==c?void 0:c.pixelId},pixel:{code:e},page:i,libVersion:s,trackFlag:d,sessionId:"".concat(null==a?void 0:a.sessionId,"-").concat(e),pageViewId:"".concat(null==a?void 0:a.pageId,"-").concat(e)},params:r}},this.validInPreview=function(e,t){},this.logFMP=function(){var e;null===(e=t.plugins.logger)||void 0===e||e.logFMP();var n=new Date;t.triggerPluginHook("logFMP",n)},this.reportService=new c.ReportService({context:this}),this.libVersion=e,this.data=this.getInitContextData(e,!0)}return e.prototype.init=function(){this.data=this.getInitContextData(this.libVersion)},Object.defineProperty(e.prototype,"pixels",{get:function(){var e=this.data.pixelMap;return Object.keys(e).map((function(t){return e[t]}))},enumerable:!1,configurable:!0}),e.prototype.triggerPluginHook=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Object.keys(this.plugins).forEach((function(r){try{var o=t.plugins[r];"function"==typeof(null==o?void 0:o[e])&&o[e].apply(o,n)}catch(e){(0,v.JSLogger)({error:e})}}))},e.prototype.trackSync=function(e,t,n,r,c){var d,g,y,m;return o(this,void 0,void 0,(function(){var o,_,b,S,w,E,O,P,k,I,A;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),null===(o=this.getPixel(e))?[3,3]:(_=this.assemblyData(e,t,n),b=s.API[r],S={pixelId:o.pixelId,accessMode:o.accessMode,currentHref:null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.location.href},_.params||(_.params={}),[4,(0,h.getCookie)()]);case 1:w=i.sent(),E=void 0;try{E=(0,p.getWdata)(w)}catch(e){}return O=(null==n?void 0:n.tirdParty)||E||"none",P=_.params,k="kwaiInfo",A={currentHref:null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.location.href,host:null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.location.host,navigator:null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.navigator.userAgent,eventId:_.eventId,tirdParty:O},[4,(0,u.readVal)({key:l.KWAI_CALLBACK_SOURCE})];case 2:P[k]=(A.kwaiAdInfoSource=i.sent(),A.referrer=null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.document.referrer,A.inIframe=(0,u.isInIframe)(),A.isGtm=(0,p.getIsGtm)(),A),b&&this.reportService.report(b,_,S,{async:!1,trySendBeacon:null==c?void 0:c.trySendBeacon,retry:2,retryDelay:1e3}),(null===(d=this.data.adInfo)||void 0===d?void 0:d.callback)&&(null===(g=this.plugins.logger)||void 0===g?void 0:g.adInfoSource)===f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_BRIDGE&&(null===(y=this.plugins.logger)||void 0===y||y.logI18nCostAction({eventName:t,pixelId:e,clickId:null===(m=this.data.adInfo)||void 0===m?void 0:m.callback,costInfoType:f.CostInfoType.BridgeYodaV2,thirdParty:O,pixel_extra_data:_})),i.label=3;case 3:return[3,5];case 4:return I=i.sent(),(0,v.JSLogger)({error:I}),[3,5];case 5:return[2]}}))}))},e.prototype.updateOnWindowSnapshotChanged=function(){this.setAdInfo(),this.setPageInfo(null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.location.href,null===a.windowSnapshot||void 0===a.windowSnapshot?void 0:a.windowSnapshot.document.referrer)},e}();t.Context=y},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReportService=void 0;var a=n(5),s=n(2),c=n(3),u=n(4),l=n(0),d=n(34),p=n(14),f=function(e){var t=e.context,n=this;this.xhrService=a.xhrService,this.report=function(e,t,a,f){(null==f?void 0:f.trySendBeacon)&&d.httpService.sendBeacon(e,(0,p.formatter)(t,p.SendMethod.BEACON))||n.xhrService.postCustom(e,t,f).then((function(d){return o(n,void 0,void 0,(function(){var n,o,p,f,h,v,g,y,m,_,b,S,w,E,O,P,k,I,A,x,T,C;return i(this,(function(i){switch(i.label){case 0:return n=d,"object"!=typeof d&&(n=JSON.parse(d)),o=n.result,p=n.message,1!==o?[3,2]:(h=(f=JSON).stringify,v=[r({},a)],b={data:t,message:p,resData:n},[4,(0,c.readVal)({key:s.KWAI_CALLBACK_SOURCE})]);case 1:return g=h.apply(f,[r.apply(void 0,v.concat([(b.kwaiAdInfoSource=i.sent(),b.referrer=document.referrer,b)]))]),null===(w=this.context.plugins.logger)||void 0===w||w.logger({name:u.LOGGER_TYPES_NAME.successUp,extra_info:g}),null===(E=this.context.plugins.logger)||void 0===E||E.logPreviewReport(t,{name:u.LOGGER_TYPES_NAME.previewSuccessUp,extra_info:g}),[3,4];case 2:return m=(y=JSON).stringify,_=[r({},a)],S={data:t,message:p,resData:n},[4,(0,c.readVal)({key:s.KWAI_CALLBACK_SOURCE})];case 3:g=m.apply(y,[r.apply(void 0,_.concat([(S.kwaiAdInfoSource=i.sent(),S.referrer=document.referrer,S)]))]),null===(O=this.context.plugins.logger)||void 0===O||O.logger({name:u.LOGGER_TYPES_NAME.successUpForOther,extra_info:g}),i.label=4;case 4:(0,l.APILogger)({apiPath:e,actionStatus:1!==o?u.ActionStatus.NOT_VALID_API_RETURNS:u.ActionStatus.SUCCESS,error:1!==o?p||"result !== 1":void 0,response:d});try{null===(P=this.context.plugins.logger)||void 0===P||P.logI18nSuccessWithRetryAction(d.isRetry,{eventName:null==t?void 0:t.eventName,pixelId:null!==(I=null===(k=this.context.data.adInfo)||void 0===k?void 0:k.pixelId)&&void 0!==I?I:"",clickId:null!==(x=null===(A=this.context.data.adInfo)||void 0===A?void 0:A.callback)&&void 0!==x?x:"",costInfoType:u.CostInfoType.interfaceRetry,thirdParty:null!==(C=null===(T=null==t?void 0:t.params.kwaiInfo)||void 0===T?void 0:T.tirdParty)&&void 0!==C?C:"",pixel_extra_data:t})}catch(e){(0,l.JSLogger)({error:e})}return[2]}}))}))})).catch((function(e){var o,i=JSON.stringify(r(r({},a),{data:t,error:e}));null===(o=n.context.plugins.logger)||void 0===o||o.logger({name:u.LOGGER_TYPES_NAME.errUp,extra_info:i})}))},this.context=t};t.ReportService=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.httpService=t.HttpService=void 0;var r=n(1),o=function(){function e(){}return e.prototype.sendBeacon=function(e,t){return!!(null===r.windowSnapshot||void 0===r.windowSnapshot?void 0:r.windowSnapshot.navigator.sendBeacon)&&r.windowSnapshot.navigator.sendBeacon(e,new Blob([JSON.stringify(t)],{type:"application/json"}))},e}();t.HttpService=o,t.httpService=new o},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiPixel=void 0;var c=n(1),u=n(2),l=n(4),d=n(5),p=n(9),f=n(36),h=n(0),v=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.currentHref="",r.context=n,r}return o(t,e),t.prototype.getInstance=function(){var e=this;return this.instancePromise||(this.instancePromise=d.xhrService.get("".concat(u.API.GET_PIXEL,"?pixelId=").concat(this.pixelId),{retry:2,retryDelay:1e3}),this.instancePromise.then((function(t){var r,o,i;e.context.logFMP();try{null===(r=e.context.plugins.logger)||void 0===r||r.logWC()}catch(e){}var a=t.status,c=t.message,d=void 0===c?"":c,f=t.data;if(200!==a)e.instancePromise=null,(0,h.APILogger)({apiPath:u.API.GET_PIXEL,actionStatus:l.ActionStatus.NOT_VALID_API_RETURNS,error:d||"status !== 200",response:t});else if(200===a&&f){(0,h.APILogger)({apiPath:u.API.GET_PIXEL,actionStatus:l.ActionStatus.SUCCESS,response:t});var v=JSON.stringify({data:f,message:d});null===(o=e.context.plugins.logger)||void 0===o||o.logger({name:l.LOGGER_TYPES_NAME.successConfig,extra_info:v});var g=JSON.parse(f);if((0,p.getWorkspace)().instance(e.pixelId).setPixelInfo(g),null==g?void 0:g.pixelExtra)try{var y=JSON.parse(g.pixelExtra);(null==y?void 0:y.dataReturnStatus)&&Promise.resolve().then((function(){return s(n(38))})).then((function(t){new(0,t.EnhanceLogPlugin)(e.pixelId,e.context)}))}catch(e){(0,h.JSLogger)({error:e})}t.isRetry&&(null===(i=e.context.plugins.logger)||void 0===i||i.logRetryPixelIdInGetPixelConfig(e.pixelId))}})).catch((function(t){var n;(0,h.JSLogger)({error:t});var r=JSON.stringify({pixelId:e.pixelId,accessMode:e.accessMode,currentHref:e.currentHref,error:t});null===(n=e.context.plugins.logger)||void 0===n||n.logger({name:l.LOGGER_TYPES_NAME.errConfig,extra_info:r}),e.instancePromise=null}))),this.instancePromise},t.prototype.page=function(e){c.windowSnapshot&&c.windowSnapshot.location.href!==this.currentHref&&(this.track(u.PAGE_VIEW_EVENT_NAME,e),this.currentHref=c.windowSnapshot.location.href)},t}(f.Pixel);t.KwaiPixel=v},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pixel=t.DefaultAccessMode=void 0;var i=n(1),a=n(2),s=n(0),c=n(37),u=n(3),l={};t.DefaultAccessMode=c.AccessMode.Develop;var d=function(){function e(e,n){this.pixelId=e,this.context=n,this.loaded=!1,this.accessMode=t.DefaultAccessMode,this.instancePromise=this.getInstance()}return e.prototype.track=function(e,n,r,o){var i=this;void 0===o&&(o=t.DefaultAccessMode),this.getInstance().then((function(){var t=!(!r&&void 0!==r);i.context.track(i.pixelId,e,n,a.REPORT_TYPE.TRACK,t,o)})).catch((function(e){(0,s.JSLogger)({error:e}),i.context.sendPixelError(i.pixelId,"invalid_pixel_id")}))},e.prototype.setPixelInfo=function(e){var n;e&&(this.pixelInfo=e);var r=this.pixelInfo;if(r&&(this.accessMode=null!==(n=r.accessMode)&&void 0!==n?n:t.DefaultAccessMode,r.accessMode===c.AccessMode.Standard&&r.eventData&&Array.isArray(r.eventData)&&r.eventData.length>0))for(var o=0;o<r.eventData.length;o++){var i=r.eventData[o].traceContent;"string"==typeof i&&(r.eventData[o].traceContent=JSON.parse(i)),this.initPixel(r.eventData[o])}},e.prototype.initPixel=function(e){var t,n,r=e.eventType,o=e.traceMethod,s=e.traceContent;if(o===c.TraceMethod.Url)for(var u=0;u<s[0].destination.length;u++)i.windowSnapshot&&(null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href.indexOf(s[0].destination[u]))>-1&&this.track(a.EVENT_NAME_FORMAT[r],e,!0,c.AccessMode.Standard);else i.windowSnapshot&&this.bindEvents(e.traceContent[0].destination,null!==(n=null===(t=e.traceContent[0])||void 0===t?void 0:t.traceUrl)&&void 0!==n?n:"",r,e)},e.prototype.bindEvents=function(e,t,n,d){return r(this,void 0,void 0,(function(){var t,r,p=this;return o(this,(function(o){try{t=this.pixelId,i.windowSnapshot&&(r=(0,u.getWorkspace)(),e.forEach((function(e){var o,s,u=null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.document.querySelector(e),f="".concat(t,"-").concat(e,"-").concat(n),h=function(){p.track(a.EVENT_NAME_FORMAT[n],d,!0,c.AccessMode.Standard)};if(u)l[f]&&u.removeEventListener("click",l[f],!0),(null===(o=r.delegatesListenerCache)||void 0===o?void 0:o[f])&&delete r.delegatesListenerCache[f],u.addEventListener("click",h,!0),l[f]=h;else{var v=null!==(s=r.delegatesListenerCache)&&void 0!==s?s:{};r.delegatesListenerCache||(r.delegatesListenerCache=v,null===i.windowSnapshot||void 0===i.windowSnapshot||i.windowSnapshot.addEventListener("click",(function(e){Object.keys(v).forEach((function(t){var n=v[t],r=n.selector,o=n.listener;e.target&&e.target.closest(r)&&"function"==typeof o&&o()}))}))),v[f]={selector:e,listener:h}}})))}catch(e){(0,s.JSLogger)({error:e})}return[2]}))}))},e}();t.Pixel=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceMethod=t.AccessMode=t.InstallType=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.Manual=1]="Manual",e[e.Third=2]="Third"}(t.InstallType||(t.InstallType={})),function(e){e[e.EventApi=0]="EventApi",e[e.Develop=1]="Develop",e[e.Standard=2]="Standard"}(t.AccessMode||(t.AccessMode={})),function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Click=2]="Click"}(t.TraceMethod||(t.TraceMethod={}))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnhanceLogPlugin=t.generateUUID=void 0;var s=a(n(39)),c=n(1),u=n(2),l=n(3),d=n(48),p=n(50),f=n(0);function h(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t="",n=0;n<32;n++){t+=e[Math.floor(16*Math.random())]}return t}t.generateUUID=h;var v=function(){function e(e,t){var n,r;this.baseInfo={url:null!==(n=null===c.windowSnapshot||void 0===c.windowSnapshot?void 0:c.windowSnapshot.location.href)&&void 0!==n?n:"",pixel_id:e,click_id:"",uuid:"",userAgent:null!==(r=null===c.windowSnapshot||void 0===c.windowSnapshot?void 0:c.windowSnapshot.navigator.userAgent)&&void 0!==r?r:""},this.context=t,this.init()}return e.prototype.init=function(){return o(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this.baseInfo,[4,this.getOrGenerateUuid()];case 1:return e.uuid=n.sent(),this.bindClickEvent(),this.sendPageView(),[3,3];case 2:return t=n.sent(),(0,f.JSLogger)({error:t}),[3,3];case 3:return[2]}}))}))},e.prototype.getOrGenerateUuid=function(){return o(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,l.getValFromCookieByName)({name:"kwai_uuid"})];case 1:return(e=n.sent())||(e=h(),(0,l.setCookieByName)({name:"kwai_uuid",value:e,seconds:31536e3})),[2,e];case 2:return t=n.sent(),(0,f.JSLogger)({error:t}),[2,""];case 3:return[2]}}))}))},e.prototype.bindClickEvent=function(){var e=this;null===c.windowSnapshot||void 0===c.windowSnapshot||c.windowSnapshot.addEventListener("click",(function(t){e.sendClick(t.target)}))},e.prototype.sendPageView=function(){var e,t,n,o={type:"pageView",pixelSdkVersion:u.SDK_VERSION,baseInfo:r(r({},this.baseInfo),{click_id:null!==(n=null===(t=null===(e=this.context)||void 0===e?void 0:e.data.adInfo)||void 0===t?void 0:t.callback)&&void 0!==n?n:""})};(0,p.sendEnhanceLogEvent)(o)},e.prototype.sendClick=function(e){var t,n,o,i,a;if(e instanceof HTMLElement&&"body"!==e.tagName.toLocaleLowerCase()&&"html"!==e.tagName.toLocaleLowerCase())try{var l=(0,s.default)(e),h={type:"click",pixelSdkVersion:u.SDK_VERSION,baseInfo:r(r({},this.baseInfo),{url:null!==(t=null===c.windowSnapshot||void 0===c.windowSnapshot?void 0:c.windowSnapshot.location.href)&&void 0!==t?t:"",click_id:null!==(i=null===(o=null===(n=this.context)||void 0===n?void 0:n.data.adInfo)||void 0===o?void 0:o.callback)&&void 0!==i?i:""}),clickElementInfo:{selector:l,text:null!==(a=null==e?void 0:e.innerText)&&void 0!==a?a:"",imageUrl:(0,d.getImageUrlFromBackgroundOrImageUrl)(e,this.baseInfo.url),link:this.getHrefOfLinkTag(e)}};(0,p.sendEnhanceLogEvent)(h)}catch(e){(0,f.JSLogger)({error:e})}},e.prototype.getHrefOfLinkTag=function(e){var t;return"a"===e.tagName.toLocaleLowerCase()&&null!==(t=e.href)&&void 0!==t?t:""},e}();t.EnhanceLogPlugin=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.selectorTypes,r=void 0===n?["ID","Class","Tag","NthChild"]:n,o=t.attributesToIgnore,i=void 0===o?["id","class","length"]:o,a=t.excludeRegex,s=void 0===a?null:a,c=[],d=(0,l.getParents)(e),p=!0,f=!1,v=void 0;try{for(var g,y=d[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var m=g.value,_=h(m,r,i,s);Boolean(_)&&c.push(_)}}catch(e){f=!0,v=e}finally{try{!p&&y.return&&y.return()}finally{if(f)throw v}}var b=[],S=!0,w=!1,E=void 0;try{for(var O,P=c[Symbol.iterator]();!(S=(O=P.next()).done);S=!0){var k=O.value;b.unshift(k);var I=b.join(" > ");if((0,u.isUnique)(e,I))return I}}catch(e){w=!0,E=e}finally{try{!S&&P.return&&P.return()}finally{if(w)throw E}}return null};var r=n(40),o=n(41),i=n(42),a=n(43),s=n(44),c=n(45),u=n(46),l=n(47);function d(e,t){var n=e.parentNode.querySelectorAll(t);return 1===n.length&&n[0]===e}function p(e,t){return t.find(d.bind(null,e))}function f(e,t,n){var r=(0,i.getCombinations)(t,3),o=p(e,r);return Boolean(o)||Boolean(n)&&(o=p(e,r=r.map((function(e){return n+e}))),Boolean(o))?o:null}function h(e,t,n,i){var u=void 0,l=function(e,t,n){var i={Tag:c.getTag,NthChild:s.getNthChild,Attributes:function(e){return(0,a.getAttributes)(e,n)},Class:o.getClassSelectors,ID:r.getID};return t.reduce((function(t,n){return t[n]=i[n](e),t}),{})}(e,t,n);i&&i instanceof RegExp&&(l.ID=i.test(l.ID)?null:l.ID,l.Class=l.Class.filter((function(e){return!i.test(e)})));var p=!0,h=!1,v=void 0;try{for(var g,y=t[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var m=g.value,_=l.ID,b=l.Tag,S=l.Class,w=l.Attributes,E=l.NthChild;switch(m){case"ID":if(Boolean(_)&&d(e,_))return _;break;case"Tag":if(Boolean(b)&&d(e,b))return b;break;case"Class":if(Boolean(S)&&S.length&&(u=f(e,S,b)))return u;break;case"Attributes":if(Boolean(w)&&w.length&&(u=f(e,w,b)))return u;break;case"NthChild":if(Boolean(E))return E}}}catch(e){h=!0,v=e}finally{try{!p&&y.return&&y.return()}finally{if(h)throw v}}return"*"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getID=function(e){var t=e.getAttribute("id");if(null!==t&&""!==t)return t.match(/(?:^\d|:)/)?'[id="'+t+'"]':"#"+t;return null}},function(e,t,n){"use strict";function r(e){if(!e.hasAttribute("class"))return[];try{return Array.prototype.slice.call(e.classList).filter((function(e){return/^[a-z_-][a-z\d_-]*$/i.test(e)?e:null}))}catch(n){var t=e.getAttribute("class");return(t=t.trim().replace(/\s+/g," ")).split(" ")}}Object.defineProperty(t,"__esModule",{value:!0}),t.getClasses=r,t.getClassSelectors=function(e){return r(e).filter(Boolean).map((function(e){return"."+e}))}},function(e,t,n){"use strict";function r(e,t,n,o,i,a,s){if(a!==s)for(var c=o;c<=i&&i-c+1>=s-a;++c)n[a]=t[c],r(e,t,n,c+1,i,a+1,s);else e.push(n.slice(0,a).join(""))}Object.defineProperty(t,"__esModule",{value:!0}),t.getCombinations=function(e,t){for(var n=[],o=e.length,i=[],a=1;a<=t;++a)r(n,e,i,0,o-1,0,a);return n}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","class","length"],n=e.attributes,o=[].concat(r(n));return o.reduce((function(e,n){return t.indexOf(n.nodeName)>-1||e.push("["+n.nodeName+'="'+n.value+'"]'),e}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNthChild=function(e){var t=0,n=void 0,o=void 0,i=e.parentNode;if(Boolean(i)){var a=i.childNodes,s=a.length;for(n=0;n<s;n++)if(o=a[n],(0,r.isElement)(o)&&(t++,o===e))return":nth-child("+t+")"}return null};var r=n(19)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTag=function(e){return e.tagName.toLowerCase().replace(/:/g,"\\:")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=function(e,t){if(!Boolean(t))return!1;var n=e.ownerDocument.querySelectorAll(t);return 1===n.length&&n[0]===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getParents=function(e){var t=[],n=e;for(;(0,r.isElement)(n);)t.push(n),n=n.parentNode;return t};var r=n(19)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(49),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getImageUrlFromBackgroundOrImageUrl=void 0;t.getImageUrlFromBackgroundOrImageUrl=function(e,t){var n="";if("img"===e.tagName.toLocaleLowerCase()?n=e.src:e.style.backgroundImage&&(n=e.style.backgroundImage.slice(4,-1).replace(/["']/g,"")),n&&!n.startsWith("http"))try{n=new URL(n,t).toString()}catch(e){}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendEnhanceLogEvent=void 0;var r=n(2),o=n(5),i=n(0),a=n(6),s="".concat(r.Callback_Api_Domain,"/log/common/data");t.sendEnhanceLogEvent=function(e){o.xhrService.post(s,e,{async:!0}).then((function(e){var t=e.result,n=e.err_msg;(0,i.APILogger)({apiPath:s,actionStatus:1!==t?a.ActionStatus.NOT_VALID_API_RETURNS:a.ActionStatus.SUCCESS,error:1!==t?n||"result !== 1":void 0,response:e})})).catch((function(e){}))}},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;var o=n(1),i=n(52),a=n(11),s=n(0),c=function(e){var t=this;this.loadPixel=function(e){if(!t.context.getPixel(e)){var n=t.createPixel(e);t.context.addPixel(n)}},this.setPageInfo=function(e,n){t.context.setPageInfo(e,n)},this.useDynamicPlugin=function(e){try{if(e.name===a.PluginName.CACHE_PLUGIN){var n=e.handler(t.context);t.context.usePlugin({name:e.name,plugin:n})}else e.name,a.PluginName.LOGGER_PLUGIN,n=e.handler(t.context),t.context.usePlugin({name:e.name,plugin:n})}catch(e){(0,s.JSLogger)({error:e})}},this.instance=function(e){var n=t.context.getPixel(e);return n||new i.EmptyPixel(e,t.context)},this.instances=function(){return t.context.getAllPixels()},this.isEmptyInstance=function(e){return!e||e instanceof i.EmptyPixel},this.page=function(e){var n=null!=e?e:{},o=n._window,i=r(n,["_window"]);t.updateWindowSnapshot(o),t.instances().forEach((function(e){return e.page(i)}))},this.track=function(e,n){var o=null!=n?n:{},i=o._window,a=r(o,["_window"]);t.updateWindowSnapshot(i),t.instances().forEach((function(t){return t.track(e,a,!1)}))},this.updateWindowSnapshot=function(e){(0,o.updateWindowSnapshotWhenInWorker)(e)&&t.context.updateOnWindowSnapshotChanged()},this.initialize=!0,this.context=e};t.Manager=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyPixel=void 0;var i=n(0),a=n(3),s=function(e,t){var n=this;this.track=function(e,t){return r(n,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,a.getTrackFlag)()];case 1:return r.sent()&&this.context.validInPreview(this.pixelId,e),(0,a.setPixelCacheIfNotInit)(this.pixelId,e,t),[3,3];case 2:return n=r.sent(),(0,i.JSLogger)({error:n}),[3,3];case 3:return[2]}}))}))},this.pixelId=e,this.context=t};t.EmptyPixel=s},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(54),t),o(n(62),t)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CachePlugin=void 0;var s=n(1),c=n(12),u=n(3),l=n(55),d=n(2),p=n(20),f=n(4),h=n(56),v=n(0),g=function(e){function t(t){var n=t.context,r=t.url,o=void 0===r?s.windowSnapshot?new URL(s.windowSnapshot.location.href):void 0:r,c=t.needBridge,g=void 0===c||c,y=e.call(this,n)||this;return y.getAdInfo=function(){return i(y,void 0,void 0,(function(){var e,t,n,r,o,i,c,p,h,g,y,m,_,b;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),(0,u.getIsPreload)(null===(g=this.url)||void 0===g?void 0:g.href)?[2,void 0]:(null===(y=this.context.plugins.logger)||void 0===y||y.logAdInfoAction({name:f.LOGGER_TYPES_NAME.GET_AD_INFO_COUNT}),e=void 0,t=l.KWAI_CALLBACK_SOURCE_ENUM.UNKNOWN,[4,this.getAdInfoFromSource()]);case 1:return n=a.sent(),r=n.adInfoFromSource,o=n.isReadSourceSuccess,i=n.callbackSource,o?(e=r,t=i,this.updateCache(r),[3,4]):[3,2];case 2:return[4,this.getAdInfoFromCache()];case 3:c=a.sent(),p=c.adInfoFromCache,c.isReadCacheSuccess&&(e=p,t=l.KWAI_CALLBACK_SOURCE_ENUM.CONTEXT),a.label=4;case 4:return e&&t!==l.KWAI_CALLBACK_SOURCE_ENUM.UNKNOWN&&((0,u.writeVal)({key:d.KWAI_CALLBACK_SOURCE,val:t}),(null!==(b=null===(_=null===(m=null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location)||void 0===m?void 0:m.href)||void 0===_?void 0:_.indexOf("ks_px_test=1"))&&void 0!==b?b:-1)>-1&&this.setAdInfo(e,t)),[2,e];case 5:return h=a.sent(),(0,v.JSLogger)({error:h}),[3,6];case 6:return[2]}}))}))},y.getAdInfoFromSource=function(){return i(y,void 0,void 0,(function(){var e,t,n,r,o,i,s,c,u,p,g,y,m,_,b,S,w,E;return a(this,(function(a){switch(a.label){case 0:e=[],t=!1,n=l.KWAI_CALLBACK_SOURCE_ENUM.UNKNOWN,r=[d.KWAI_CALLBACK,d.KWAI_PIXEL_ID],a.label=1;case 1:return a.trys.push([1,6,,7]),this.getUrl(),o=(0,h.getParamsFromUrl)(r,null===(b=this.url)||void 0===b?void 0:b.href),i=o.urlVals,o.isFindAllInUrl?(e=i,t=!0,n=l.KWAI_CALLBACK_SOURCE_ENUM.URL,this.logAdInfoAction(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_URL,f.ActionStatus.SUCCESS),[3,5]):[3,2];case 2:return this.logAdInfoAction(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_URL,f.ActionStatus.ERROR),this.needBridge?[4,(0,h.getParamsFromBridge)(r,null===(S=this.context.plugins.logger)||void 0===S?void 0:S.logger)]:[3,5];case 3:return s=a.sent(),c=s.adInfoFromBridge,u=s.isReadBridgeSuccess,[4,this.getAdInfoFromCache({enabledLog:!1})];case 4:p=a.sent(),g=p.adInfoFromCache,y=p.isReadCacheSuccess,m=(null==c?void 0:c[0])&&(null==c?void 0:c[0])===(null==g?void 0:g.callback)&&(null==c?void 0:c[1])&&(null==c?void 0:c[1])===(null==g?void 0:g.pixelId),(!y||!m)&&(u?(e=c,t=!0,n=l.KWAI_CALLBACK_SOURCE_ENUM.BRIDGE,this.logAdInfoAction(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_BRIDGE,f.ActionStatus.SUCCESS)):this.logAdInfoAction(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_BRIDGE,{actionStatus:f.ActionStatus.ERROR,bridgeValue:{valArray:c,keyArray:r}})),a.label=5;case 5:return[3,7];case 6:return _=a.sent(),(0,v.JSLogger)({error:_}),[3,7];case 7:return[2,{adInfoFromSource:{callback:null!==(w=e[0])&&void 0!==w?w:"",pixelId:null!==(E=e[1])&&void 0!==E?E:""},isReadSourceSuccess:t,callbackSource:n}]}}))}))},y.getAdInfoFromCache=function(e){return i(y,void 0,void 0,(function(){var t,n,r,o,i,s,c,u,l;return a(this,(function(a){switch(a.label){case 0:t=(null!=e?e:{}).enabledLog,r=!1,o=void 0===t||t?this.logAdInfoAction:void 0,a.label=1;case 1:return a.trys.push([1,6,,7]),[4,(0,h.getParamsFromCookie)()];case 2:return i=a.sent(),s=i.adInfoFromCookie,i.isReadCookieSuccess?(n=s,r=!0,null==o||o(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_COOKIE,f.ActionStatus.SUCCESS),[3,5]):[3,3];case 3:return null==o||o(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_COOKIE,f.ActionStatus.ERROR),[4,(0,h.getParamsFromSession)()];case 4:c=a.sent(),u=c.adInfoFromSession,c.isReadSessionSuccess?(n=u,r=!0,null==o||o(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_SESSION,f.ActionStatus.SUCCESS)):null==o||o(f.LOGGER_TYPES_NAME.GET_AD_INFO_FROM_SESSION,f.ActionStatus.ERROR),a.label=5;case 5:return[3,7];case 6:return l=a.sent(),(0,v.JSLogger)({error:l}),[3,7];case 7:return[2,{adInfoFromCache:n,isReadCacheSuccess:r}]}}))}))},y.setAdInfo=function(e,t){return i(y,void 0,void 0,(function(){var n,r,o,i,c,l,d,p;return a(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,7,,8]),n=JSON.stringify({bridgeData:e,currentHref:null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location.href,kwaiAdInfoSource:t}),!(e&&e.callback&&e.pixelId&&18==e.pixelId.length&&0!=e.callback.length))return[3,5];if((null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location.href)&&!(0,u.getIsPreload)(null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.location.href))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.setAdInfoA({pixelId:e.pixelId,clickId:e.callback})];case 2:return r=a.sent(),null===(c=this.context.plugins.logger)||void 0===c||c.logger({name:f.LOGGER_TYPES_NAME.successSetBridge,return:r,extra_info:n}),[3,4];case 3:return o=a.sent(),(0,v.JSLogger)({error:o}),null===(l=this.context.plugins.logger)||void 0===l||l.logger({name:f.LOGGER_TYPES_NAME.errSetBridge,return:null!==(d=null==o?void 0:o.message)&&void 0!==d?d:o,extra_info:n}),[3,4];case 4:return[3,6];case 5:null===(p=this.context.plugins.logger)||void 0===p||p.logger({name:f.LOGGER_TYPES_NAME.errBefroeSetBridge,extra_info:n}),a.label=6;case 6:return[3,8];case 7:return i=a.sent(),(0,v.JSLogger)({error:i}),[3,8];case 8:return[2]}}))}))},y.setAdInfoA=function(e){return i(y,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,p.ks_pixel_setPixelBaseInfo)(e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),(0,v.JSLogger)({error:t}),[3,3];case 3:return[2]}}))}))},y.logAdInfoAction=function(e,t){var n,r="object"==typeof t?t:{actionStatus:t};null===(n=y.context.plugins.logger)||void 0===n||n.logAdInfoAction({name:e,extra_info_obj:r})},y.updateCache=function(e){return i(y,void 0,void 0,(function(){return a(this,(function(t){try{(0,u.writeVal)({key:d.KWAI_CALLBACK_SESSION_KEY,val:e})}catch(e){(0,v.JSLogger)({error:e})}return[2]}))}))},y.url=o,y.needBridge=g,y}return o(t,e),t.prototype.getUrl=function(){var e=s.windowSnapshot?new URL(s.windowSnapshot.location.href):void 0;this.url=e},t}(c.Plugin);t.CachePlugin=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KWAI_CALLBACK_SOURCE_ENUM=void 0,function(e){e.CONTEXT="context",e.BRIDGE="bridge",e.URL="url",e.UNKNOWN="unknown"}(t.KWAI_CALLBACK_SOURCE_ENUM||(t.KWAI_CALLBACK_SOURCE_ENUM={}))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(57),t),o(n(58),t),o(n(59),t),o(n(60),t)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getParamsFromBridge=t.getBridgeData=void 0;var i=n(1),a=n(3),s=n(20),c=n(4),u=n(0);t.getBridgeData=function(e,t){return r(void 0,void 0,void 0,(function(){var n,r,l,d;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,s.ks_pixel_getPixelBaseInfo)()];case 1:return n=o.sent(),r=JSON.stringify({bridgeRes:n,currentHref:null!==(d=null===i.windowSnapshot||void 0===i.windowSnapshot?void 0:i.windowSnapshot.location.href)&&void 0!==d?d:""}),(null==n?void 0:n.pixelId)&&(null==n?void 0:n.clickId)?null==t||t({name:c.LOGGER_TYPES_NAME.successBridge,extra_info:r}):null==t||t({name:c.LOGGER_TYPES_NAME.errBridgeForUnPixel,extra_info:r}),[2,e.map((function(e){return(null==n?void 0:n[(0,a.toHump)(e)])||(null==n?void 0:n[e])||""}))];case 2:return l=o.sent(),(0,u.JSLogger)({error:l}),[3,3];case 3:return[2,[]]}}))}))};t.getParamsFromBridge=function(e,n){return r(void 0,void 0,void 0,(function(){var r,i,a,s;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,t.getBridgeData)(e).catch((function(e){var t;null==n||n({name:c.LOGGER_TYPES_NAME.errBridge,extra_info_obj:{ext:"调用Bridge失败: ".concat(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)}})}))];case 1:return r=null!==(s=o.sent())&&void 0!==s?s:[],i=(null==r?void 0:r.filter((function(e){return!!e})).length)===e.length,[2,{adInfoFromBridge:r,isReadBridgeSuccess:i}];case 2:return a=o.sent(),(0,u.JSLogger)({error:a}),[3,3];case 3:return[2,{adInfoFromBridge:[],isReadBridgeSuccess:!1}]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getParamsFromCookie=void 0;var i=n(7),a=n(2),s=n(0);t.getParamsFromCookie=function(){return r(void 0,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=void 0,t=!1,[4,(0,i.getCookieByKey)({key:a.KWAI_CALLBACK_SESSION_KEY})];case 1:if(n=o.sent())try{e=JSON.parse(n),t=!!(null==e?void 0:e.callback)&&!!(null==e?void 0:e.pixelId)}catch(e){(0,s.JSLogger)({error:e})}return[2,{adInfoFromCookie:e,isReadCookieSuccess:t}];case 2:return r=o.sent(),(0,s.JSLogger)({error:r}),[2,{isReadCookieSuccess:!1}];case 3:return[2]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getParamsFromSession=void 0;var i=n(7),a=n(2),s=n(0);t.getParamsFromSession=function(){return r(void 0,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=void 0,t=!1,[4,(0,i.readValFromStorage)({key:a.KWAI_CALLBACK_SESSION_KEY})];case 1:if(n=o.sent())try{e=JSON.parse(n),t=!!(null==e?void 0:e.callback)&&!!(null==e?void 0:e.pixelId)}catch(e){(0,s.JSLogger)({error:e})}return[2,{adInfoFromSession:e,isReadSessionSuccess:t}];case 2:return r=o.sent(),(0,s.JSLogger)({error:r}),[2,{isReadSessionSuccess:!1}];case 3:return[2]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getParamsFromUrl=void 0;var r=n(3),o=n(61),i=n(0);t.getParamsFromUrl=function(e,t){try{var n=!0;return{urlVals:e.map((function(e){var i,a="",s=o.specialKeyConfig[e]||{},c=s.searchKeys,u=void 0===c?[]:c,l=s.urlHandler;u.includes(e)||u.push(e);for(var d=0;d<u.length&&!(a=(0,r.getQueryStringWithIframeCheck)(u[d],t));d++);return(a=null!==(i=null==l?void 0:l(a))&&void 0!==i?i:a)||(n=!1),a})),isFindAllInUrl:n}}catch(e){return(0,i.JSLogger)({error:e}),{urlVals:[],isFindAllInUrl:!1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.specialKeyConfig=void 0,t.specialKeyConfig={click_id:{searchKeys:["kwai_click_id","click_id"],urlHandler:function(e){return decodeURIComponent(e).replace(/\s/g,"+")}},pixel_id:{searchKeys:["kwai_f_pixel_id","pixel_id"]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),l=n(2),d=n(22),p=n(9),f=c(n(64)),h=n(53),v=n(4),g=n(65),y=n(11),m=n(0);(function(){return a(this,void 0,void 0,(function(){var e,t,r,o,a,c,m,_;return s(this,(function(s){switch(s.label){case 0:return e=(0,p.getWorkspace)(),t=e.initialize,void 0!==t&&t?(e.handleCache(),[2]):(e.initialize=!0,[4,Promise.resolve().then((function(){return i(n(66))}))]);case 1:return r=s.sent(),o=new r.Weblog({env:"oversea",plugins:[]},{product_name:"ksib.fe.pixel",user_id:"-1"}),a=new f.default({weblog:o,projectId:"5b88a5135h",sampling:1,unuseAPIPlugin:!0,unuseResourcePlugin:!0,unuseErrorPlugin:!0,ignoreFetch:!0,ignoreXHR:!0,lcp:!0}),e.dynamicPlugins=[{name:y.PluginName.LOGGER_PLUGIN,handler:function(e){return new v.LoggerPlugin({context:e,radar:a})}},{name:y.PluginName.CACHE_PLUGIN,handler:function(e){return new h.CachePlugin({context:e})}},{name:y.PluginName.PerformanceObserverPlugin,handler:function(e){return new g.PerformanceObserverPlugin({context:e})}}],c=new d.KwaiManager(l.SDK_VERSION),m=(0,p.getWorkspaceName)(),["instance","instances","usePlugin","loadPixel","enableCookie","disableCookie"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return function(){try{return c[t].apply(c,Array.prototype.slice.call(arguments))}catch(e){return{}}}},set:function(){}})})),["page","track"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return function(){try{var e=Array.prototype.slice.call(arguments);return(0,p.setWorkSpaceCacheIfNotInit)(t,e),c[t].apply(c,e)}catch(e){return{}}}},set:function(){}})})),_=Object.getPrototypeOf(c),u.GlobalThis[m]=Object.assign(e,c,_),c.init(),[2]}}))}))})().catch((function(e){(0,m.JSLogger)({error:e})}))},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return nt}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t,n,r){return new(n=n||Promise)((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function i(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){var c=[a,s];if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,(c=o?[2&c[0],o.value]:c)[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(s){c=[6,s],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function s(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var c,u,l="ksurl.cn/csHfgepO",d=console,p=d.log.bind(d,l+", radar:"),f=d.warn.bind(d,l+", radar:"),h=d.error.bind(d,l+", radar:"),v=function(){function e(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.middlewares=[],(e=this.middlewares).push.apply(e,s([],a(t),!1))}return e.prototype.use=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.middlewares.pop();(e=this.middlewares).push.apply(e,s([],a(t),!1)),this.middlewares.push(r)},e.prototype.invoke=function(e){return r=this.middlewares,t=e,n=-1,function e(o){if(o<=n)return new Error("`next` 被重复调用");var i=r[n=o];if(i=o===r.length?undefined:i)try{return i(t,e.bind(null,o+1))}catch(o){return o}}(0);var t,n,r},e}(),g=((u=c=c||{}).LOAD="load",u.RES="resource",u.API="api",u.ERROR="error",u.SDK_ERROR="sdk_error",u.CUSTOM="custom",u.BATCH="batch",u.EVENT="event",u.BLOOD="blood",function(){function e(e){void 0===e&&(e={});var t=this;this.broadcastSampleFb=function(){var e=t.getSample(t.baseOptions.sampling);e!==t.sampling&&(t.sampling=e,t.sampling&&(t.isHit=t.samplingControl(t.sampling)))},void 0===e&&X("100"),e.key||X("101"),!e.core||"object"==typeof e.core.sampleData&&"function"==typeof e.core.collect||X("121"),this.baseOptions=e,this.key=e.key,this.version=e.version,this.name=e.name,this.isHit=!1,e.core&&this.updateCore(e.core)}return e.prototype.updateCore=function(e){var t;"object"==typeof e.sampleData&&"function"==typeof e.collect||X("121"),null!=(t=this.core)&&t.broadcastSample.off(this.broadcastSampleFb),this.core=e,this.sampling=this.getSample(this.baseOptions.sampling),this.sampling&&(this.isHit=this.samplingControl(this.sampling)),null!=(e=null==(t=this.core)?void 0:t.broadcastSample)&&e.on(this.broadcastSampleFb)},e.prototype.getSample=function(e){var t=null!=(t=null==(t=this.core)?void 0:t.sampleData.core)?t:1;if(this.key===c.LOAD)return t;if("number"!=typeof(e=void 0===e?1:e)||e<0||1<e)return f("102","".concat(this.key,"，采用Core的采样率").concat(null==(n=this.core)?void 0:n.sampleData.core)),t;var n=null!=(n=this.core)&&n.isInYoda?void 0===(null==(n=this.core)?void 0:n.sampleData[this.key])?1:this.core.sampleData[this.key]:e;return t&&t<n?(f("115","".concat(this.key)),t):n},e.prototype.samplingControl=function(e){var t;return!(null==(t=this.core)||!t.sampleData.isHit)&&(null==(t=this.core)?void 0:t.samplingControl(e/this.core.sampleData.core))},e.prototype.baseCollect=function(e){if(this.core){if(this.isHit){var t=e.value||{};t=Object.keys(t).filter((function(e){return null!==t[e]&&void 0!==t[e]})).reduce((function(e,n){return r(r({},e),((e={})[n]=t[n],e))}),{});try{this.core.collect(e.key||this.key,r(r({collect_version:this.version,collect_name:this.name},e.dimension),{sample_rate:this.sampling}),t)}catch(e){f("126")}}}else f("110","".concat(this.key))},e}());var y=["//wlog.kuaishou.com/rest/n/log/web/collect","/rest/wd/common/log/collect/misc2","/rest/wd/common/log/collect/radar","/rest/kd/log/collect"],m=window,_="__radarSeedStore__",b="Queue",S="error"+b,w="resource"+b,E="event"+b,O={start_time:{custom:function(e,t){return Math.round(t.startTime)}},fetch_start:{custom:function(e,t){return Math.round(t.fetchStart)}},dns:{end:"domainLookupEnd",start:"domainLookupStart",cachedSkip:!0,crossOriginSkip:!0},tcp:{end:"connectEnd",start:"connectStart",cachedSkip:!0,crossOriginSkip:!0},ssl:{custom:function(e,t){return t.connectEnd&&t.secureConnectionStart?t.connectEnd-t.secureConnectionStart:null}},ttfb:{end:"responseStart",start:"requestStart",cachedSkip:!0,crossOriginSkip:!0},trans:{end:"responseEnd",start:"responseStart",cachedSkip:!0,crossOriginSkip:!0},fb:{end:"responseStart",start:"fetchStart",cachedSkip:!0,crossOriginSkip:!0},total:{end:"responseEnd",start:"fetchStart"},size:{custom:function(e,t){return t.encodedBodySize},cachedSkip:!0,crossOriginSkip:!0},protocol:{custom:function(e,t){return t.nextHopProtocol}},file:{custom:function(e,t){return t.name}},res_type:{custom:function(e,t){return t.initiatorType}},cached:{custom:function(e,t){return 0===t.transferSize||0===t.duration||null==t.transferSize&&(0===t.domainLookupStart||t.responseStart===t.fetchStart)},crossOriginSkip:!0},has_timing_allow:{custom:function(e,t){return T(t)}}},P=/^(https?:)?\/\//;function k(e,t){if(!e)return!1;var n=e.replace(P,"");return t.some((function(e){return 0<=n.indexOf(e.replace(P,""))}))}function I(e){if("string"!=typeof e)return"";try{var t=e.lastIndexOf(".");return e.substr(t+1)}catch(e){return""}}function A(e){return"object"==typeof e&&Object.keys(e).every((function(t){return"number"==typeof e[t]}))}function x(e){return"function"==typeof e}function T(e){return void 0===e.nextHopProtocol?null:""!==e.nextHopProtocol}function C(e){return"resource"===e.entryType?"fetch"!==(null==e?void 0:e.initiatorType)&&"xmlhttprequest"!==(null==e?void 0:e.initiatorType)||"js"===I(e.name)||"css"===I(e.name)?"resource":"api":"other"}function L(e,t){var n={};return Object.keys(e).forEach((function(r){var o=N(r,e,t);null!=o&&(n[r]=o)})),n}function N(e,t,n){var r=t[e];if(r||X("129，".concat(e)),(!r.crossOriginSkip||T(n))&&(!r.cachedSkip||!N("cached",t,n)))return"function"==typeof r.custom?r.custom(e,n):(t=r.end,e=r.start,!r.notCatchIfUndefined||void 0!==n[t]&&void 0!==n[e]?(+n[t]||0)-(+n[e]||0):void 0)}function R(e,t,n,r){return e.addEventListener(t,n,r)}function D(e,t,n,r){return e.removeEventListener(t,n,r)}var U=["ktrace-str"];function j(e){return"__radar_".concat(e=void 0===e?"":e).concat(Math.random().toString(36).substring(2,8))}function M(e,t){var n=window.XMLHttpRequest;return n?(window.XMLHttpRequest=function(){var o,i,a,s=new n,c=(s._radarRequest={},s._radarResponse={},j()),u=(s._radarRequest.id=c,{});return s.addEventListener("readystatechange",(function(){if(4===s.readyState&&"function"==typeof t){s._radarResponse.status=s.status,s._radarResponse.statusText=s.statusText;var e,n,r,o,i,a=function(e,t){switch(null==t&&(t={}),typeof e){case"object":var n,r=[];for(n in e){var o=e[n],i=n.toLowerCase();r.push("".concat(i,":\t").concat(o))}return r.join("\n")+"\n";case"string":for(var a=0,s=(r=e.split("\n")).length;a<s;a++){var c=r[a];/([^:]+):\s*(.+)/.test(c)&&(c=null!=(c=RegExp.$1)?c.toLowerCase():void 0,o=RegExp.$2,c&&null==t[c]&&(t[c]=o))}return t}}(s.getAllResponseHeaders());for(e in a)r=a[e],s._radarResponse&&s._radarResponse.headers&&!s._radarResponse.headers[e]&&(n=e.toLowerCase(),s._radarResponse.headers[n]=r);if(s.responseType&&"text"!==s.responseType)"document"===s.responseType?(s._radarResponse.xml=s.responseXML,s._radarResponse.data=s.responseXML):s._radarResponse.data=s.response;else{s._radarResponse.text=s.responseText,s._radarResponse.data=s.responseText;try{s._radarResponse.xml=s.responseXML}catch(e){}}"responseURL"in s&&(s._radarResponse.finalUrl=s.responseURL);try{var c=null!=(o=u["ktrace-str"])?o:"";c&&window.parseWedTraceId&&(s._radarRequest.trace_id=window.parseWedTraceId(null!=(i=c.split("|")[1])?i:""))}catch(e){f("traceId 解析异常")}t(s._radarRequest,s._radarResponse)}})),"function"==typeof s.setRequestHeader&&(o=s.setRequestHeader,s.setRequestHeader=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return U.includes(e[0])&&(u[e[0]]=e[1]),o.apply(this,e)}),"function"==typeof s.open&&(i=s.open,s.open=function(e,t,n,o,a){var s=[].slice.call(arguments);return this._radarRequest=r({method:e,url:t,async:n,user:o,pass:a},this._radarRequest),this._radarResponse.headers={},i.apply(this,s)}),"function"==typeof s.send&&(a=s.send,s.send=function(){var t=[].slice.call(arguments);return"function"==typeof e&&(this._radarRequest._config=t[0],e(this._radarRequest)),a.apply(this,t)}),s},["DONE","HEADERS_RECEIVED","LOADING","OPENED","UNSENT"].forEach((function(e){window.XMLHttpRequest[e]=n[e]})),window.XMLHttpRequest.prototype=n.prototype,function(){n&&(window.XMLHttpRequest=n)}):(h("118"),!1)}var G=[],B=["application/json","text/html","text/plain"];function V(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var c=G.reduce((function(e,t){return[t].concat(e)}),[]),u="string"==typeof n[0]?new Request(n[0],n[1]):n[0],l=(u.id=j(),c.forEach((function(e){e=e.request,u=e(u)||u})),u.clone()),d=e.apply(void 0,s([],a(n),!1)),p=null,f=null,h=!1;return d.then((function(e){var t,n=null==(t=e.headers)?void 0:t.get("content-type");return n&&B.some((function(e){return-1<n.indexOf(e)}))?(h=!0,t=e.clone(),p=t.clone(),t.clone().text()):(p=e,"[object Object]")})).then((function(e){return o(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:f=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,l.text()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,"Radar: Request.text()失败"];case 4:return[2]}}))}))})).then((function(e){u._config=e;var t=null;return h?(t=p.clone()).data=f:t=p,c.forEach((function(e){(e=e.response)&&(t=e(t,u)||t)})),p}),(function(e){throw c.forEach((function(t){(t=t.responseError)&&(e=t(e,u)||e)})),e}))}function W(){var e=[];function t(t){-1!==(t=e.indexOf(t))&&e.splice(t,1)}function n(n){return e.push(n),t.bind(void 0,n)}return{on:n,off:t,once:function(e){var t=n((function(n){e(n),t()}));return t},emit:function(t){e.forEach((function(e){return e(t)}))}}}function K(e){return(e=new RegExp("(?:^|; ?)".concat(e,"=(1|0)(;|$)")).exec(document.cookie))&&e[1]}var H=["radar_init","h5_load","fmp","main_api","h5_custom_metric"];var F={load:function(e){var t=e.dimension,n=e.value;if(e=t.event_name,H.indexOf(e)<0)return!1;if(!A(n))return!1;switch(e){case"fmp":var r=n.fmp_time;return!(!n.fmp||!r);case"h5_load":return r=n.total,!(!n.load_event_time||!r);case"h5_custom_metric":return r=n.custom_metric_timestamp,!(!t.custom_metric_name||!r)}return!0},api:function(e){var t=e.dimension,n=(e=e.value,t.custom_failed),r=t.api,o=t.status,i=t.res_type,a=t.protocol,s=(t=t.cached,e.duration),c=e.size;return"boolean"==typeof(void 0!==n&&n)&&"string"==typeof(void 0===r?"":r)&&"number"==typeof(void 0===o?0:o)&&"string"==typeof(void 0===i?"":i)&&"string"==typeof(void 0===a?"":a)&&"boolean"==typeof(void 0!==t&&t)&&"number"==typeof(void 0===s?0:s)&&"number"==typeof(void 0===c?0:c)&&A(e)},resource:function(e){var t=e.dimension,n=(e=e.value,t.failed);if("boolean"!=typeof n)return!1;if(n){var r=t.res_path;if("string"!=typeof t.file||"string"!=typeof r)return!1}return!!n||"string"==typeof t.file&&A(e)},error:function(e){var t=(e=e.dimension).error_type;if([e.error_cons_type,t,e.msg].some((function(e){return null==e})))return!1;t=e.col;var n,r=e.line;return e.sample_rate,e.event_client_timestamp,e=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(e,["col","line","sample_rate","event_client_timestamp"]),!(t&&"number"!=typeof t||r&&"number"!=typeof r)&&"object"==typeof(n=e)&&Object.keys(n).every((function(e){return void 0===n[e]||"string"==typeof n[e]}))},event:function(e){var t=e.value;return e=e.dimension.name,!(void 0!==t&&!A(t)||!e)},blood:function(e){var t=!0;if((e=e.dimension.data)instanceof Array){if(0===e.length)return!1;e.forEach((function(e){"string"!=typeof e.com&&(t=!1)}))}return t}};function J(e,t){var n;return null!=(n=null==m?void 0:m[_])&&n[e],null!=(n=null==m?void 0:m[_])&&n.isRuning?m[_][e]:void 0===t?null:t}function Y(e,t){try{m[_][e]=t}catch(e){h("1000")}}function z(e){return JSON.parse(JSON.stringify(e))}function q(e){try{var t;if(window&&window.localStorage&&"undefined"!=typeof Storage&&window.localStorage instanceof Storage)return function(e,t){try{if(window&&window.localStorage)return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return!1}}(e,(t=1e8<(t=Number(function(e){try{if(window&&window.localStorage){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return t}}}catch(e){return null}return null}(e))||0)+1?0:t)+1),t}catch(e){}}function Q(e){var t,n,r={};e=e.split("&");try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next()){var s=a(i.value.split("="),2),c=s[0],u=s[1];c in r?r[c]instanceof Array?r[c].push(u):r[c]=[r[c],u]:r[c]=u}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function X(e){throw new Error("radar error "+e)}var $=function(){return($=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Z(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function ee(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var te=["c_dimension1","c_dimension2","c_dimension3","release_tag","product_version","sub_app"],ne=function(){function e(e){var t,n=this,r=(this.queueConfig={wait:1e3,maxBatchLength:200},this.logQueue=[],this.preStoredLogQueue=[],this.batchTimer=0,this.eventName="onpagehide"in window?"pagehide":"beforeunload",this.customDimension={},this.runtimeIdMap={},this.randomSampling=Math.random(),this.commonDimension={},this.isInYoda=!1,this.sampleData={isHit:!0,core:1},this.ignoreList=["https://web-trace.ksapisrv.com/ktrace/collect"],this.broadcastSample=W(),this.didRate=void 0,this.collect=function(e,t,r){var o=z({key:e,dimension:t=void 0===t?{}:t,value:r=void 0===r?{}:r});if(!n.sampleData||!1!==n.sampleData.isHit){if(!function(e){return e?Object.keys(c).map((function(e){return c[e]})).indexOf(e.key)<0?(h("117"),!1):F[e.key](e):(h("116"),!1)}(o))return h("107","key: ".concat(o.key)),void n.collect(c.EVENT,{sample_rate:t.sample_rate,message:"radar上报日志类型错误",name:"radar_log_error",extra_info:JSON.stringify(o)},{});Object.keys(o.value).forEach((function(e){o.value[e]=o.value[e].toString()})),n.decorateLog(o);var i=n.getCommonData(),u=i.app_version_name;if(delete i.app_version_name,(e=new v((function(e,t){e.dimension.app_version_name=u,e.dimension.did_rate=n.didRate;var r=(null==(r=null==e?void 0:e.dimension)?void 0:r.event_client_timestamp)||Date.now(),o=(null==(o=null==e?void 0:e.dimension)?void 0:o.radar_session_id)||n.radarSessionId;return $($($({},e),i),{event_client_timestamp:r,event_trigger_source:"H5",radar_session_id:o})}))).use((function(e,t){return e.key&&"load"===e.key&&(e.dimension=$($({},e.dimension),{load_device_increase_id:q("LOAD_DEVICE_INCREASE_ID"),load_session_increase_id:n.genSessionIncreaseId("LOAD_SESSION_INCREASE_ID")})),e.key&&"load"!==e.key&&(e.dimension=$($({},e.dimension),{other_device_increase_id:q("OTHER_DEVICE_INCREASE_ID"),other_session_increase_id:n.genSessionIncreaseId("OTHER_SESSION_INCREASE_ID")})),t()})),(o=e.invoke(o))instanceof Error)throw o;try{window.dispatchEvent(new CustomEvent("get-radar-next-data",{detail:{kv:z(o)}}))}catch(e){}if(delete o.dimension.broadcast_info,n.weblog?n.logQueue.push(o):(o.base_href=location.href,n.preStoredLogQueue.push(o)),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];1==+Q(location.search.slice(1)).debug&&f.apply(void 0,s(["[radar] ".concat(e,": ")],a(t),!1))}("radarLogNext",JSON.parse(JSON.stringify(o))),n.logQueue.length>n.queueConfig.maxBatchLength-1)return n.flush(),clearTimeout(n.batchTimer),void(n.batchTimer=0);n.batchTimer||(n.batchTimer=window.setTimeout((function(){n.flush(),clearTimeout(n.batchTimer),n.batchTimer=0}),n.queueConfig.wait))}},this.flush=function(){var e;n.logQueue.length<=0||(e=null,(e=n.config.httpReportFirst?e:n.reportByBridge())&&!n.config.httpReportFirst||n.reportByHttp(),n.logQueue=[])},"object"==typeof e&&null!==e||X("108"),"string"!=typeof e.projectId&&X("109"),J("radarSessionId"));this.radarSessionId=null!=r?r:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),this.config=e,this.sampling="number"==typeof(t=null!=(r=this.config.sampling)?r:1)&&0<=t&&t<=1?t:(h("110"),1),this.bindWeblogger(e.weblogger),null!=(r=this.config)&&r.ignoreList&&Array.isArray(null==(e=this.config)?void 0:e.ignoreList)&&(this.ignoreList=this.ignoreList.concat(this.config.ignoreList.map((function(e){return e.replace(/^(https?:)?\/\//,"")})))),this.queueConfig=$($({},this.queueConfig),null!=(r=this.config)&&r.queueConfig?this.config.queueConfig:{}),null!=(e=this.config)&&e.customDimensions&&this.setDimensions(null==(r=this.config)?void 0:r.customDimensions),R(window,this.eventName,this.flush),"undefined"!=typeof window&&window.yodaCollectErrorDataDestroy&&window.yodaCollectErrorDataDestroy()}return e.prototype.genSessionIncreaseId=function(e){return this.runtimeIdMap[e]||(this.runtimeIdMap[e]=0),this.runtimeIdMap[e]++},e.prototype.bindWeblogger=function(e){var t,n=this;if(null!=e&&"object"!=typeof e)X("106");else{if(this.weblog)return void f("122");this.weblog=e,this.updateUrlPackage(),void 0!==(null==(t=null==e?void 0:e.logger)?void 0:t.radarUrl)&&this.ignoreList.push(null==(t=null==e?void 0:e.logger)?void 0:t.radarUrl),void 0!==(null==(t=null==e?void 0:e.logger)?void 0:t.url)&&this.ignoreList.push(null==(t=null==e?void 0:e.logger)?void 0:t.url),this.isInYoda=!(null==(t=null==(e=this.weblog)?void 0:e.Utils)||!t.yoda),this.getSampleData()}0<this.preStoredLogQueue.length&&(this.preStoredLogQueue.forEach((function(e){if(void 0!==(t=n.sampleData["load"===e.key?"core":e.key])&&(e.dimension.sample_rate=t),"load"===e.key?n.sampleData.core:e.dimension.sample_rate*n.sampleData.core>=n.randomSampling){var t=n.getCommonData(),r=(e.dimension.app_version_name=t.app_version_name,e.h5_extra_attr=JSON.stringify($($({},null==(t=n.weblog.commonPackage)?void 0:t.getH5ExtraAttr()),JSON.parse(e.h5_extra_attr))),function(e){if(-1===(n=(e=void 0===e?location.href:e).lastIndexOf("?")))return{page:e};var t=e.slice(0,n),n=e.slice(n+1);return{url:e,page:t,params:Q(n)}}(e.base_href)),o=null==(t=n.weblog.logConfig)?void 0:t.urlMap;t={};if("function"==typeof o)try{var i=o(r);"string"==typeof i?t={page:i}:"object"==typeof i&&(t={page:i.page,params:i.params})}catch(e){}else if("object"==typeof o){var a,s="";for(a in o)if(-1<(r.page||r.url||"").indexOf(a)){s=o[a];break}s&&(t={page:s})}e.url_package={page:t&&t.page||r.page},i=n.referUrlPackage&&n.referUrlPackage.toJSON(),e.refer_url_package=i,delete e.base_href,n.logQueue.push(e)}})),this.preStoredLogQueue=[],this.flush())},e.prototype.getSampleData=function(){var e,t,n=this;this.isInYoda?(this.sampleData={isHit:!0,core:this.sampling,api:1,resource:.1,error:1,event:1},t=window.updateYodaSampleRateWithParams,window.updateYodaSampleRateWithParams=function(e){p("104",e),n.updateYodaSampleRate(e),n.broadcastSample.emit(n.sampleData),t&&t(e)},window.__yodaCommonDataObject__&&window.__yodaCommonDataObject__.sampleData?(this.updateYodaSampleRate(window.__yodaCommonDataObject__.sampleData),this.collect(c.EVENT,{name:"客户端采样率注入成功",event_type:"radar_sample_inject_success"},{})):"function"==typeof(null==(e=null==(e=null==(e=this.weblog)?void 0:e.Utils)?void 0:e.yoda)?void 0:e.getWebviewLoadPerf)&&null!=(e=this.weblog)&&e.Utils.yoda.getWebviewLoadPerf().then((function(e){null!=e&&e.sampleData&&n.updateYodaSampleRate(e.sampleData)}))):this.sampleData={isHit:this.samplingControl(this.sampling),core:this.sampling}},e.prototype.updateYodaSampleRate=function(e){var t=this,n=null;try{var r=e;n="string"==typeof r?JSON.parse(r):r}catch(e){return void p("error: ",e)}n&&Object.keys(n).forEach((function(e){"load"===e?t.sampleData.core=n[e]:"did_rate"===e?t.didRate=n[e]:t.sampleData[e]=n[e]}))},e.prototype.updateUrlPackage=function(){var e;null!=(e=this.weblog)&&e.currentUrlPackage&&(this.currentUrlPackage=this.weblog.currentUrlPackage,this.referUrlPackage=this.weblog.referUrlPackage)},e.prototype.setDimensions=function(e){var t=this,n=Object.keys(e);n.some((function(e){return-1===te.indexOf(e)}))&&h("113","".concat(n.join("、"))),n.forEach((function(n){null==e[n]?delete t.customDimension[n]:t.customDimension[n]=e[n]}))},e.prototype.setCommonDimension=function(e,t,n){this.commonDimension[e]=(n=void 0===n||n)||null==(n=this.commonDimension[e])?t:n},e.prototype.decorateLog=function(e){this.currentUrlPackage||this.updateUrlPackage(),0<Object.keys(this.customDimension).length&&Object.assign(e.dimension,this.customDimension),0<Object.keys(this.commonDimension).length&&Object.assign(e.dimension,this.commonDimension),this.currentUrlPackage&&this.currentUrlPackage.page!==(null==(e=null==(e=this.weblog)?void 0:e.currentUrlPackage)?void 0:e.page)&&(this.flush(),this.updateUrlPackage())},e.prototype.samplingControl=function(e){return null!==e&&"number"==typeof e&&this.randomSampling<e},e.prototype.getCommonData=function(){var e,t=null==(t=null==(t=null==(t=this.weblog)?void 0:t.commonPackage)?void 0:t.app_package)?void 0:t.version_name;t={h5_extra_attr:JSON.stringify($($({},null==(e=null==(e=this.weblog)?void 0:e.commonPackage)?void 0:e.getH5ExtraAttr()),{app_version_name:t,url:location.href,hash:location.hash,online:null===navigator||void 0===navigator?void 0:navigator.onLine,downlink:null==(e=null===navigator||void 0===navigator?void 0:navigator.connection)?void 0:e.downlink,rtt:null==(e=null===navigator||void 0===navigator?void 0:navigator.connection)?void 0:e.rtt})),url_package:this.currentUrlPackage&&this.currentUrlPackage.toJSON(),refer_url_package:this.referUrlPackage&&this.referUrlPackage.toJSON(),app_version_name:t,project_id:null==(e=this.config)?void 0:e.projectId};return"1"===K("radar_report_test")&&(t.is_report_test=!0),t},e.prototype.reportByHttp=function(){var e=this.getCommonData(),t=(e={project_id:this.config.projectId,radar_session_id:this.radarSessionId,h5_extra_attr:e.h5_extra_attr},this.logQueue.filter((function(e){return"load"===e.key}))),n=this.logQueue.filter((function(e){return"load"!==e.key}));Array.isArray(t)&&t.length&&this.collectLog(e,t,"radarSDK"),Array.isArray(n)&&n.length&&this.collectLog(e,n,"radarSDKSupplement")},e.prototype.collectLog=function(e,t,n){var r;"function"!=typeof(null==(r=this.weblog)?void 0:r.collect)&&"function"!=typeof(null==(r=this.weblog)?void 0:r.sendByHttp)?h("114"):(this.weblog.sendByHttp||this.weblog.collect).call(this.weblog,"RADAR",{name:"radar_log",params:$($({},e),{data:ee([],Z(t),!1)}),serviceName:n})},e.prototype.reportByBridge=function(){var e=null==(n=null==(n=this.weblog)?void 0:n.Utils)?void 0:n.yoda;if(!e)return!1;var t,n=this.logQueue.filter((function(e){return"load"===e.key})),r=this.logQueue.filter((function(e){return"load"!==e.key}));try{return n.forEach((function(t){"function"==typeof(null==(t=e.sendSummarizedLog({key:"h5_load",data:t}))?void 0:t.catch)&&t.catch((function(e){h("123",e)}))})),r.length&&"function"==typeof(null==(t=e.sendRadarLog({data:r}))?void 0:t.catch)&&t.catch((function(e){h("124",e)})),!0}catch(t){return!1}},e}(),re=function(e,t){return(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ie(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}var ae={redirect:{end:"redirectEnd",start:"redirectStart"},dns:{end:"domainLookupEnd",start:"domainLookupStart"},dns_start:{end:"domainLookupEnd",start:"navigationStart"},tcp:{end:"connectEnd",start:"connectStart"},tcp_start:{end:"connectEnd",start:"navigationStart"},redirect_count:{custom:function(e,t){return t.redirectCount}},ssl:{custom:function(e,t){return t.connectEnd&&t.secureConnectionStart?t.connectEnd-t.secureConnectionStart:null}},ssl_start:{custom:function(e,t){return t.secureConnectionStart&&t.navigationStart?t.secureConnectionStart-t.navigationStart:null}},ttfb:{end:"responseStart",start:"requestStart"},request_start:{end:"requestStart",start:"navigationStart"},trans:{end:"responseEnd",start:"responseStart"},dom_parse:{end:"domInteractive",start:"responseEnd"},dom_parse_start:{end:"domInteractive",start:"navigationStart"},blank:{end:"domLoading",start:"navigationStart"},fb:{end:"responseStart",start:"navigationStart"},dom_ready:{end:"domContentLoadedEventEnd",start:"navigationStart"},total:{end:"loadEventStart",start:"navigationStart"},resource:{end:"loadEventStart",start:"domInteractive"},fp:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=performance.getEntries().filter((function(e){return"first-paint"===e.name}))[0];return e?Math.ceil(e.startTime+e.duration):null}},js_cost:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=function(){var e,t="undefined"!=typeof window?window.performance:null;return t&&t.timing?"function"==typeof t.timing.toJSON?((e=t.timing.toJSON())&&!e.redirectStart&&(e.redirectStart=e.navigationStart),e):t.timing:null}(),t=performance.getEntries(),n=performance.getEntries().filter((function(e){return"navigation"===e.initiatorType}))[0];t=t.filter((function(e){return"script"===e.initiatorType}))[0],n=n?n.domComplete:e.domComplete-e.navigationStart;return t&&n?n-t.fetchStart:null}},tti:{end:"domInteractive",start:"navigationStart"},protocol:{custom:function(e,t){return t.nextHopProtocol}},dom_num:{custom:function(){return"undefined"!=typeof document&&void 0!==document.all?document.all.length:null}}},se={main_api:{end:"apiEnd",start:"apiStart",notCatchIfUndefined:!0},main_api_offset:{end:"apiStart",start:"responseEnd",notCatchIfUndefined:!0},fmp:{end:"fmp_time",start:"navigationStart",notCatchIfUndefined:!0}},ce={navigation_start_time:"navigationStart",fetch_start_time:"fetchStart",dns_start_time:"domainLookupStart",dns_end_time:"domainLookupEnd",connect_start_time:"connectStart",ssl_start_time:"secureConnectionStart",request_start_time:"requestStart",response_start_time:"responseStart",response_end_time:"responseEnd",dom_interactive_time:"domInteractive",dom_loading_time:"domLoading",dom_ready_time:"domContentLoadedEventEnd",load_event_time:"loadEventStart",connect_end_time:"connectEnd",load_event_end:"loadEventEnd",dom_complete:"domComplete",dom_content_loaded_event_start:"domContentLoadedEventStart",redirect_start:"redirectStart",redirect_end:"redirectEnd",radar_init_time:"radar_init_time",fmp_time:"fmp_time"};function ue(e,t){if(!Array.isArray(t))return-1;var n=-1;return t.forEach((function(t,r){new RegExp(t).test(e)&&(n=r)})),n}var le=function(e){function t(t){var n=this;return(n=e.call(this,{core:null==t?void 0:t.core,key:c.LOAD,version:"1.2.7",name:"RadarNavigationCollect"})||this).hasFMP=!1,n.syncMetricNum=0,n.customKeys=[],n.custom_metric={},n.optionsMainAPI=[],n.mainAPIList=[],n.radarMainApiList=[],n.mainJSList=[],n.radarMainJSList=[],n.radarTiming={radar_init_time:void 0,fmp_time:void 0,fmp:void 0,apiStart:void 0,apiEnd:void 0},n.h5Load=function(){var e=n.getPerformanceData();n.collect(oe({event_name:"h5_load"},e))},n.dealAPI=function(e){return n.cacheAndCalculateMainAPI(e),n.addMainApiResult(e),n.mainAPIList.filter((function(e){return!!e.url})).length!==n.mainAPIList.length||void 0===n.radarTiming.fmp},n.addMainJSResult=function(e){if(!n.mainJSList||0===n.mainJSList.length)return!1;var t,r,o,i,a,s,c,u,l,d,p,f,h,v,g,y=ue((e.file||"").replace(/\?.+$/,""),n.mainJSList);return-1<y&&!n.radarMainJSList[y].file&&(t=e.file,r=e.cached,o=e.size,i=e.failed,a=e.res_type,s=e.protocol,c=e.fb,u=e.dns,l=e.tcp,d=e.ssl,p=e.ttfb,f=e.trans,h=e.total,v=e.fetch_start,g=e.duration,e=e.start_time,n.radarMainJSList[y]={file:t,cached:r,size:o,failed:i,res_type:a,protocol:s,fb:c,dns:u,tcp:l,ssl:d,ttfb:p,trans:f,total:h,fetch_start:v,duration:g,start_time:e,reg:n.mainJSList[y]}),n.radarMainJSList.filter((function(e){return!!e.file})).length!==n.mainJSList.length},t.core||X("212"),"string"==typeof t.mainApi?(n.optionsMainAPI.push(t.mainApi),n.mainAPIList.push({}),n.radarMainApiList.push({})):Array.isArray(t.mainApi)&&(3<t.mainApi.length&&f("207"),n.optionsMainAPI=t.mainApi.slice(0,3),n.optionsMainAPI.forEach((function(){n.mainAPIList.push({}),n.radarMainApiList.push({})}))),"string"==typeof t.mainJs?(n.mainJSList.push(t.mainJs),n.radarMainJSList.push({})):Array.isArray(t.mainJs)&&(3<t.mainJs.length&&f("211"),n.mainJSList=t.mainJs.slice(0,3),n.mainJSList.forEach((function(){return n.radarMainJSList.push({})}))),performance.timing?n.init():(null!=(t=n.core)&&t.collect("event",{name:"radar_error",message:"performance.timing 不存在无法收集数据",category:c.LOAD}),h("208")),n}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return re(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t.prototype.init=function(){this.radarTiming.radar_init_time=Date.now();var e,t=this.getPerformanceData();this.collect(oe({event_name:"radar_init"},t)),null!=(e=null==(t=this.core)?void 0:t.setCommonDimension)&&e.call(t,"happen_stage","during_fmp"),0<performance.timing.loadEventStart?this.h5Load():R(window,"load",this.h5Load)},t.prototype.customStage=function(e,t){var n,r;void 0===t&&(t={sendTimeline:!0}),this.isHit?(void 0!==e&&"string"==typeof e&&""!==e||X("206"),this.isValidTimestamp(t.timestamp,"custom_stage "+e)&&(n=t.timestamp||Date.now(),r=this.customKeys.length-this.syncMetricNum,this.customKeys.includes(e)?h("204",e):t.sendTimeline&&2<this.syncMetricNum||!t.sendTimeline&&5<r?h("205",e):n&&(this.custom_metric[e+"_time"]=n,this.customKeys.push(e),!t||!0!==t.sendTimeline&&null!=t.sendTimeline||(r=this.getPerformanceData(),this.collect(oe(oe({},r),{stack:(new Error).stack,event_name:"h5_custom_metric",custom_metric_name:e,custom_metric_timestamp:n})),this.syncMetricNum++)))):h("200")},t.prototype.isValidTimestamp=function(e,t){var n;if(void 0===t&&(t="fmp"),void 0!==e&&"number"!=typeof e)X("201");else if(void 0!==e&&e<performance.timing.navigationStart)return f("210","".concat(t)),null!=(n=this.core)&&n.collect("event",{name:"radar_error",message:"【210】".concat(t),extra_info:{timestamp:e,navigationStart:performance.timing.navigationStart}}),!1;return!0},t.prototype.fmp=function(e){var t,n;this.isHit?this.isValidTimestamp(e)&&(e=e||Date.now(),this.hasFMP?f("202"):e&&performance.timing&&(null!=(n=null==(t=this.core)?void 0:t.setCommonDimension)&&n.call(t,"happen_stage","after_fmp"),this.hasFMP=!0,this.radarTiming.fmp_time=e,performance.timing.radarFmp=e,n=this.getPerformanceData(),performance.timing.fmp=this.radarTiming.fmp=n.fmp,this.collect(oe({event_name:"fmp",stack:(new Error).stack},n)))):f("200")},t.prototype.getPerformanceData=function(){var e=oe(oe({},z(performance.timing)),this.radarTiming),t=L(oe(oe({},ae),se),e);return Object.keys(ce).forEach((function(n){0<=e[ce[n]]&&(t[n]=e[ce[n]])})),["radar_main_js_start","lcp","cls","fid","fcp"].forEach((function(e){var n=window.__RADAR_PERFORMANCE_TIMING_&&window.__RADAR_PERFORMANCE_TIMING_[e];!n&&0!==n||(t[e]=n)})),t},t.prototype.cacheAndCalculateMainAPI=function(e){var t;void 0===this.radarTiming.fmp&&(e.before_hook_time&&(t=this.radarTiming.apiStart,this.radarTiming.apiStart=t?Math.min(t,e.before_hook_time):e.before_hook_time),e.after_hook_time&&(t=this.radarTiming.apiEnd,this.radarTiming.apiEnd=t?Math.max(t,e.after_hook_time):e.after_hook_time))},t.prototype.addMainApiResult=function(e){var t,n,r,o,i,a,s,c,u,l,d,p,f,h,v,g,y,m,_=ue((e.api||"").replace(/\?.+$/,""),this.optionsMainAPI);-1<_&&(null==(m=this.mainAPIList[_])||!m.url)&&(m=e.api,t=e.status,n=e.size,r=e.cached,o=e.method,c=e.perfTime,i=e.protocol,a=e.custom_failed,s=e.res_type,y=ie(e,["api","status","size","cached","method","perfTime","protocol","custom_failed","res_type"]),this.mainAPIList[_]=oe({url:m,status:t,size_radar:n,cached:r,method:o,perfTime:c,protocol:i,res_type:s,custom_failed:a},y),c=y.fb,u=y.dns,l=y.tcp,d=y.ssl,p=y.ttfb,f=y.trans,h=y.total,v=y.fetch_start,g=y.duration,y=y.start_time,this.radarMainApiList[_]={api:m,status:t,size:n,cached:r,method:o,protocol:i,fb:c,dns:u,tcp:l,ssl:d,ttfb:p,trans:f,total:h,fetch_start:v,duration:g,custom_failed:a,res_type:s,reg:this.optionsMainAPI[_],start_time:y},this.radarTiming.fmp_time&&e.after_hook_time&&e.after_hook_time<this.radarTiming.fmp_time&&(m=this.getPerformanceData(),this.collect(oe({event_name:"main_api"},m))))},t.prototype.destroy=function(){D(window,"load",this.h5Load),this.customStage=this.fmp=function(){f("213")}},t.prototype.collect=function(e){var t=e.protocol,n=e.event_name,r=(e.custom_metric,e.custom_metric_name),o=e.stack;e.main_api_list,e=ie(e,["protocol","event_name","custom_metric","custom_metric_name","stack","main_api_list"]),this.baseCollect({value:e,dimension:{protocol:t,event_name:n,custom_metric_name:r,custom_metric:JSON.stringify(this.custom_metric),main_api_list:this.mainAPIList,radar_main_api_list:this.radarMainApiList,radar_main_js_list:this.radarMainJSList,is_official:1,stack:o}}),null!=(e=this.core)&&e.flush()},t}(g),de=function(e,t){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},pe=function(){return(pe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function fe(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}var he=O,ve={navigation_start:"startTime",redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"};function ge(e,t){if(e)return"function"==typeof e.get?e.get(t):e[t.toLowerCase()]}function ye(e){var t="";if("string"==typeof e)t=e;else try{t=JSON.stringify(e)}catch(n){t=String(e)}for(var n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);n+=o<128?1:o<2048?2:o<65536?3:o<1<<21?4:o<1<<26?5:o<1<<31?6:Number.NaN}return n}function me(e){var t=(n=document.location).protocol,n=n.host;return 0===e.indexOf("//")?t+e:0===e.indexOf("/")?"".concat(t,"//").concat(n).concat(e):e}function _e(e){return e?"function"==typeof e.get?e.get("Content-Type"):e["content-type"]:null}var be=function(e){function t(t){var n=e.call(this,{core:null==(t=void 0===t?{}:t)?void 0:t.core,sampling:null==t?void 0:t.sampling,key:c.API,version:"1.2.7",name:"RadarAPICollect"})||this;return n.ignoreList=y,n.queue=[],n.logList=[],n.perfList=[],n.broadcastApi=W(),n.initiatorTypeList=[],n.beforeHook=function(e){var t;0===(null==(t=e.url)?void 0:t.indexOf("data:"))||k(e.url,n.ignoreList)||k(e.url,(null==(t=n.core)?void 0:t.ignoreList)||[])||"js"===I(e.url)||"css"===I(e.url)||(t={api:me(e.url),method:e.method,request:e,startTime:Date.now()},n.queue.push(t))},n.afterHook=function(e,t){var r=n.queue.find((function(t){return t.request===e}));if(r){delete r.request;var o=r.startTime,i=(r=fe(r,["startTime"]),Date.now()),a=i-o,s=t.status;if("function"==typeof n.customizeRadarStatus)try{s=n.customizeRadarStatus(t)}catch(t){}var c=n.customHook({request:e,response:t,duration:a}),u=+ge(t.headers,"Content-Length")||0,l=function(e){function t(){e=e.replace(/^\s*/,"")}function n(n){return t(),e[0]===n&&(e=e.slice(1),1)}function r(){t();var n=/^([^\s,;=\\]+)(.*)/.exec(e);if(n)return e=n[2],n[1]}if(e&&"string"==typeof e){for(var o,i=[];o=r();){for(var a={name:o},s={};n(";");){var c,u,l=void 0;(l=r())&&(c=void 0,n("=")&&(c=function(){if(t(),'"'!==e[0])return r();e=e.slice(1);for(var n="";e.length;){var o=/^([^"\\]*)(.*)/.exec(e);if(o){if(n+=o[1],'"'===o[2][0])return e=o[2].slice(1),n;n+=o[2][1],e=o[2].slice(2)}}}(),u=void 0,(u=/([,;].*)/.exec(e))&&(e=u[1])),s[u=l.toLowerCase()]||(s[u]=1,"dur"===u?a.duration=parseFloat(c)||0:"desc"===u?a.description=c||"":a[l]=c))}if("sec"===a.unit&&a.duration&&(a.duration*=1e3),delete a.unit,i.push(a),!n(","))break}return i.length?i:void 0}}(ge(t.headers,"Server-Timing"));a=pe(pe(pe({duration:a,logTime:Date.now(),status:s,size:+u,content_type:_e(t.headers),custom_failed:!(200<=s&&s<300)},r),c),{before_hook_time:o,after_hook_time:i,trace_id:e.trace_id,server_timing:l});2===(null==(s=null==(u=ge(t.headers,"Intercept-Result"))?void 0:u.split(";"))?void 0:s.length)&&null!=(r=n.core)&&r.setCommonDimension&&(n.core.setCommonDimension("intercept_result",s[0],!1),n.core.setCommonDimension("intercept_result_code",s[1],!1),a.api_intercept_result=s[0],a.api_intercept_result_code=s[1]),t.finalUrl&&(a.api=t.finalUrl),"string"==typeof t.text&&(a.responseData=t.text),0!==pe(pe({},t),{status:a.status}).status||c.intercept_report?n.mergeAPIPerf(void 0,a)||n.logList.push(a):(a.size&&0!=a.size||!a.responseData||(a.size=ye(a.responseData)),delete a.responseData,delete a.server_timing,n.collect(a)),n.queue=n.queue.filter((function(t){return t.request&&t.request!==e}))}},void 0!==(n.option=t)&&null!=t&&t.core||X("310"),void 0!==t.ignoreList&&(Array.isArray(t.ignoreList)||X("309"),t.ignoreList.forEach((function(e){"string"!=typeof e&&X("309")})),n.ignoreList=n.ignoreList.concat(t.ignoreList)),n.APIHook=t.APIHook,n.customizeRadarStatus=t.customizeRadarStatus,n.init(),n}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return de(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t.prototype.init=function(){var e,t=this;try{this.observer=new PerformanceObserver((function(e){return t.observeAPI(e)})),this.observer.observe({entryTypes:["resource"]}),this.initiatorTypeList=[],!0!==this.option.ignoreXHR&&(this.initiatorTypeList.push("xmlhttprequest"),this.unhookXML=M((function(e){return t.beforeHook(e)}),(function(e,n){return t.afterHook(e,n)}))),!0!==this.option.ignoreFetch&&(this.initiatorTypeList.push("fetch"),this.unhookFetch=function(e,t){var n=function(e){if("function"!=typeof e.fetch)return null;var t,n=e.fetch;return e.fetch=(t=e.fetch,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return V.apply(void 0,s([t],a(e),!1))}),{register:function(e){return G.push(e),function(){var t=G.indexOf(e);0<=t&&G.splice(t,1)}},clear:function(){G=[]},unRegister:function(){n&&(e.fetch=n)}}}("function"==typeof importScripts?self:window);return n&&n.register({request:function(t,n){"function"==typeof e&&e(t)},response:function(e,n){"function"==typeof t&&t(n,e)},responseError:function(e,n){"function"==typeof t&&t(n,{status:0,statusText:e})}}),null==n?void 0:n.unRegister}((function(e){return t.beforeHook(e)}),(function(e,n){return t.afterHook(e,n)})))}catch(t){h("308"),null!=(e=this.core)&&e.collect("event",{name:"radar_error",message:"PerformanceObserver 不存在无法收集数据",category:c.API})}},t.prototype.customHook=function(e){var t={};if(void 0===this.APIHook)return t;if("function"!=typeof this.APIHook)return f("300"),t;var n={};try{n=this.APIHook(e)}catch(e){return f("301",e),{}}if(!n)return f("302"),t;e=n.response_msg;var r=n.response_code,o=n.status,i=n.custom_failed,a=n.intercept_report;n=n.broadcast_info;if(!0===Boolean(a)&&(t.intercept_report=!0),void 0!==e)try{var s=JSON.stringify(e);100<s.length&&f("307"),t.response_msg=s.slice(0,100)}catch(e){t.response_msg="response_msg返回结果异常",f("303")}return void 0!==r&&(a=Number(r),isNaN(a)?f("304"):t.response_code=a),void 0!==o&&(e=Number(o),isNaN(e)?f("305"):t.status=e),void 0!==i&&(!0===i||!1===i?t.custom_failed=i:f("306")),t.broadcast_info=n,t},t.prototype.observeAPI=function(e){var t=this;e.getEntriesByType("resource").forEach((function(e){var n,r,o;if(0===(null==(o=e.name)?void 0:o.indexOf("data:"))||k(e.name,t.ignoreList)||k(e.name,(null==(o=t.core)?void 0:o.ignoreList)||[]))return!1;"api"===C(e)&&((o=L(he,e)).perfTime=Date.now(),null!=(n=null==(n=e.serverTiming)?void 0:n.map((function(e){return{name:e.name,duration:e.duration,description:e.description||void 0}})))&&n.length||(n=void 0),r={encoded_body_size:e.encodedBodySize,decoded_body_size:e.decodedBodySize},Object.keys(ve).forEach((function(t){r[t]=Number(e[ve[t]]+performance.timing.navigationStart)})),o=pe(pe(pe(pe({},o),{api:o.file}),r),{server_timing:n}),t.mergeAPIPerf(o)||t.perfList.push(o))}))},t.prototype.destroy=function(){this.unhookXML&&this.unhookXML(),this.unhookFetch&&this.unhookFetch(),this.observer&&this.observer.disconnect()},t.prototype.mergeAPIPerf=function(e,t){if(e?t=this.takeItem(e,this.logList):t&&(e=this.takeItem(t,this.perfList)),!e||!t)return!1;if(!0===t.intercept_report)return!0;var n,r=Object.assign({},t,e,{size:e.size||t.size});return delete r.file,r.size&&0!=r.size||!r.responseData||(r.size=ye(r.responseData)),delete r.responseData,(t=t.server_timing||e.server_timing)&&(n=null,t.map((function(e){"total-timing"===e.name&&(n=null!=(e=e.duration)?e:null)})),r.total_server_timing=n,r.server_data_list=JSON.stringify(t)),delete r.server_timing,this.collect(r),!0},t.prototype.takeItem=function(e,t){var n,r=(e.api||"").replace(/\?.+$/,"");if(-1!==(e=t.findIndex((function(e){return e=(e.api||"").replace(/\?.+$/,""),r===e}))))return n=t[e],t.splice(e,1),n},t.prototype.collect=function(e){var t=this,n=e.res_type,r=e.protocol,o=e.api,i=e.custom_failed,a=e.status,s=e.cached,c=e.method,u=e.response_code,l=e.response_msg,d=(e.has_fmp,e.server_data_list),p=e.content_type,v=e.broadcast_info,g=e.before_hook_time,y=e.after_hook_time,m=e.api_intercept_result,_=e.api_intercept_result_code,b={dimension:{before_hook_time:g,after_hook_time:y,res_type:n,protocol:r,api:o,custom_failed:i,status:a,cached:s,method:c,response_code:u,response_msg:l,content_type:p,broadcast_info:v,is_official:1,server_data_list:d,trace_id:e.trace_id,api_intercept_result:m,api_intercept_result_code:_,has_timing_allow:e.has_timing_allow},value:fe(e,["res_type","protocol","api","custom_failed","status","cached","method","response_code","response_msg","has_fmp","server_data_list","content_type","broadcast_info","before_hook_time","after_hook_time","api_intercept_result","api_intercept_result_code","trace_id","has_timing_allow"])};this.broadcastApi.emit(z(e)),0===a&&x(this.option.isIgnoreInvalidStatusCode)?new Promise((function(n,r){var o,i;t.option.isIgnoreInvalidStatusCode&&(function(e){return e&&x(e.then)&&x(e.catch)}(o=t.option.isIgnoreInvalidStatusCode(e))?(i=setTimeout((function(){return n(!1)}),2e3),o.then((function(e){clearTimeout(i),n(!0===e)}),r)):n(!0===o))})).then((function(e){e?f("异步拦截日志"):t.baseCollect(b)}),(function(e){t.baseCollect(b),h(e)})):this.baseCollect(b)},t}(g),Se=function(e,t){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},we=function(){return(we=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ee=Object.assign({},O,{duration:{end:"responseEnd",start:"fetchStart"},cached_type:{custom:function(e,t){var n="hit_browser";if(0===t.transferSize||0===t.duration)return n;if(null==t.transferSize&&(0===t.domainLookupStart||t.responseStart===t.fetchStart))return n;if(t.serverTiming&&t.serverTiming.some((function(e){return"cdn"===e.name}))){if(t.serverTiming.some((function(e){return"miss"===e.name})))return"miss_cdn";if(t.serverTiming.some((function(e){return"hit"===e.name})))return"hit_cdn"}return"miss_browser"},crossOriginSkip:!0},cdn_duration:{custom:function(e,t){return t.serverTiming&&t.serverTiming.some((function(e){return"cdn"===e.name}))?null==(t=null==(t=t.serverTiming)?void 0:t.find((function(e){return"total-timing"===e.name})))?void 0:t.duration:null},crossOriginSkip:!0,cachedSkip:!0},cdn_ip:{custom:function(e,t){if(t.serverTiming&&t.serverTiming.some((function(e){return"cdn"===e.name})))return null==(t=t.serverTiming.find((function(e){return"miss"===e.name||"hit"===e.name})))?void 0:t.description},crossOriginSkip:!0,cachedSkip:!0}}),Oe={fetch_start_time:"fetchStart",redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"};function Pe(e){return Array.isArray(e)?e.map((function(e){var t=void 0===(t=e.tagName)?"":t,n=e.id;return e=e.getAttribute?e.getAttribute("class"):e.className||"",t=t.toLowerCase(),n&&(t+="#".concat(n)),e&&(t+=e.split(/\s+/g).map((function(e){return".".concat(e)})).join("")),t})).filter((function(e){return e})).join(","):""}var ke,Ie,Ae,xe,Te=function(e){function t(t){var n,r=this;return(r=e.call(this,{core:null==t?void 0:t.core,sampling:null!=(n=null==t?void 0:t.sampling)?n:.1,version:"1.2.7",key:c.RES,name:"RadarResourceCollect"})||this).ignoreList=y,r.broadcastJs=W(),r.onResError=function(e,t){var n;(function(e){return e.message||null!=e.lineno})(e)||(n=(e.target.src||e.target.href||"").toString(),n={failed:!0,file:n="function"!=typeof e.target.getAttribute||""!==e.target.getAttribute("src")&&""!==e.target.getAttribute("href")?n:"",res_path:Pe(e&&e.path||e&&e.composedPath&&e.composedPath())},r.collect(n,t),r.broadcastJs.emit(n))},r.observeResource=function(e){e.getEntriesByType("resource").forEach((function(e){var t,n,o;if(0===e.name.indexOf("data:")||k(e.name,r.ignoreList)||k(e.name,(null==(t=r.core)?void 0:t.ignoreList)||[]))return!1;"resource"===C(e)&&(t=L(Ee,e),n={encoded_body_size:e.encodedBodySize,decoded_body_size:e.decodedBodySize},Object.keys(Oe).forEach((function(t){n[t]=Number(e[Oe[t]]+performance.timing.navigationStart)})),o=we(we({failed:!1},t),n),r.collect(o),setTimeout((function(){r.broadcastJs.emit(o)})))}))},r.resourceHook=t.resourceHook,void 0!==t.ignoreList&&(Array.isArray(t.ignoreList)||X("802"),t.ignoreList.forEach((function(e){"string"!=typeof e&&X("802")})),r.ignoreList=r.ignoreList.concat(t.ignoreList)),r.init(),r}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return Se(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t.prototype.init=function(){var e,t=this;try{this.observeResource(performance),this.observer=new PerformanceObserver((function(e){return t.observeResource(e)})),this.observer.observe({entryTypes:["resource"]})}catch(t){h("801"),null!=(e=this.core)&&e.collect("event",{name:"radar_error",message:"PerformanceObserver 不存在无法收集数据",category:c.RES})}R(window,"error",(function(e){return t.onResError(e)}),!0),this.parseSeedLog()},t.prototype.parseSeedLog=function(){var e=this,t=J(w,[]);t.length&&(t.map((function(t){var n=t.data;t=t.dimension||{},e.onResError(n,t)})),Y(w,[]))},t.prototype.collect=function(e,t){var n=e.cached,r=e.failed,o=e.file,i=e.protocol,a=e.res_type,s=e.res_path,c=e.cached_type,u=e.cdn_ip,l=e.has_timing_allow;e=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(e,["cached","failed","file","protocol","res_type","res_path","cached_type","cdn_ip","has_timing_allow"]);try{var d=this.resourceHook&&this.resourceHook({file:o,cached:n,protocol:i,res_type:a,failed:r});if(null!=d&&d.intercept_report)return}catch(e){h("803",e)}this.baseCollect({value:e,dimension:we({cached:n,failed:r,file:o,protocol:i,res_type:a,res_path:s,sample_rate:this.sampling,is_official:1,cached_type:c,cdn_ip:u,has_timing_allow:l},t)})},t.prototype.destroy=function(){this.isHit&&(D(window,"error",this.onResError,!0),this.observer&&this.observer.disconnect())},t}(g),Ce=function(e,t){return(Ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},Le=function(){return"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)},Ne=function(e){return{name:e,value:1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:Le(),isFinal:!1}},Re=function(e,t){try{var n;if(PerformanceObserver.supportedEntryTypes.includes(e))return(n=new PerformanceObserver((function(e){return e.getEntries().map(t)}))).observe({type:e,buffered:!0}),n}catch(e){}},De=!1,Ue=!1,je=function(e){De=!e.persisted},Me=function(){addEventListener("pagehide",je),addEventListener("beforeunload",(function(){}))},Ge=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];Ue||(Me(),Ue=!0),addEventListener("visibilitychange",(function(t){t=t.timeStamp,"hidden"===document.visibilityState&&e({timeStamp:t,isUnloading:De})}),{capture:!0,once:t})},Be=function(e,t,n,r){var o;return function(){n&&t.isFinal&&n.disconnect(),0<=t.value&&(r||t.isFinal||"hidden"===document.visibilityState)&&(t.delta=t.value-(o||0),(t.delta||t.isFinal||void 0===o)&&(e(t),o=t.value))}},Ve=function(){return void 0===ke&&(ke="hidden"===document.visibilityState?0:1/0,Ge((function(e){return e=e.timeStamp,ke=e}),!0)),{get timeStamp(){return ke}}},We=function(){return Ie=Ie||new Promise((function(e){return["scroll","keydown","pointerdown"].map((function(t){addEventListener(t,e,{once:!0,passive:!0,capture:!0})}))}))},Ke=[{name:"fid",collectFn:function(e){function t(e){e.startTime<r.timeStamp&&(n.value=e.processingStart-e.startTime,n.entries.push(e),n.isFinal=!0,i())}var n=Ne("FID"),r=Ve(),o=Re("first-input",t),i=Be(e,n,o);o?Ge((function(){o.takeRecords().map(t),o.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(e,t){t.timeStamp<r.timeStamp&&(n.value=e,n.isFinal=!0,n.entries=[{entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+e}],i())}))}},{name:"lcp",collectFn:function(e){function t(e){var t=e.startTime;t<i.timeStamp?(o.value=t,o.entries.push(e)):o.isFinal=!0,n()}var n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=Ne("LCP"),i=Ve(),a=Re("largest-contentful-paint",t);a&&(n=Be(e,o,a,r),r=function(){o.isFinal||(a.takeRecords().map(t),o.isFinal=!0,n())},We().then(r),Ge(r,!0))}},{name:"cls",collectFn:function(e){function t(e){e.hadRecentInput||(o.value+=e.value,o.entries.push(e),n())}var n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=Ne("CLS",0),i=Re("layout-shift",t);i&&(n=Be(e,o,i,r),Ge((function(e){e=e.isUnloading,i.takeRecords().map(t),e&&(o.isFinal=!0),n()})))}},{name:"fcp",collectFn:function(e){var t,n=Ne("FCP"),r=Ve(),o=Re("paint",(function(e){"first-contentful-paint"===e.name&&e.startTime<r.timeStamp&&(n.value=e.startTime,n.isFinal=!0,n.entries.push(e),t())}));o&&(t=Be(e,n,o))}}],He=function(e){function t(t){var n=e.call(this,{core:t.core,sampling:t.sampling,version:"1.2.7",key:c.EVENT,name:"RadarChromeMetricsCollect"})||this;return n.options={lcp:!1,cls:!1,fid:!1,fcp:!1},n.init=function(){var e=n.options;Ke.forEach((function(t){var r=t.name;e&&!e[r]||t.collectFn((function(e){var t=e.name;e=e.value,function(e,t){null!==window&&void 0!==window&&window.__RADAR_PERFORMANCE_TIMING_||(window.__RADAR_PERFORMANCE_TIMING_={}),window.__RADAR_PERFORMANCE_TIMING_[e]=t}(t.toLocaleLowerCase(),Number(e)),n.baseCollect({dimension:{name:t.toLocaleLowerCase(),is_official:1},value:{duration:Number(e)}})}))}))},Object.assign(n.options,t.options),Ke.forEach((function(e){var t=K("radar_"+e.name);t&&(n.options[e.name]="1"===t)})),n.init(),n}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return Ce(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t}(g),Fe=function(e,t){return(Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},Je=function(){return(Je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ye=function(e){function t(t){var n=e.call(this,{core:t.core,sampling:t.sampling,key:c.EVENT,version:"1.2.7",name:"RadarEventCollect"})||this;return n.action={start:function(e){n._checkActionDimension(e),n.event({name:e.name,extra_info:e.extra_info,event_type:"radar_action_start"})},end:function(e){n._checkActionDimension(e),n.event({name:e.name,extra_info:e.extra_info,result_type:e.result_type,event_type:"radar_action_end"})}},n.parseSeedLog(),n}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return Fe(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t.prototype.parseSeedLog=function(){var e=this,t=J(E,[]);t.length&&(t.map((function(t){var n=t.dimension;t=t.value,e.event(n,t)})),Y(E,[]))},t.prototype.event=function(e,t){var n;this.isHit?(e||X("402"),void 0!==e.name&&"string"==typeof e.name||X("402"),127<e.name.length&&(h("403"),e.name=e.name.slice(0,127)),e.is_official=1,t&&void 0!==t.duration&&("number"!=typeof t.duration||t.duration<0)&&X("404"),t&&void 0!==t.event_count&&("number"!=typeof t.event_count||t.event_count<0)&&X("405，".concat(t.event_count)),n={dimension:e,value:t},e&&e.extra_info&&"object"==typeof e.extra_info&&(n={dimension:Je(Je({},e),{extra_info:JSON.stringify(e.extra_info)}),value:t}),this.baseCollect(n)):f("401")},t.prototype.destroy=function(){this.event=function(){f("407")},this.action={start:function(){f("407")},end:function(){f("407")}}},t.prototype._checkActionDimension=function(e){if(!e)throw Error("408");void 0===e.extra_info||e.extra_info instanceof Object||X("406")},t}(g),ze=function(e,t){return(ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},qe=function(){return(qe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Qe(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(xe=Ae=Ae||{}).SCRIPT="script",xe.RES="res",xe.API="api",xe.VIDEO="video";var Xe=[];function $e(e,t,n){var r,o;if(t&&(t instanceof Error||"object"==typeof t&&"string"==typeof t.message)){if("BridgeError"===(r=t.name||"ErrorLikeObject")&&"function"==typeof t.toJSON)try{var i=t.toJSON();delete i.name,delete i.message,o="".concat(t.message," (").concat(JSON.stringify(i),")")}catch(e){o=t.message||""}else o=t.message||"";i=t.stack||void 0}else o=null==t&&"Script error."===(null==n?void 0:n.message)?(r="CrossOriginError","".concat(e," - message: ").concat((null==n?void 0:n.message)||"<UNKNOWN>")):null===t&&null!=n&&n.message&&"Uncaught null"!==n.message?(r="Error","".concat(e," - message: ").concat(n.message)):(r=null==t?"".concat(t):typeof t,n=function(e){var t;try{t=e.toString(),e&&"object"==typeof e&&(t=JSON.stringify(e))}catch(e){}return"string"!=typeof t||""===t?t=null===e?"<NULL>":void 0===e?"<UNDEFINED>":""===t?"<EMPTY>":"<UNKNOWN>":2e3<t.length&&(t=t.substring(0,2e3)+"<<< ……"),t}(t),"".concat(e," - value: ").concat(n));return{error_type:Ae.SCRIPT,error_cons_type:r,msg:o,stack:i}}function Ze(e){for(var t=0;t<Xe.length;t++)if(et(Xe[t],e))return t;return-1}function et(e,t){return e.msg===t.msg&&e.stack===t.stack&&e.file===t.file&&e.line===t.line&&e.col===t.col}var tt=function(e){function t(t){var n=e.call(this,{core:t.core,sampling:t.sampling,key:c.ERROR,version:"1.2.7",name:"RadarErrorCollect"})||this;return n.onError=function(e,t){var r;!(r=e).message&&null==r.lineno||(e=qe(qe({},$e("Global Uncaught Exception",e.error,e)),{file:e.filename,line:e.lineno,col:e.colno}),n.isSameErrorAndReport(e,t))},n.onPromiseError=function(e,t){e=$e("Unhandled Promise Rejection",e.reason),n.isSameErrorAndReport(e,t)},n.core=t.core,n.init(),n}var n=t,r=e;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return ze(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),t.prototype.init=function(){Xe.splice(0),R(window,"error",this.onError,!0),R(window,"unhandledrejection",this.onPromiseError),this.parseSeedLog()},t.prototype.destroy=function(){D(window,"error",this.onError,!0),D(window,"unhandledrejection",this.onPromiseError),this.captureException=function(){f("600")}},t.prototype.parseSeedLog=function(){var e=this,t=J(S,[]);t.length&&(t.map((function(t){var n=t.data;t=t.dimension||{},"unhandledrejection"===(null==n?void 0:n.type)?e.onPromiseError(n,t):e.onError(n,t)})),Y(S,[]))},t.prototype.isSameErrorAndReport=function(e,t){0<=Ze(e)||(Xe.push(e),setTimeout((function(){Xe.splice(Ze(e),1)}),2e3),this.collect(e,t))},t.prototype.collect=function(e,t){var n,r,o,i,a,s,c,u;r=(n=e).error_cons_type,o=n.file,i=n.error_type,a=n.msg,s=n.col,c=n.line,u=n.stack,e={key:"error",value:Qe(n,["error_cons_type","file","error_type","msg","col","line","stack"]),dimension:{error_cons_type:r,file:o,error_type:i,msg:a,col:s,line:c,stack:u}},t=qe(qe({},e.dimension),t||{}),this.baseCollect({dimension:t,value:e.value})},t.prototype.captureException=function(e){this.isSameErrorAndReport($e("Captured Exception",e))},t}(g),nt=function(){function e(e){var t,n=this;this.core=new ne({weblogger:e.weblog,projectId:e.projectId,sampling:null!=(t=e.sampling)?t:1,httpReportFirst:e.httpReportFirst,customDimensions:e.customDimensions}),this.navigationCollect=new le({core:this.core,mainApi:e.mainApi,mainJs:e.mainJs}),e.unuseAPIPlugin||(this.apiCollect=new be({core:this.core,sampling:e.apiSampling,APIHook:e.APIHook,customizeRadarStatus:e.customizeRadarStatus,ignoreList:e.ignoreList,ignoreXHR:e.ignoreXHR,ignoreFetch:e.ignoreFetch,isIgnoreInvalidStatusCode:e.isIgnoreInvalidStatusCode}),this.apiCollect.broadcastApi.on((function(e){return n.navigationCollect.dealAPI(e)}))),e.unuseResourcePlugin||(this.resourceCollect=new Te({sampling:e.resourceSampling,core:this.core,ignoreList:e.ignoreList,resourceHook:e.resourceHook}),this.resourceCollect.broadcastJs.on((function(e){return n.navigationCollect.addMainJSResult(e)}))),this.chromeMetricsCollect=new He({core:this.core,options:{lcp:e.lcp,cls:e.cls,fid:e.fid,fcp:e.fcp}}),this.eventCollect=new Ye({core:this.core}),this.action=this.eventCollect.action,e.unuseErrorPlugin||(this.errorCollect=new tt({core:this.core})),m[_]&&(m[_].isCoreReady=!0)}return e.prototype.apply=function(e){this.bindWeblogger(e)},e.prototype.bindWeblogger=function(e){this.weblogger=e,this.core.bindWeblogger(this.weblogger)},e.prototype.event=function(e,t){this.eventCollect.event(e,t)},e.prototype.customStage=function(e,t){this.navigationCollect.customStage(e,t)},e.prototype.setDimensions=function(e){this.core.setDimensions(e)},e.prototype.fmp=function(e){"number"==typeof e?this.navigationCollect.fmp(e):"object"==typeof e&&e.timestamp?this.navigationCollect.fmp(e.timestamp):this.navigationCollect.fmp()},e.prototype.captureException=function(e){var t;this.errorCollect&&null!=(t=this.errorCollect)&&t.captureException(e)},e.prototype.destroy=function(){var e;null!=(e=this.navigationCollect)&&e.destroy(),null!=(e=this.apiCollect)&&e.destroy(),null!=(e=this.resourceCollect)&&e.destroy(),null!=(e=this.eventCollect)&&e.destroy(),null!=(e=this.errorCollect)&&e.destroy()},e.key="radar",e.version="1.2.7",e}();"undefined"!=typeof window&&"function"!=typeof window.Radar&&(window.Radar=nt)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceObserverPlugin=void 0;var i=n(12),a=n(3),s=n(1),c=n(2),u=n(0),l=function(e,t){try{var n=(null!=t?t:{}).type;if(n&&-1<PerformanceObserver.supportedEntryTypes.indexOf(n)){var r=new PerformanceObserver((function(t){return t.getEntries().forEach(e)}));return r.observe(t),r}}catch(e){(0,u.JSLogger)({error:e})}},d={navigationStart:-1,pixel_context_init_start:-1,browsed_max_pixel:0,loaded_max_pixel:0,fcp_timestamp:-1,fmp_timestamp:-1,dom_timestamp:-1,lcp_timestamp:-1,loaded_timestamp:-1,closed_timestamp:-1,closed_method:"",stay_time:0,click_count:0},p=function(e){function t(t){var n=t.context,r=e.call(this,n)||this;return r.enable=!1,r.isSendWhenLeave=!1,r.extraData=d,r.startTimestamp=0,r.maxScrollHeight=0,r}return o(t,e),t.prototype.adInfoInitEnd=function(){this.enable=this.context.hasAdInfo()&&(0,a.isInWebView)(),this.addListeners()},t.prototype.visibilityChange=function(e,t){t?(this.isSendWhenLeave=!1,this.startTimestamp=+e,this.extraData.click_count=0):this.isSendWhenLeave||(this.isSendWhenLeave=!0,this.report(e,"visibilitychange"))},t.prototype.pageWillLeave=function(e,t){this.isSendWhenLeave||(this.isSendWhenLeave=!0,this.report(e,t))},t.prototype.contextInitStart=function(e){this.updateExtraData("pixel_context_init_start",+e)},t.prototype.logFMP=function(e){this.updateExtraData("fmp_timestamp",+e)},t.prototype.addListeners=function(){this.enable&&(this.addClickListener(),this.addScrollListener(),this.addLCPListener(),this.addFCPListener())},t.prototype.addClickListener=function(){var e=this;null===s.windowSnapshot||void 0===s.windowSnapshot||s.windowSnapshot.addEventListener("click",(function(){e.updateExtraData("click_count",e.extraData.click_count+1)}))},t.prototype.addScrollListener=function(){var e=this;null===s.windowSnapshot||void 0===s.windowSnapshot||s.windowSnapshot.addEventListener("scroll",(function(){var t=(null!==s.windowSnapshot&&void 0!==s.windowSnapshot?s.windowSnapshot:{}).scrollY,n=void 0===t?0:t;e.maxScrollHeight=Math.max(n,e.maxScrollHeight)}),{passive:!0})},t.prototype.addLCPListener=function(){var e=this;l((function(t){e.updateExtraData("lcp_timestamp",t.startTime)}),{type:"largest-contentful-paint",buffered:!0})},t.prototype.addFCPListener=function(){var e=this;l((function(t){"first-contentful-paint"===t.name&&e.updateExtraData("fcp_timestamp",t.startTime)}),{type:"paint",buffered:!0})},t.prototype.updatePerformanceData=function(){var e,t=(null!==(e=null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.performance)&&void 0!==e?e:{}).timing,n=null!=t?t:{},r=n.navigationStart,o=void 0===r?-1:r,i=n.domComplete,a=void 0===i?-1:i,c=n.loadEventStart,u=void 0===c?-1:c;0===this.startTimestamp&&(this.startTimestamp=o),this.updateExtraData("navigationStart",o),this.updateExtraData("dom_timestamp",a),this.updateExtraData("loaded_timestamp",u)},t.prototype.updateExtraData=function(e,t){this.extraData[e]=t},t.prototype.report=function(e,t){var n;if(this.enable){this.updatePerformanceData(),this.extraData.closed_timestamp=+e,this.extraData.stay_time=+e-this.startTimestamp,this.extraData.loaded_max_pixel=function(){var e,t,n,r,o,i,a=null!==(e=null===s.windowSnapshot||void 0===s.windowSnapshot?void 0:s.windowSnapshot.document)&&void 0!==e?e:{},c=a.body,u=a.documentElement;return Math.max(null!==(t=null==c?void 0:c.scrollHeight)&&void 0!==t?t:0,null!==(n=null==c?void 0:c.offsetHeight)&&void 0!==n?n:0,null!==(r=null==u?void 0:u.clientHeight)&&void 0!==r?r:0,null!==(o=null==u?void 0:u.scrollHeight)&&void 0!==o?o:0,null!==(i=null==u?void 0:u.offsetHeight)&&void 0!==i?i:0)}(),this.extraData.browsed_max_pixel=this.maxScrollHeight,this.extraData.closed_method=t;var r=null===(n=this.context.data.adInfo)||void 0===n?void 0:n.pixelId;r&&this.context.trackSync(r,c.EVENT_NAME_FORMAT.EVENT_PAGE_LEAVE,{pageLeaveInfo:this.extraData},c.REPORT_TYPE.TRACK_DATA,{trySendBeacon:!0})}},t}(i.Plugin);t.PerformanceObserverPlugin=p},function(e,t,n){!function(e,t){"use strict";var n,r,o;Object.defineProperty||(Object.defineProperty=function(e,t,n){e[t]="[object Object]"===Object.prototype.toString.call(n)&&n.hasOwnProperty("value")?n.value:n}),Object.assign||Object.defineProperty(Object,"assign",{value:function(e){if(null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!==r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},writable:!0,configurable:!0}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){var o=this instanceof r?this:e;return n.apply(o,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(r.prototype=this.prototype),o.prototype=new r,o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),o=r.length>>>0;if(0===o)return-1;var i=+t||0;if(Math.abs(i)===1/0&&(i=0),i>=o)return-1;for(n=Math.max(i>=0?i:o-Math.abs(i),0);n<o;){if(n in r&&r[n]===e)return n;n++}return-1}),Object.keys||(Object.keys=(n=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var t=[];for(var i in e)n.call(e,i)&&t.push(i);if(r)for(var a=0,s=o;a<s.length;a++){var c=s[a];n.call(e,c)&&t.push(c)}return t})),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,r;if(null==this)throw new TypeError(" this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=0;r<i;){var a=void 0;r in o&&(a=o[r],e.call(n,a,r,o)),r++}});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function u(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function d(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var p={sessionId:"",appDevicePackageReady:!1,identityPackageReady:!1},f=function(){function e(e,t){switch(this.page="",this.identity="",t){case"web":this.page_type=2;break;case"native":this.page_type=1;break;case"mina":this.page_type=3;break;default:this.page_type=0}this.update(e.page,e.params)}return e.prototype.update=function(e,t){void 0===e&&(e=""),e&&e!==this.page&&(this.page=e,this.identity=this.generatePageId(e)),t&&(this.params=Object.assign(this.params||{},t))},e.prototype.toJSON=function(){return{page:this.page,identity:this.identity,page_type:this.page_type,params:JSON.stringify(this.params),category:this.category}},e.prototype.generatePageId=function(e){return e+(new Date).getTime()},e}(),h=["Kwai","Kwai_Lite","Kwai_Pro","livemate","ksthanos","ksNebula","ksnebula","kwaiying","pearl","kinder","m2u","LOLita","XFunCore","ACVideoCore","ZIKZAK"].concat(["UVideo","Vstatus","Kwaigo","MvMaster"]),v="undefined"==typeof window?{addEventListener:function(){},removeEventListener:function(){},setTimeout:function(){},setInterval:function(){},_WEBLOGGER_MOCKED_WINDOW_:!0,document:{cookie:"",addEventListener:function(){},removeEventListener:function(){},querySelector:function(){},querySelectorAll:function(){}},navigator:{userAgent:"",sendBeacon:function(){}},screen:{},history:{},location:{hostname:"",search:"",href:"",origin:""},localStorage:{getItem:function(){},setItem:function(){}}}:window;function g(e,t,n){var r,o={};if(e.length>0)for(var i=t?decodeURIComponent:function(e){return e},a=e.split(/;\s/g),s=null,c=null,u=null,l=0,d=a.length;l<d;l++){if((u=null===(r=a[l])||void 0===r?void 0:r.match(/([^=]+)=/i))&&null!==u)try{s=decodeURIComponent(u[1]),c=i(a[l].substring(u[1].length+1))}catch(e){}else s=decodeURIComponent(a[l]),c="";null!==s&&(o[s]=c)}return o}var y,m={};function _(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1);try{if(!n&&e in m)return m[e];var r=v.document.cookie||"";return r===y?m[e]:(y=r,(m=g(r,!t.raw))[e])}catch(e){}}function b(e,t,n){void 0===n&&(n={});try{v.document.cookie=function(e,t,n,r){void 0===r&&(r={});var o="".concat(encodeURIComponent(e),"=").concat(n?encodeURIComponent(t):t),i=r.expires,a=r.path||"/",s=r.domain||"";return i instanceof Date&&(o+="; expires=".concat(i.toUTCString())),"number"==typeof i&&(o+="; max-age==".concat(i)),""!==a&&(o+="; path=".concat(a)),""!==s&&(o+="; domain=".concat(s)),!0===r.secure&&(o+="; secure"),o}(e,t,!n.raw,n),m[e]=t}catch(e){}}var S={getCookie:_,setCookie:b,parseCookieString:g};function w(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.log;return n&&n.call.apply(n,d([console],e,!1))}catch(e){return}}function E(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.error;return n&&n.call.apply(n,d([console],e,!1))}catch(e){return}}function O(e,t,n,r){return"attachEvent"in e?e.attachEvent("on"+t,n):e.addEventListener(t,n,r)}function P(e,t,n,r){return"attachEvent"in e?e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}function k(e,t,n){if(void 0===n&&(n=" "),(t-=e.length)<=0)return e;for(var r="";t;)1&t&&(r+=n),t>>=1,n+=n;return r+e}var I=function(e){void 0===e&&(e=v.navigator.userAgent.toLowerCase());try{for(var t=0;t<h.length;t++)if(e.indexOf(h[t].toLowerCase())>-1)return!0}catch(e){return!1}};function A(e){for(var t={},n=0,r=e.split("&");n<r.length;n++){var o=r[n].split("="),i=o[0],a=o[1];i in t?t[i]instanceof Array?t[i].push(a):t[i]=[t[i],a]:t[i]=a}return t}function x(){var e=_("appver",void 0,!0);return e&&function(e,t){if(!t)return!1;if(-1!==t.indexOf("alpha"))return!1;if(-1!==t.indexOf("beta"))return!1;try{var n=e.match(/\d+\.\d+\.\d+/);if(!(e=(null==n?void 0:n[0])||""))return!0;if(n=t.match(/\d+\.\d+\.\d+/),!(t=(null==n?void 0:n[0])||""))return!1;var r=e.split(".").map((function(e){return Number(e)})),o=r[0],i=r[1],a=r[2],s=t.split(".").map((function(e){return Number(e)})),c=s[0],u=s[1],l=s[2];return!(c<o||!(c>o)&&(u<i||!(u>i)&&l<a))}catch(e){return!1}}("10.8.30",e)}function T(e){void 0===e&&(e=v.location.href);var t=e.lastIndexOf("?");return-1===t?{page:e}:{page:e.slice(0,t),params:A(e.slice(t+1))}}var C=function(e){return e&&"object"==typeof e&&!Array.isArray(e)};function L(e){return!e||!/^(https?:)?\/\//.test(e)||(E("[error 108]","请注意当前埋点页面信息为 ".concat(e,"，不符合规范，上报失败！")),!1)}var N,R=(N="",function(){if(N)return N;try{var e=v.devicePixelRatio||1,t=Math.floor(screen.width*e),n=Math.floor(screen.height*e);return N="".concat(t,"x").concat(n)}catch(e){return""}}),D=function(){return!(!((null==v?void 0:v.Worker)&&(null==v?void 0:v.Uint8Array)&&v.URL&&v.Promise)||function(){var e,t,n=(null===(e=null==v?void 0:v.navigator)||void 0===e?void 0:e.userAgent)||"",r=/mobile|tablet|ip(ad|hone|od)|android|(windows phone)/i.test(n),o="MacIntel"===(null==v?void 0:v.navigator.platform)&&(null===(t=null==v?void 0:v.navigator)||void 0===t?void 0:t.maxTouchPoints)>1;return r||o}())},U=function(e){try{return Math.abs(Math.floor(e))}catch(t){return e}};function j(e){return"string"==typeof e?e:"object"==typeof e?JSON.stringify(e):""}var M=function(){function e(){this.events={}}return e.prototype.on=function(e,t){var n;t&&"function"==typeof t&&(this.events[e]=this.events[e]||[],null===(n=this.events[e])||void 0===n||n.push(t))},e.prototype.off=function(e,t){if(this.events[e]){if(t&&"function"==typeof t){var n=this.events[e];n&&(o=t,(i=(r=n).indexOf(o))>-1&&r.splice(i,1))}var r,o,i;t||(this.events[e]=[])}},e.prototype.emit=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.events[e]&&(null===(t=this.events[e])||void 0===t||t.forEach((function(e){e.apply(void 0,n)})))},e}(),G=0,B=function(e){function t(n,r){var o,i=e.call(this)||this;return i.version="3.10.28",i.plugins={},i.flush=function(){i.logger.flush()},i.baseOption=s({},r),i.logConfig=(o=n,s({env:"production",proto:"v3",timeout:3e4,wait:1e3,maxBatchLength:50,sampleRate:1,yoda:"undefined"!=typeof window&&window.yoda,forbidV2HttpUrlPage:!0},o||{})),i.initUrlPackage(),t.__instance||(t.__instance=i),i}return a(t,e),Object.defineProperty(t.prototype,"sessionId",{get:function(){return p.sessionId},enumerable:!1,configurable:!0}),t.prototype.initUrlPackage=function(){this.updateCurrentUrlPackage()},t.prototype.updateCurrentUrlPackage=function(e,t){if(void 0===e&&(e={}),void 0===t&&(t="web"),"object"==typeof e&&e.page&&this.currentUrlPackage&&e.page===this.currentUrlPackage.page)return this.currentUrlPackage.update(e.page,e.params);this.currentUrlPackage=new f(e,t)},t.prototype.updateReferUrlPackage=function(e,t){void 0===e&&(e=this.currentUrlPackage),void 0===t&&(t="web"),this.referUrlPackage=e instanceof f?e:new f(e,t)},t.prototype.updateBase=function(e){this.updateCommonPackage(e)},t.prototype.updateCommonPackage=function(e){"object"==typeof e&&this.commonPackage.update(e)},t.prototype.addPlugins=function(){var e=this;this.logConfig.plugins&&this.logConfig.plugins.length&&this.logConfig.plugins.forEach((function(t){"object"==typeof t&&"function"==typeof t.apply&&e.addPluginInstance(t)}))},t.prototype.addPluginInstance=function(e){if(e){var t=e.key||e.constructor&&e.constructor.key||"plugin_auto_key_".concat(G++);"function"!=typeof e.apply||e.weblog&&e.weblog===this||e.apply(this),this.plugins[t]=e}},t.prototype.plug=function(e,t){if(this.plugins[e.key])return E("[code 301]","".concat(e.key," 插件重复加载！"));this.addPluginInstance(new e(this,t))},t.prototype.unplug=function(e){var t=this.plugins[e];t&&(t.destroy(),delete this.plugins[e])},t.prototype.unplugAll=function(){for(var e in this.plugins)this.plugins[e]&&this.unplug(e)},t.prototype.generateLog=function(e,t){return{}},t.prototype.send=function(e,t,n){var r=this.generateLog(e.toUpperCase(),t);return"function"==typeof this.beforeSend&&this.beforeSend(e,t,r),this.logger.send(r,!!n,t.callback)},t.prototype.collect=function(e,t){this.send(e,t)},t.prototype.sendImmediately=function(e,t){this.send(e,t,!0)},t.prototype.sendPackage=function(e,t){this.logger.sendPackage(e,t)},t.prototype.destroy=function(){this.unplugAll()},t}(M);function V(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function W(e){if(void 0===e&&(e="undefined"!=typeof location?location.hostname:""),!e)return"";var t=e.split("."),n=t.length;return n<=2?"":".".concat(t[n-2],".").concat(t[n-1])}function K(){try{var e=_("did")||_("_did");if(!e){e="web_".concat(function(){for(var e=1e9*Math.random()>>>0,t=[],n=0;n<7;n++)t.push("0123456789ABCDEF".charAt(16*Math.random()));return e+t.join("")}());var t=new Date;t.setFullYear(t.getFullYear()+1),b("_did",e,{expires:t,domain:W(),path:"/"})}return e}catch(e){return""}}var H="WEBLOGGER_SESSIONID",F=function(e){function t(t,n,r){var o=e.call(this,{},n)||this;if("string"==typeof t){var i=T(t);o.page=i.page,o.params=i.params}else o.page=(t||{}).page||"",o.params=(t||{}).params||void 0;return o.identity=o.generatePageId(),r&&"string"==typeof t&&o.init(t,r),o}return a(t,e),t.prototype.init=function(e,t){void 0===t&&(t={});var n=function(e,t){var n=e.url,r=e.page,o=e.params,i=e.pageId;if(!r&&"string"==typeof n){var a=T(n);r=a.page,o=a.params}if("function"==typeof t)try{var s=t({url:n,page:r,params:o});"string"==typeof s?r=s:"object"==typeof s&&(s.page&&(r=s.page),s.params&&(o=s.params),s.pageId&&(i=s.pageId))}catch(e){}else if("object"==typeof t){var c="";for(var u in t)if((n||r||"").indexOf(u)>-1){c=t[u];break}c&&(r=c)}return{page:r,params:o,pageId:i}}({url:e,page:this.page,params:this.params},t),r=n.page,o=n.params;this.update(r,o)},t.prototype.attachUrl=function(){var e;if(this.params||(this.params={}),null===location||void 0===location?void 0:location.href){this.params.origin_url=this.params.origin_url||(null===(e=v.location)||void 0===e?void 0:e.href);var t=T(v.location.href).page,n=void 0===t?"":t;this.params.origin_pathname=n}},t.prototype.getRealUrlPackage=function(){var e=T(v.location.href),t=e.page,n=e.params;return{page:t,params:JSON.stringify(s({page_code:this.page,url:v.location.href,query:n},n)),page_type:this.page_type,identity:this.identity}},t.prototype.generatePageId=function(){return V()},t}(f),J="https://data-track.corp.kuaishou.com",Y=J+"/",z="production",q="logger",Q="logger-oversea",X="rest/wd/common/log/collect/",$=[z,"test","development",q,"oversea"],Z="https://logsdk.kwai-pro.com/",ee={v2:"rest/kd/log/collect?_json=1&biz=",v3:"".concat(X,"misc2"),radar:"".concat(X,"radar")},te={v2:{production:["https://wlog.ksapisrv.com/","https://wlog.gifshow.com/"][Math.round(Math.random())],development:Y,test:Y,oversea:Z},v3:{production:"https://log-sdk.ksapisrv.com/",development:Y,test:Y,oversea:Z}},ne=function(e,t,n){return void 0===e&&(e=z),void 0===t&&(t=!1),void 0===n&&(n="v3"),-1===$.indexOf(e)?e+ee[n]:t&&te.v3[e]?te.v3[e]+ee.radar:te[n][e]&&ee[n]?te[n][e]+ee[n]:te.v3.production+ee.v3},re=function(e,t){if(!t)return e;try{return/\?(.+?)$/.test(e)?e.replace(/\?(.+?)$/,"?".concat(t,"&$1")):e+"?".concat(t)}catch(t){return e}},oe=function(){function e(e,t){var n=this;this.asyncQueue=[],this.throttleQueue=[],this.errorQueue=[],this.sendingQueue={},this.url="",this.isV2=!1,this.isDebug=!1,this.radarUrl="",this.drained=!1,this.batchCount=50,this.isSetSamplingResult=!1,this.sendingYield=null,this.flush=function(e){n.sendLogs(n.throttleQueue.concat(n.asyncQueue),e),n.throttleQueue=[],n.asyncQueue=[]},this.drain=function(){n.drained=!0,n.flush(),n.flushErrorLogs(),setTimeout((function(){n.drained=!1}),1e3)},this.config=e,this.config.maxBatchLength&&this.config.maxBatchLength>1&&(this.batchCount=Math.min(50,this.config.maxBatchLength)),this.commonPackage=t,this.isDebug=this.config.logger||"logger"===this.config.env,this.isV2="v2"===this.config.proto,this.updateUrls()}return e.prototype.sendData=function(e,t){return"function"==typeof this.config.sender?this.config.sender(e,t):this.baseSendData(e,t)},Object.defineProperty(e.prototype,"responseSamplingStorageKey",{get:function(){var e=this.commonPackage.app_package,t=e.product_name,n=e.product,r=this.commonPackage.identity_package.device_id;return"RESPONSE_SAMPLING_STORAGE_KEY_".concat(t||n,"_").concat(r)},enumerable:!1,configurable:!0}),e.prototype.updateUrls=function(){var e=this.config.env;e&&/^(https?:)?\/\//.test(e)?this.url=e:this.url=ne(e),this.formatUrl()},e.prototype.formatUrl=function(){this.radarUrl||(this.radarUrl=this.url.replace(-1!==this.url.indexOf(ee.v2)?ee.v2:ee.v3,ee.radar),-1!==this.radarUrl.indexOf(te.v2.production||"")&&this.radarUrl.replace(te.v2.production||"",te.v3.production));var e=this.commonPackage.app_package,t=e.product_name,n=e.product,r="v=3.10.28&kpn=".concat(t||n);this.url=re(this.url,r),this.radarUrl=re(this.radarUrl,r)},e.prototype.getCommonPackageJSON=function(){return this.commonPackage.toJSON()},e.prototype.send=function(e,t,n){if(void 0===t&&(t=!1),n||this.drained)return this.sendLogs([e],n);t?this.sendAsync(e,n):this.sendThrottle(e)},e.prototype.sendAsync=function(e,t){return u(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return this.asyncQueue.push(e),this.asyncQueue.length>=this.batchCount?(this.flush(),[2]):this.sendingYield?[4,this.sendingYield]:[3,2];case 1:t.sent(),this.sendingYield=null,t.label=2;case 2:return t.trys.push([2,4,,5]),[4,Promise.resolve()];case 3:case 4:return t.sent(),[3,5];case 5:return this.asyncQueue.length?(this.flush(),[2]):[2]}}))}))},e.prototype.sendThrottle=function(e){var t=this;this.throttleQueue.push(e),this.throttleQueue.length>=this.batchCount?this.flush():(clearTimeout(this.batchWaitTimer),this.batchWaitTimer=setTimeout((function(){t.flush()}),this.config.wait))},e.prototype.sendLogs=function(e,t){var n=this;if(!e||!e.length)return"function"==typeof t&&t();var r=this.buildLogPackage(e,this.url);this.sendPackage(r,(function(e){e?n.errHandler(r):n.flushErrorLogs(),"function"==typeof t&&t(e)}))},e.prototype.sendPackage=function(e,t){var n=this.config.timeout;try{this.sendData(s(s({},e),{isDebug:this.isDebug,isDrained:this.drained,timeout:n}),t)}catch(e){"function"==typeof t&&t(e)}},e.prototype.buildLogPackage=function(e,t){return this.isV2?this.buildV2Package(e,t):this.buildV3Package(e,t)},e.prototype.buildV2Package=function(e,t){return{url:t,data:{log:{event:e}}}},e.prototype.buildV3Package=function(e,t,n){var r=this.getCommonPackageJSON();return n&&Object.assign(r,n),{url:t,data:{common:r,logs:e}}},e.prototype.errHandler=function(e){var t;if(this.isV2)this.errorQueue.unshift(e);else{var n=e.data;if(n.logs.length){delete n.common.h5_extra_attr.http_seq_id,delete n.common.h5_extra_attr.client_timestamp;for(var r=!1,o=0;o<this.errorQueue.length;o++){var i=this.errorQueue[o];if(i.url===e.url&&i.data.logs.length+n.logs.length<=100&&JSON.stringify(i.data.common)===JSON.stringify(n.common)){r=!0,(t=i.data.logs).push.apply(t,n.logs);break}}r||(this.errorQueue.length>=5&&this.errorQueue.pop(),this.errorQueue.unshift(e))}}},e.prototype.flushErrorLogs=function(){var e=this;this.errorQueue.forEach((function(t){e.sendPackage(t)})),this.errorQueue=[]},e.prototype.destory=function(){this.batchWaitTimer&&clearTimeout(this.batchWaitTimer),this.compensateTimer&&clearTimeout(this.compensateTimer)},e.prototype.sendRadar=function(e,t){var n=t?{service_name:t}:void 0,r=this.buildV3Package([e],this.radarUrl||this.url,n);this.sendPackage(r)},e}(),ie=function(e,t,n){return E("[error 400]","埋点上报接口请求报错","\nurl:",t,"\ndata",n,"\nerror:",e||"server decode log failed")};function ae(e,t){var n=e.url,r=e.data,o=e.timeout;return new Promise((function(e){if("undefined"!=typeof XMLHttpRequest){var i=new XMLHttpRequest;return i.open("POST",n),i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),"object"!=typeof r||r instanceof Uint8Array||(r=JSON.stringify(r)),o&&(i.timeout=o),i.onload=function(){var o=function(e,t,n,r){var o;if(e<200||e>=300&&304!==e);else try{var i=JSON.parse(t),a=i.exception,s=i.result,c=i.error_msg;a&&(o=a),1!==s&&(o=c||"result is ".concat(s))}catch(e){o=e.message}return o&&ie(o,n,r),o}(i.status,i.response,n,r);t&&t(o),e({error:o,response:o?void 0:i.response})},i.ontimeout=i.onerror=function(o){o&&ie(o,n,r),t&&t(o?"networkTimeout":""),e({error:"networkTimeout"})},i.send(r),i}}))}var se=function(e){if("undefined"!=typeof XMLHttpRequest){var t=function(t){return E("[error 401]","GET 请求出错 url: ".concat(e),t)};try{var n=new XMLHttpRequest;n.open("GET",e),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),n.send(),n.onerror=t}catch(e){t(e)}}},ce=null==v?void 0:v.navigator,ue=ce&&-1!==ce.userAgent.indexOf("Chrome"),le="function"==typeof ce.sendBeacon;function de(e,t){var n=e.url,r=e.data,o=e.timeout;e.isDebug;var i=e.isDrained,a=e.forceSendBeacon;return u(this,void 0,void 0,(function(){var e;return l(this,(function(s){switch(s.label){case 0:return r=JSON.stringify(r),i&&function(e){var t,n=e.url,r=e.data,o=e.forceSendBeacon;if(!ue&&!o||!le)return!1;"object"==typeof r&&r.fd&&(r=r.fd);try{return null===(t=v.navigator)||void 0===t?void 0:t.sendBeacon(n,r)}catch(e){return E("[error 403]","navigator.sendBeacon 报错",e),!1}}({url:n,data:r,forceSendBeacon:a})?(t&&t(),[2]):[4,ae({url:n,data:r,timeout:o},t)];case 1:return[2,(e=s.sent()).error?void 0:e.response]}}))}))}var pe,fe=function(e,t,n){void 0===e&&(e=J);var r="".concat(e,"/#/logger/index?sessionId=").concat(n);return w("%c埋点抓包校验: %c".concat(r),"color:#1abf89;font-size:1.2em;line-height:2.4em;","font-size:1.2em;"),"".concat(t,"/").concat(n,"/")};!function(e){e.loading="loading",e.loaded="loaded"}(pe||(pe={}));var he,ve,ge,ye=Object.create(null),me="weblogger_switch",_e=function(e){var t=function(){try{var e=_(me)||"undefined"!=typeof sessionStorage&&sessionStorage.getItem(me);if(!e)return;var t=JSON.parse(e),n=t.loggerSessionId,r=t.reportHost,o=t.loggerHost,i=t.handshakeApi;return n?(se(i||"".concat(r,"/").concat(n)),fe(o,r,n)):""}catch(e){return""}}()||function(e){void 0===e&&(e=v.location.href);var t=e.lastIndexOf("?");if(-1===t)return"";var n=A(e.slice(t+1)).webloggerSwitch;if(!n)return"";try{var r=decodeURIComponent(n),o=JSON.parse(r),i=o.loggerSessionId,a=o.reportHost,s=o.loggerHost,c=o.handshakeApi;return i?("undefined"!=typeof sessionStorage&&v.sessionStorage.setItem(me,r),se(c||"".concat(a,"/").concat(i)),fe(s,a,i)):""}catch(e){return""}}();if(t)return ne(t,!1,e)},be=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.baseSendData=r.sendLog,r.getResponseSamplingStorage(),r}return a(t,e),t.prototype.getResponseSamplingStorage=function(){return u(this,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Promise.resolve()];case 1:return t.sent(),(e=Number(v.localStorage.getItem(this.responseSamplingStorageKey)))&&Date.now()<e?this.sendEffectiveTime=e:e&&v.localStorage.removeItem(this.responseSamplingStorageKey),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},t.prototype.isResponseSampling=function(){return!!(this.sendEffectiveTime&&Date.now()<this.sendEffectiveTime)},t.prototype.setResponseSamplingConfig=function(e){var t=this;this.isSetSamplingResult||(this.isSetSamplingResult=!0,null==e||e.then((function(e){var n;try{n=e&&JSON.parse(e)}catch(e){n={result:1,hostName:""}}var r=null==n?void 0:n.expireSeconds;if(r){var o=Date.now()+1e3*r;t.sendEffectiveTime=o,v.localStorage.setItem(t.responseSamplingStorageKey,String(o))}})))},t.prototype.updateUrls=function(){var e=this.config,t=e.env,n=void 0===t?z:t,r=e.logger,o=e.proto,i=e.isBridge,a=e.disableCompress,s=_e(o);if(s)this.url=s,this.isDebug=!0;else if(r||n===q||n===Q){var c=function(e,t){void 0===e&&(e=K()),void 0===t&&(t=!1);var n=t?"https://data-track-sgp.corp.kuaishou.com":J;return se("".concat(n,"/rest/").concat(e)),fe(n,"".concat(n,"/rest"),e)}(this.commonPackage.identity_package.device_id,n===Q);this.url=ne(c,!1,o),this.isDebug=!0}else n&&/^(https?:)?\/\//.test(n)?this.url=n:(this.isDebug=n!==z,this.url=ne(n,!1,o),this.radarUrl=ne(n,!0,o));this.enableAsyncGzip=!a&&"v3"===o&&!i&&D()&&n===z&&!s&&!r,this.enableAsyncGzip&&function(e,t,n){if(void 0===t&&(t=!0),ye[e])return n&&n("".concat(e," load repeat"));var r=ye[e]={state:pe.loading},o=document.createElement("script");o.crossOrigin="anonymous",o.src=e,t&&(o.async=!0);var i=document.getElementsByTagName("script")[0];i&&i.parentNode?i.parentNode.insertBefore(o,i):document.head.appendChild(o),o.onload=function(){r.state=pe.loaded,n&&n()},o.onerror=function(t){r.state=pe.loaded,n&&n("".concat(e," loaded failed, ").concat(t))}}("https://static.yximgs.com/udata/pkg/ks-track-platform-new/weblogger/3.10.28/async/gzipper.min.js"),this.formatUrl()},t.prototype.sendLog=function(e,t){var n=this.config.forceSendBeacon;!this.isV2&&this.isResponseSampling()||!this.drained&&this.enableAsyncGzip&&this.sendGzip(e,t)||this.setResponseSamplingConfig(de(s(s({},e),{forceSendBeacon:n}),t))},t.prototype.sendGzip=function(e,n){var r,o=this;if(!(null===(r=t.Gzipper)||void 0===r?void 0:r.sendData))return!1;var i=t.Gzipper.sendData(e,(function(t){t&&o.setResponseSamplingConfig(de(e,n))}));return this.setResponseSamplingConfig(i),!!i},t.prototype.getCommonPackageJSON=function(){return this.commonPackage.toJSON()},t.prototype.send=function(t,n,r){void 0===n&&(n=!1),this.isV2&&(this.commonPackage.setAdditionalSeqIdPackage(t.getEventType()),t.common_package=this.getCommonPackageJSON()),e.prototype.send.call(this,t,n,r)},t}(oe);!function(e){var t,n,r,o,i,a,s,c;(t=e.ElementStatus||(e.ElementStatus={}))[t.UNKNOWN_STATUS=0]="UNKNOWN_STATUS",t[t.CHECKED=1]="CHECKED",t[t.UNCHECKED=2]="UNCHECKED",(n=e.PageShowAction||(e.PageShowAction={}))[n.UNKNOWN_ACTION=0]="UNKNOWN_ACTION",n[n.ENTER=1]="ENTER",n[n.LEAVE=2]="LEAVE",n[n.RESUME=3]="RESUME",(r=e.ActionStatus||(e.ActionStatus={}))[r.UNKNOWN_STATUS=0]="UNKNOWN_STATUS",r[r.SUCCESS=1]="SUCCESS",r[r.FAIL=2]="FAIL",(o=e.ActionType||(e.ActionType={}))[o.UNKNOWN_ACTION_TYPE=0]="UNKNOWN_ACTION_TYPE",o[o.CLICK=1]="CLICK",o[o.LEFT_PULL=2]="LEFT_PULL",o[o.RIGHT_PULL=3]="RIGHT_PULL",o[o.UP_PULL=4]="UP_PULL",o[o.DOWN_PULL=5]="DOWN_PULL",(i=e.SubAction||(e.SubAction={}))[i.UNKNOWN_SUB_ACTION=0]="UNKNOWN_SUB_ACTION",i[i.PAGE_ENTER=1]="PAGE_ENTER",i[i.PAGE_LEAVE=2]="PAGE_LEAVE",i[i.PAGE_RESUME=3]="PAGE_RESUME",i[i.PAGE_PAUSE=4]="PAGE_PAUSE",(a=e.Direction||(e.Direction={}))[a.UNKNOWN2=0]="UNKNOWN2",a[a.UP=1]="UP",a[a.DOWN=2]="DOWN",a[a.LEFT=3]="LEFT",a[a.RIGHT=4]="RIGHT",(s=e.TaskStatus||(e.TaskStatus={}))[s.UNKNOWN_STATUS=0]="UNKNOWN_STATUS",s[s.START=1]="START",s[s.RETRY=2]="RETRY",s[s.PAUSE=3]="PAUSE",s[s.RESUME=4]="RESUME",s[s.PENDING=5]="PENDING",s[s.PROCESSING=6]="PROCESSING",s[s.SUCCESS=7]="SUCCESS",s[s.FAIL=8]="FAIL",s[s.CANCEL=9]="CANCEL",s[s.FINISH=10]="FINISH",(c=e.OperationType||(e.OperationType={}))[c.UNKNOWN_OPERATION=0]="UNKNOWN_OPERATION",c[c.CLICK=1]="CLICK",c[c.DOUBLE_CLICK=2]="DOUBLE_CLICK",c[c.TRIPLE_CLICK=3]="TRIPLE_CLICK",c[c.LONG_PRESS=4]="LONG_PRESS",c[c.PULL=5]="PULL",c[c.DRAG=6]="DRAG",c[c.SCALE=7]="SCALE",c[c.PULL_DOWN=8]="PULL_DOWN",c[c.PULL_UP=9]="PULL_UP",c[c.RIGHT_CLICK=10]="RIGHT_CLICK",c[c.AUTO=11]="AUTO"}(he||(he={})),function(e){var t,n;(t=e.ShowType||(e.ShowType={}))[t.UNKNOWN_TYPE=0]="UNKNOWN_TYPE",t[t.PAGE_AUTO=10]="PAGE_AUTO",t[t.PAGE_CUSTOM=11]="PAGE_CUSTOM",t[t.ELEMENT=12]="ELEMENT",(n=e.TaskEventType||(e.TaskEventType={}))[n.UNKNOWN_TYPE=0]="UNKNOWN_TYPE",n[n.USER_OPERATION=1]="USER_OPERATION",n[n.STAY_LENGTH_STAT_EVENT=2]="STAY_LENGTH_STAT_EVENT",n[n.BACKGROUND_TASK_EVENT=3]="BACKGROUND_TASK_EVENT"}(ve||(ve={})),function(e){var t;(t=e.ShowType||(e.ShowType={}))[t.UNKNOWN2=0]="UNKNOWN2",t[t.PAGE=1]="PAGE"}(ge||(ge={}));var Se,we,Ee,Oe=!0,Pe=(new Date).valueOf(),ke=function(e,t){var n,r;void 0===t&&(t=!1);var o=e.type,i=e.currentUrlPackage,a=e.referUrlPackage,c=e.name,u=void 0===c?"":c,l=e.action,d=e.beginTime,p=e.params,f=e.contentPackage,h=e.status,v=e.actionType,g=e.auto,y=((n={status:h?he.ActionStatus[h]||he.ActionStatus.UNKNOWN_STATUS:he.ActionStatus.SUCCESS})[t?"show_type":"action_type"]=v?he.ActionType[v]||he.ActionType.UNKNOWN_ACTION_TYPE:he.ActionType.CLICK,n.url_package=i,n.refer_url_package=a,n[t?"content_wrapper":"content_package"]=f,n);if("PV"===o){var m=he.SubAction.PAGE_ENTER,_=he.PageShowAction.ENTER,b=Oe,S=0;switch(Oe=!1,l){case"leave":_=he.PageShowAction.LEAVE,m=he.SubAction.PAGE_LEAVE,S=U((new Date).valueOf()-(d||Pe));break;case"enter":_=he.PageShowAction.ENTER,m=he.SubAction.PAGE_ENTER,Pe=(new Date).valueOf();break;case"visible":_=he.PageShowAction.RESUME,m=he.SubAction.PAGE_RESUME,Pe=(new Date).valueOf();break;case"hidden":_=he.PageShowAction.LEAVE,m=he.SubAction.PAGE_PAUSE,S=U((new Date).valueOf()-(d||Pe))}var w=g?ve.ShowType.PAGE_AUTO:ve.ShowType.PAGE_CUSTOM;return t&&(b=void 0,w=ge.ShowType.PAGE),{show_event:s({action:_,sub_action:m,type:w,first_load:b,time_cost:0,stay_length:S},y)}}return{show_event:s({action:t?0:he.PageShowAction.ENTER,type:t?0:ve.ShowType.ELEMENT,sub_action:t?0:he.SubAction.PAGE_ENTER,element_package:(r={},r[t?"action2":"action"]=u,r.params=JSON.stringify(p),r)},y)}},Ie=function(e,t){var n,r;void 0===t&&(t=!1);var o=e.sessionId,i=e.currentUrlPackage,a=e.referUrlPackage,c=e.name,u=e.params,l=e.type,d=e.contentPackage,p=e.status,f=e.taskType,h=e.operationDirection,v=((n={url_package:i,refer_url_package:a,element_package:(r={},r[t?"action2":"action"]=c,r.params=JSON.stringify(u),r)})[t?"content_wrapper":"content_package"]=d,n);if(t){var g="USER_OPERATION"===f||"CLICK"===l&&!f,y=l&&he.OperationType[l]||he.OperationType.CLICK;return g?{click_event:s({type:y,direction:h&&he.Direction[h]||he.Direction.UNKNOWN2},v)}:{task_event:s({action2:c,status:p&&he.TaskStatus[p]||he.TaskStatus.UNKNOWN_STATUS},v)}}return{task_event:s({type:f&&ve.TaskEventType[f]||ve.TaskEventType.USER_OPERATION,status:p&&he.TaskStatus[p]||he.TaskStatus.UNKNOWN_STATUS,operation_type:he.OperationType[l]||he.OperationType.CLICK,operation_direction:h&&he.Direction[h]||he.Direction.UNKNOWN2,session_id:o},v)}},Ae=function(e){var t=e.name,n=e.params,r=e.currentUrlPackage,o=e.referUrlPackage,i=c(e,["name","params","currentUrlPackage","referUrlPackage"]);return{key:t,value:JSON.stringify(s(s({url_package:r,refer_url_package:o},n),i))}},xe=function(e){var t=e.currentUrlPackage,n=e.referUrlPackage,r=e.options;return{video_stat_event:s(s({},r),{url_package:t,refer_url_package:n})}},Te={},Ce=function(e){try{if(v&&v.localStorage&&"undefined"!=typeof Storage&&v.localStorage instanceof Storage){var t=Number(function(e){try{if(v&&v.localStorage){var t=v.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return t}}}catch(e){return null}return null}(e))||0;return t+1>1e8&&(t=0),function(e,t){try{v&&v.localStorage&&v.localStorage.setItem(e,JSON.stringify(t))}catch(e){return!1}}(e,t+1),t}}catch(e){}return Te[e]||(Te[e]=0),Te[e]++},Le=(Se=(new Date).getTimezoneOffset()/60)<=0?"GMT+".concat(k(-Se+"",2,"0"),":00"):"GMT-".concat(k(Se+"",2,"0"),":00"),Ne=function(){function e(e,t){void 0===t&&(t=!1),this.client_timestamp=U((new Date).valueOf()),this.client_increment_id=0,this.session_id=p.sessionId,this.event_id="",t||(this.time_zone=Le),Object.assign(this,e),this.genIncrementId()}return e.prototype.genIncrementId=function(){this.client_increment_id=this.isCustomStatEvent()?Ce("WEBLOGGER_CUSTOM_INCREAMENT_ID_KEY"):Ce("WEBLOGGER_INCREAMENT_ID_KEY")},e.prototype.isCustomStatEvent=function(){return!(!this.stat_package||!("custom_stat_event"in this.stat_package))},e.prototype.getEventType=function(){if(this.event_package){var e=this.event_package,t=e.task_event,n=e.show_event,r=e.click_event,o=e.custom_event;if(n)return"showEvent";if(r)return"clickEvent";if(t)return"taskEvent";if(o)return"customEvent"}return"customEvent"},e}();function Re(e,t,n){var r;void 0===n&&(n=!1);var o,i=t.eventId,a=t.currentUrlPackage,s=t.referUrlPackage,u=t.contentPackage,l=t.name,d=t.params;switch(n&&"RADAR"!==e&&"CUSTOM"!==e&&(a&&(a.page2=a.page,delete a.page),s&&(s.page2=s.page,delete s.page)),e){case"PV":case"SHOW":return new Ne({event_package:ke({type:e,status:t.status,currentUrlPackage:a,referUrlPackage:s,action:t.type,beginTime:t.beginTime,actionType:t.actionType,name:l,params:d,contentPackage:u,operationDirection:t.operationDirection,auto:t.auto},n),event_id:i},n);case"CUSTOM":case"CUSTOM_STAT_EVENT":var f=Ae({name:l,params:d,currentUrlPackage:a,referUrlPackage:s});return new Ne(n?{event_package:{custom_event:f},event_id:i}:{stat_package:{custom_stat_event:f},event_id:i},n);case"RADAR":return new Ne({stat_package:{custom_stat_event:Ae({name:l,params:d,currentUrlPackage:a,referUrlPackage:s})},event_id:i},n);case"HEART_BEAT_EVENT":case"LAUNCH_EVENT":case"APP_USAGE_STAT_EVENT":case"EXCEPTION_EVENT":case"DEVICE_STAT_EVENT":return new Ne({stat_package:(r={},r[e.toLowerCase()]=(o=t,o.currentUrlPackage,o.referUrlPackage,o.taskType,c(o,["currentUrlPackage","referUrlPackage","taskType"])),r)},n);case"VIDEO":return new Ne(n?{stat_package:xe({currentUrlPackage:a,referUrlPackage:s,options:d.params}),event_id:i}:{event_package:Ie({type:e,status:t.status,taskType:t.taskType,sessionId:p.sessionId,currentUrlPackage:a,referUrlPackage:s,name:l,params:d.params,contentPackage:u},n),event_id:i},n);default:return new Ne({event_package:Ie({type:e,status:t.status,taskType:t.taskType,sessionId:p.sessionId,currentUrlPackage:a,referUrlPackage:s,name:l,params:d,contentPackage:u},n),event_id:i},n)}}var De,Ue=(null===(we=null==v?void 0:v.navigator)||void 0===we?void 0:we.userAgent)||"",je=function(e){var t,n,r,o;if(void 0===e&&(e=null===(t=null==v?void 0:v.navigator)||void 0===t?void 0:t.userAgent),Ee&&e===Ue)return Ee;var i="unknow",a=/android/i,s="Mac OS",c="Windows",u="Android",l="iPhone",d="iPad",p="Windows Phone",f="Linux";Ee={os:{name:i,version:i},model:i};try{var h=e.match(/\((.*?)\)/);if(!h)return a.test(e)&&(Ee.os.name=u),Ee;var g=h[1]+")",y=g.split(";").map((function(e){return e.trim()})),m=void 0,_=void 0,b=void 0;if(e.indexOf(p)>-1)b=m=p,(E=g.match(/Windows\sPhone\s(.*?)[;\)\s]/))&&(_=E[1]),b=null===(n=y[y.length-1])||void 0===n?void 0:n.replace(")","");else if(a.test(e)){m=u;var S=g.match(/android.*?;(.*?)build\//i);S&&(b=(b=null===(r=S[1])||void 0===r?void 0:r.split(";").pop())&&b.trim());for(var w=0;w<y.length;w++)if(a.test(y[w])){_=null===(o=y[w])||void 0===o?void 0:o.replace(a,""),b||(b=y[w+1]);break}}else if(e.indexOf(l)>-1||e.indexOf(d)>-1)b=e.indexOf(l)>-1?l:d,m="iOS",(E=g.match(/OS\s(.*?)\slike/))&&(_=E[1]);else if(e.indexOf(s)>-1)b=m=s,(E=g.match(/OS\sX\s(.*?)[;\)\s]/))&&(_=E[1]);else if(e.indexOf(c)>-1){var E;b=m=c,(E=g.match(/Windows\s(.*?)[;\)]/))&&(_=E[1])}else if(e.indexOf("Nokia")>-1){m="Symbian";var O=e.match(/Symbian.*?\/(.*?);/);O&&(_=O[1]);var P=e.match(/Nokia(.*?)\//);P&&(b=P[1])}else g.indexOf(f)>-1&&(m=b=f);Ee={os:{name:m||i,version:_&&_.replace(/_/g,".").trim()||i},model:b||i}}catch(e){}return Ee};function Me(){return void 0===De&&(De=I()&&_("kpn")||function(){if("undefined"==typeof window)return"";for(var e=window.navigator.userAgent,t=[[/ Kwai\//,"KUAISHOU"],[/ ksthanos\//,"THANOS"],[/ ksNebula\//i,"NEBULA"]],n=0;n<t.length;n++){var r=t[n],o=r[0],i=r[1];if(o.exec(e))return i}return""}()||""),De}var Ge,Be,Ve,We=function(){},Ke={supportsPushState:function(){var e=v.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&v.history&&"pushState"in v.history},getUAInfo:je,getDefaultKpn:Me},He=function(){var e;return"function"==typeof(null===(e=null==v?void 0:v.__yodaBridge__)||void 0===e?void 0:e.invoke)},Fe=function(e,t){return void 0===t&&(t="tool"),u(void 0,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return void 0===Ge?[2,!1]:[4,Ge("tool.canIUse",{namespace:t,name:e})];case 1:return[2,(null==(n=r.sent())?void 0:n.canUse)||!1]}}))}))},Je=function(){return Fe("setClientLog")},Ye=function(e,t){return u(void 0,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Ge("tool.setClientLog",{type:e,data:t})];case 1:return[2,r.sent()];case 2:return n=r.sent(),E("[error 206]","yoda.tool.setClientLog() 报错: ".concat(n.message)),[3,3];case 3:return[2]}}))}))},ze={setClientLog:Ye,sendRadarLog:function(e){return u(void 0,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ge("tool.sendRadarLog",e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),E("[error 207]","yoda.tool.sendRadarLog() 报错: ".concat(t.message)),[3,3];case 3:return[2]}}))}))},sendWebLog:function(e){return u(void 0,void 0,void 0,(function(){return l(this,(function(t){try{return[2,Ge("tool.sendWebLog",e)]}catch(e){E("[error 214]","yoda.tool.sendWebLog() 报错: ".concat(e.message))}return[2]}))}))},sendSummarizedLog:function(e){return u(void 0,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ge("tool.sendSummarizedLog",e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),E("[error 208]","yoda.tool.sendSummarizedLog() 报错: ".concat(t.message)),[3,3];case 3:return[2]}}))}))},getWebviewLoadPerf:function(e,t){return void 0===e&&(e={}),u(void 0,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Ge("webview.getPageLoadData",e,t)];case 1:return[2,r.sent()];case 2:return n=r.sent(),E("[error 209]","yoda.webview.getPageLoadData() 报错: ".concat(n.message)),[3,3];case 3:return[2]}}))}))},getKDSWebviewLoadPerf:function(e){return void 0===e&&(e={}),u(void 0,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Ge("system.getPageLoadData",e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),E("[error 209]","yoda.system.getPageLoadData() 报错: ".concat(t.message)),[3,3];case 3:return[2]}}))}))},isSupportBridgeLog:Je,isSupportBridge:Fe,invoke:Ge},qe={unknown:0,none:1,wifi:2,"4g":3,"3g":4,"2g":5,"5g":7,"slow-2g":5};!function(e){e.CLICK="CLICK",e.DOUBLE_CLICK="DOUBLE_CLICK",e.TRIPLE_CLICK="TRIPLE_CLICK",e.LONG_PRESS="LONG_PRESS",e.PULL="PULL",e.DRAG="DRAG",e.SCALE="SCALE",e.PULL_DOWN="PULL_DOWN",e.PULL_UP="PULL_UP",e.AUTO="AUTO"}(Be||(Be={})),function(e){e.PV="PV",e.SHOW="SHOW",e.VIDEO="VIDEO",e.CUSTOM="CUSTOM",e.CUSTOM_EVENT="CUSTOM_EVENT",e.RADAR="RADAR"}(Ve||(Ve={}));var Qe=function(){function e(e){if(this.identity_package={device_id:void 0,global_id:void 0,user_id:void 0,union_id:void 0,open_id:void 0,iu_id:void 0},this.app_package={product:void 0,language:void 0,platform:void 0,container:"H5",package_name:void 0,product_name:void 0,version_name:void 0,channel:void 0,version_code:void 0},this.experiment=void 0,this.service_name=void 0,this.safety_id=void 0,this.sub_biz=void 0,this.device_package={os_version:void 0,model:void 0,ua:void 0},this.need_encrypt=!1,this.network_package={type:qe.unknown},this.h5_extra_attr={sdk_name:"webLogger",sdk_version:"3.10.28",sdk_bundle:"log.hybrid.js"},this.global_attr={entry_tag:[]},this.location_package={country:void 0,province:void 0,city:void 0,county:void 0,street:void 0,latitude:void 0,longitude:void 0},this.update(e),this.app_package.version_name){var t=this.app_package.version_name.lastIndexOf(".");this.app_package.version_code=+this.app_package.version_name.slice(t+1)||0}this.app_package.version_name||(this.app_package.version_name=void 0),this.app_package.version_code||(this.app_package.version_code=void 0)}return e.prototype.getH5ExtraAttr=function(e){return Object.assign({},this.h5_extra_attr,e)},e.prototype.update=function(e){if("object"==typeof e){!function(e,t){if(C(e)&&C(t)){var n=function(e,t,n){C(e[n])&&C(t[n])?Object.assign(e[n],t[n]):C(e[n])||C(t[n])||(e[n]=t[n])};for(var r in t)if(e.hasOwnProperty(r))n(e,t,r);else for(var o in e)C(e[o])&&e[o].hasOwnProperty(r)&&n(e[o],t,r)}}(this,e);var t=e.network_type;t&&qe[t]&&(this.network_package.type=qe[t])}},e.prototype.updateGlobalAttr=function(e){Object.assign(this.global_attr||{},e)},e.prototype.toJSON=function(){this.identity_package.user_id||(this.identity_package.user_id=void 0);var e=s(s({},this),{toJSON:function(){return s(s({},e),{h5_extra_attr:JSON.stringify(e.h5_extra_attr),global_attr:JSON.stringify(e.global_attr)})}});e.global_attr=s({},this.global_attr),this.global_attr.entry_tag&&this.global_attr.entry_tag.length?e.global_attr.entry_tag=this.global_attr.entry_tag.slice():delete e.global_attr.entry_tag,Object.keys(this.global_attr).length||delete e.global_attr;var t=this.location_package;return t&&Object.keys(t).forEach((function(e){void 0===t[e]&&delete t[e]})),e},e}(),Xe=[["a7","640x1136",["iPhone 5","iPhone 5s"]],["a7","1536x2048",["iPad Air","iPad Mini 2","iPad Mini 3"]],["a8","640x1136",["iPod touch (6th gen)"]],["a8","750x1334",["iPhone 6"]],["a8","1242x2208",["iPhone 6 Plus"]],["a8","1536x2048",["iPad Air 2","iPad Mini 4"]],["a9","640x1136",["iPhone SE"]],["a9","750x1334",["iPhone 6s"]],["a9","1242x2208",["iPhone 6s Plus"]],["a9x","1536x2048",["iPad Pro (1st gen 9.7-inch)"]],["a9x","2048x2732",["iPad Pro (1st gen 12.9-inch)"]],["a10","750x1334",["iPhone 7"]],["a10","1242x2208",["iPhone 7 Plus"]],["a10x","1668x2224",["iPad Pro (2th gen 10.5-inch)"]],["a10x","2048x2732",["iPad Pro (2th gen 12.9-inch)"]],["a11","750x1334",["iPhone 8"]],["a11","1242x2208",["iPhone 8 Plus"]],["a11","1125x2436",["iPhone X"]],["a12","828x1792",["iPhone Xr"]],["a12","1125x2436",["iPhone Xs"]],["a12","1242x2688",["iPhone Xs Max"]],["a12x","1668x2388",["iPad Pro (3rd gen 11-inch)"]],["a12x","2048x2732",["iPad Pro (3rd gen 12.9-inch)"]]],$e=function(){try{var e=je(),t=I(),n=e.model||e.os.name||"unknown";if("iOS"!==e.os.name||t)return n;var r=function(){for(var e=R(),t=[],n=0,r=Xe;n<r.length;n++){var o=r[n];e===o[1]&&(t=t.concat(o[2]))}return t.length&&t}();return r?r.join(" or "):n}catch(e){return"unknown"}},Ze=0;function et(){try{var e=je().os.name;return Ze=e?"Android"===e?I()?6:8:"iOS"===e?I()?7:9:10:0}catch(e){return 0}}function tt(){var e="unknown",t=null==v?void 0:v.navigator,n=(null==t?void 0:t.connection)||(null==t?void 0:t.mozConnection)||(null==t?void 0:t.webkitConnection);return n&&(e=n.type||n.effectiveType),e}var nt,rt=function(e){function t(t){var n=e.call(this,s({platform:et(),container:10===Ze?"WEB":"H5",version_name:I()&&_("appver",void 0,!0)||"",network_type:tt(),device_id:K(),user_id:_("userId"),global_id:I()&&_("egid")||"",app_package:{language:v.navigator.language},device_package:{os_version:je().os.version,model:$e(),ua:v.navigator.userAgent}},t))||this;return Object.assign(n.h5_extra_attr,{host_product:Me(),resolution:R(),screen_width:U(v.screen.width),screen_height:U(v.screen.height),device_pixel_ratio:v.devicePixelRatio||1,domain:v.location.origin,fromIframe:(null==v?void 0:v.self)!==(null==v?void 0:v.top)},t.h5_extra_attr),delete n.location_package,n}return a(t,e),t.prototype.getVersionName=function(){return this.app_package.version_name},t.prototype.update=function(t){e.prototype.update.call(this,t);var n=this.app_package.version_name;if("string"==typeof n){var r=n.lastIndexOf(".");this.app_package.version_code=+n.slice(r+1)||0,this.h5_extra_attr.app_version_name=n}},t.prototype.setAdditionalSeqIdPackage=function(e){var t,n;this.additional_seq_id_package={channel:3,channel_seq_id:(n="NORMAL",void 0===n&&(n=""),Ce("".concat("WEBLOGGER_CHANNEL_SEQ_ID","_").concat(n))),custom_type:e,custom_seq_id:(t=e,Ce("".concat("WEBLOGGER_V2_SEQ_ID","_").concat(t)))}},t.prototype.increaseH5SeqId=function(e){this.h5_extra_attr.client_timestamp=U((new Date).valueOf()),this.h5_extra_attr.seq_id=Ce(e?"WEBLOGGER_H5_CUSTOM_SEQ_ID":"WEBLOGGER_H5_SEQ_ID")},t}(Qe),ot=function(e,t,n,r){var o;void 0===t&&(t={}),"string"!=typeof e&&(o=e.type),o=e.toUpperCase();var i={};if("string"==typeof t)i.contentPackage=r,"CUSTOM"===e?(i.key=t,i.value=n):(i.params=n,"PV"===e?i.page=t:i.action=t);else if(i=t,["CUSTOM","CUSTOM_EVENT"].includes(o)){var a=t;a.action&&!a.key&&(i.key=a.action),a.params&&!a.value&&(i.value=a.params)}return[o,i]},it="WEBLOGGER_SILENCED";void 0!==v&&("object"!=typeof v._WEBLOGGER&&(v._WEBLOGGER={_silenced:!1,constructors:[],instances:[],silence:function(e){try{e?sessionStorage.setItem(it,"1"):sessionStorage.removeItem(it),v._WEBLOGGER.instances.forEach((function(t){null==t||t.silence(e)}))}catch(e){}}}),nt=v._WEBLOGGER);var at,st=!1,ct=Math.random(),ut=function(e){function t(t,n){void 0===t&&(t={});var r,o,i,a=e.call(this,t,n)||this;return a.beforeUnload=function(e){if(!st){for(var t in a.logger.drain(),a.plugins){var n=a.plugins[t];"function"==typeof n.beforeUnload&&n.beforeUnload(e)}st=!0,setTimeout((function(){st=!1}),2e3)}},a.isBridge=t.bridgeMode&&t.yoda&&He(),a.logConfig.isBridge=a.isBridge,r="sessionId",o=n&&n.session_id||_("sid")||function(){var e="";try{if(I()){if(e=_("session_id")||_("sid"))return e}else"undefined"!=typeof sessionStorage&&((e=sessionStorage.getItem(H)||"")||(e=V(),sessionStorage.setItem(H,e)))}catch(t){e=V()}return e||V()}(),p[r]=o,a.isV2="v2"===a.logConfig.proto,a.getSampled(a.logConfig),a.presetBaseOption(a.baseOption),a.commonPackage=new rt(a.baseOption),a.logger=new be(a.logConfig,a.commonPackage),a.initYoda(),a.addPlugins(),O(v,"pagehide",a.beforeUnload),O(v,"beforeunload",a.beforeUnload),i=a,(null==nt?void 0:nt.instances)&&i&&-1===nt.instances.indexOf(i)&&(nt.instances.push(i),nt._silenced&&(null==i||i.silence(!0))),a}return a(t,e),t.prototype.getSampled=function(e){var t=e||{},n=t.sampleRateFn,r=t.sampleRate;"function"==typeof n?this.sampled=!!n():void 0!==r&&(this.sampled=ct<Number(r))},t.prototype.presetBaseOption=function(e){this.isBridge||(this.isV2?("number"!=typeof e.product&&E("[error 101]","请设置有效的 product 值，值类型为 number!"),delete e.product_name):(e.product_name&&"string"==typeof e.product_name||E("[error 100]","请设置有效的 product_name 值，值类型为 string!"),delete e.product),e.user_id||(e.user_id=_("userId")||_("userName")||void 0,e.user_id||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.warn;n&&n.call.apply(n,d([console],e,!1))}catch(e){return}}("[warn 102]","user_id 为空，请确定是否传入，如果是异步通过 updateCommonPackage 接口传入，可以忽略该提示!")),e.device_id||(e.device_id=K(),e.device_id||E("[error 103]","device_id 为空，请设置有效的设备 id!")),!e.global_id&&I()&&(e.global_id=_("egid")||""))},Object.defineProperty(t.prototype,"yoda",{get:function(){return this.logConfig.yoda||(null==v?void 0:v.KSYoda)||(null==v?void 0:v.yoda)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Utils",{get:function(){return{yoda:He()&&this.yoda?ze:null,cookie:S,ua:Ke,io:{sendData:de}}},enumerable:!1,configurable:!0}),t.prototype.initYoda=function(){var e,t=this;He()&&this.yoda&&(e=this.yoda,Ge="function"==typeof e?e:e.invoke,u(void 0,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ge("system.getDeviceInfo")];case 1:return[2,t.sent()];case 2:return e=t.sent(),E("[error 209]","yoda.system.getDeviceInfo() 报错: ".concat(e.message)),[3,3];case 3:return[2]}}))})).then((function(e){(null==e?void 0:e.mod)&&(t.commonPackage.device_package.model=e.mod)})),u(void 0,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ge("system.getAppInfo")];case 1:return[2,t.sent()];case 2:return e=t.sent(),E("[error 209]","yoda.system.getAppInfo() 报错: ".concat(e.message)),[3,3];case 3:return[2]}}))})).then((function(e){if("object"==typeof e){var n=e.did,r=e.userId,o=e.appver;n&&(t.commonPackage.identity_package.device_id=n),r&&!t.commonPackage.identity_package.user_id&&(t.commonPackage.identity_package.user_id=r),o&&(t.commonPackage.app_package.version_name=o)}})))},t.prototype.initUrlPackage=function(){e.prototype.initUrlPackage.call(this);var t,n=this.logConfig.referer,r="web";n?(t=n.value,r=n.type&&n.type||r):"undefined"!=typeof document&&document.referrer&&(t=document.referrer),t&&this.updateReferUrlPackage(t,r)},t.prototype.updateCurrentUrlPackage=function(e,t){var n;if(void 0===e&&(e=(null===(n=v.location)||void 0===n?void 0:n.href)||""),void 0===t&&(t="web"),"object"==typeof e&&!e.force&&this.currentUrlPackage){var r=e.page,o=void 0===r?this.currentUrlPackage.page:r,i=e.params,a=void 0===i?{}:i;if(o===this.currentUrlPackage.page)return this.currentUrlPackage.update(o,a)}this.currentUrlPackage=new F(e,t,this.logConfig.urlMap),this.logConfig.attachUrl&&this.currentUrlPackage.attachUrl()},t.prototype.updateReferUrlPackage=function(e,t){void 0===e&&(e=this.currentUrlPackage),void 0===t&&(t="web"),this.referUrlPackage=e instanceof F?e:new F(e,t,this.logConfig.urlMap)},Object.defineProperty(t.prototype,"isSendSampled",{get:function(){return void 0===this.sampled||this.sampled||this.logger.isDebug},enumerable:!1,configurable:!0}),t.prototype.generateLog=function(e,t,n){void 0===n&&(n=Re);var r,o=t,i=o.action,a=o.params,c=o.status,u=o.type,l=o.eventId,d=o.contentPackage,p=o.urlPage;d&&(d="string"==typeof d?d:JSON.stringify(d));var f="PV"===e;if(f){var h=t,v=h.page,g=h.type;g||(t.type=g="enter"),"enter"===g&&v?this.updateCurrentUrlPackage({page:v,params:a}):this.currentUrlPackage.update(v,a)}else p&&p.page&&(r={page:p.page,identity:p.identity||V(),params:JSON.stringify(p.params),page_type:this.currentUrlPackage.page_type});var y={currentUrlPackage:r||this.currentUrlPackage.toJSON(),referUrlPackage:this.referUrlPackage?this.referUrlPackage.toJSON():void 0,contentPackage:d};if("RADAR"!==e&&(null==r||r.page.indexOf("http")),f){var m=t.type;return n(e,s(s(s({},t),{type:m}),y),this.isV2)}if("SHOW"===e)return n(e,s(s(s({},t),{name:i}),y),this.isV2);if("VIDEO"===e)return n(e,s({params:t,name:"VIDEO"},y),this.isV2);if("RADAR"===e)return n(e,t,this.isV2);if(-1!==["CUSTOM","RADAR","CUSTOM_EVENT"].indexOf(e)){var _=t,b=_.key,S=_.value;return n("CUSTOM",s(s(s({},t),{params:S,name:b}),y),this.isV2)}return n(e,s(s(s({},t),{params:a,status:c,taskType:u,eventId:l,name:i}),y),this.isV2)},t.prototype.collect=function(e,t,n,r){var o=ot(e,t,n,r),i=o[0],a=o[1];return this.send(i,a,!1)},t.prototype.sendImmediately=function(e,t,n,r){var o=ot(e,t,n,r),i=o[0],a=o[1];return this.send(i,a,!0)},t.prototype.send=function(e,t,n){if(!this._silenced){var r=this.generateLog(e,t);if(this.emit("event",{type:e,action:null==t?void 0:t.action,log:r}),"RADAR"===e)return this.logger.sendRadar(r,null==t?void 0:t.serviceName);if((!this.isV2||!this.logConfig.forbidV2HttpUrlPage||L(this.currentUrlPackage.page))&&this.isSendSampled){var o="object"==typeof t&&t.callback||void 0;this.logger.send(r,!!n,o)}}},t.prototype.destroy=function(){e.prototype.destroy.call(this),P(v,"pagehide",this.beforeUnload),P(v,"beforeunload",this.beforeUnload),function(e){if(null==nt?void 0:nt.instances){var t=nt.instances.indexOf(e);-1!==t&&nt.instances.splice(t,1)}}(this)},t.prototype.silence=function(e){this._silenced=e},t.Logger=be,t}(B);!function(e){e[e.INIT=-1]="INIT",e[e.CHECKING=0]="CHECKING",e[e.READY=1]="READY",e[e.DISABLED=2]="DISABLED"}(at||(at={}));var lt,dt=function(){try{if(He())return{invoke:t.invoke,version:t.version}}catch(e){}},pt=function(e){function n(t,n){var r=e.call(this,s(s({},t),{yoda:dt(),bridgeMode:!(null==t?void 0:t.disableBridge)}),n)||this;return r.yodaStatus=at.INIT,r.entered="",(null==t?void 0:t.disableBridge)||!He()?r.yodaStatus=at.DISABLED:r.checkSupportBridge(),r.waitYodaQueue||(r.waitYodaQueue=[]),r}return a(n,e),n.prototype.checkSupportBridge=function(){return u(this,void 0,void 0,(function(){var e,t=this;return l(this,(function(n){switch(n.label){case 0:return[4,Je()];case 1:return e=n.sent(),this.yodaStatus=e?at.READY:at.DISABLED,this.waitYodaQueue.forEach((function(n){var r=n.type,o=n.options,i=n.immediately;e?t.sendByBridge(r,o,i):t.sendByHttp(r,o,i)})),this.waitYodaQueue=[],[2]}}))}))},n.prototype.sendByBridge=function(e,n,r){var o,i,a=this.logConfig,c=a.disablePV,u=a.biz,l=n,d=l.contentPackage,p=l.disablePV,f=l.bridgeFields,h=void 0===f?{}:f,v=l.urlPage,g=c||p;d&&(d="string"==typeof d?d:JSON.stringify(d));var y="addTaskEvent",m="PV"===e;if(m){if(g)return;var _=n,b=_.page,S=_.type,w=_.params,E=_.coPage,O=_.category;if(S||(n.type=S="enter"),"leave"===S&&this.currentUrlPackage.coPage&&x())return void Ye("closeCoPage",s(s({},n),this.currentUrlPackage));if(-1===["enter","visible"].indexOf(S))return;if("enter"===S){var P=b||this.currentUrlPackage.page;this.updateCurrentUrlPackage({page:P,params:b?w:this.currentUrlPackage.params,force:!0}),E&&(this.currentUrlPackage.coPage=E),O&&(this.currentUrlPackage.category=O),this.entered=P}else b===this.entered&&this.currentUrlPackage.update(b,w);if(!L(this.currentUrlPackage.page))return;y="setCurrentPage"}var k=!!this.currentUrlPackage.coPage,I=(null==v?void 0:v.page)&&!m?{page:v.page,identity:v.identity,params:j(v.params),page_type:this.currentUrlPackage.page_type}:s(s({},this.currentUrlPackage.toJSON()),{coPage:k}),A=function(e,t){var n=t,r=n.action,o=n.params,i=n.eventId,a=n.contentPackage,c=n.currentUrlPackage,u=n.status,l=void 0===u?"SUCCESS":u;n.name;var d,p=n.feedLogCtx;if("PV"===e){var f=t,h=f.type,v=f.beginTime;return s(s({},c),{actionType:h,contentPackage:a,status:l,beginTime:v,eventId:i,pageType:We()?"NATIVE":"H5"})}if(c&&(d={page:c.page,params:c.params,identity:c.identity,coPage:c.coPage}),["RADAR","CUSTOM","CUSTOM_EVENT"].includes(e)){var g=t,y=g.key,m=g.value,_=g.biz;return{key:y,value:JSON.stringify(s(s({},m),{url_package:c})),biz:_,eventId:i,urlPage:d}}var b={action:r,params:JSON.stringify(o),contentPackage:a,feedLogCtx:p,eventId:i,urlPage:d};if("SHOW"!==e){var S=t.type;Object.assign(b,{type:S||"USER_OPERATION",status:l||"UNKNOWN_STATUS",operationType:e,operationDirection:"UNKNOWN2"})}return b}(e,s(s({biz:u},n),{contentPackage:d,currentUrlPackage:g?void 0:I})),T=-1!==["CUSTOM","RADAR","CUSTOM_EVENT"].indexOf(e);this.commonPackage.increaseH5SeqId(T);var C=this.baseOption||{},N=C.service_name,R=C.sub_biz,D=C.need_encrypt;A.h5ExtraAttr=JSON.stringify(this.commonPackage.getH5ExtraAttr({bridge_info:(null===(i=null===(o=this.logConfig)||void 0===o?void 0:o.yoda)||void 0===i?void 0:i.version)||t.version||!0,coPage:k})),A.realtime=!!r,A.serviceName=N||"",A.subBiz=R||"",A.needEncrypt=D||!1,A.container=We()?"REACT_NATIVE":"H5","SHOW"===e?y="addElementShowEvent":T&&(y="CUSTOM_EVENT"===e||this.logConfig.customStatToCustom?"addCustomEvent":"addCustomStatEvent"),Ye(y,s(s({},h),A))},n.prototype.updateCurrentUrlPackage=function(e,t){var n;if(void 0===e&&(e=(null===(n=v.location)||void 0===n?void 0:n.href)||""),void 0===t&&(t="web"),"object"==typeof e&&!e.force&&this.currentUrlPackage){var r=e.page,o=void 0===r?this.currentUrlPackage.page:r,i=e.params,a=void 0===i?{}:i;if(!o||o===this.currentUrlPackage.page){this.currentUrlPackage.update(o,a);var s=this.entered===o;return void(this.yodaStatus!==at.DISABLED&&s&&this.send("PV",{type:"visible",page:o,params:a},!0))}}this.currentUrlPackage=new F(e,t,this.logConfig.urlMap),this.logConfig.attachUrl&&this.currentUrlPackage.attachUrl()},n.prototype.sendByHttp=function(t,n,r){return e.prototype.send.call(this,t,n,r)},n.prototype.send=function(e,t,n){var r=this.logConfig,o=r.enableV3CustomEvent,i=r.openHttpSender;return"CUSTOM"===e&&o||this.yodaStatus===at.DISABLED||!He()?this.sendByHttp(e,t,n):(i&&this.sendByHttp(e,t,n),this.yodaStatus===at.INIT&&(this.yodaStatus=at.CHECKING),this.yodaStatus===at.CHECKING||void 0===this.yodaStatus?(w("[weblogger]: waiting yoda ready"),this.waitYodaQueue||(this.waitYodaQueue=[]),void this.waitYodaQueue.push({type:e,options:t,immediately:n})):this.sendByBridge(e,t,n))},n}(ut),ft=function(){function e(){}return e.prototype.apply=function(e){this.weblog=e},e}();lt=pt,void 0!==v._GLOBAL_KS_WEBLOGGER_?v._GLOBAL_KS_WEBLOGGER_.Factory=lt:v.Weblog=lt,(null==nt?void 0:nt.constructors)&&lt&&-1===nt.constructors.indexOf(lt)&&(lt._classId=nt.constructors.length,nt.constructors.push(lt)),function(){if(null==nt?void 0:nt.silence)try{nt._silenced=!!sessionStorage.getItem(it)}catch(e){}}(),e.BasePlugin=ft,e.Weblog=pt,e.default=pt,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(21))}])}));